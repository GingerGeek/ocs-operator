apiVersion: operators.coreos.com/v1alpha1
kind: ClusterServiceVersion
metadata:
  annotations:
    alm-examples: |-
      [
        {
          "apiVersion": "ceph.rook.io/v1",
          "kind": "CephCluster",
          "metadata": {
            "name": "my-rook-ceph",
            "namespace": "my-rook-ceph"
          },
          "spec": {
            "cephVersion": {
              "image": "quay.io/ceph/ceph:v16.2.9"
            },
            "dataDirHostPath": "/var/lib/rook",
            "mon": {
              "count": 3
            },
            "dashboard": {
              "enabled": true
            },
            "network": {
              "hostNetwork": false
            },
            "rbdMirroring": {
              "workers": 0
            },
            "storage": {
              "useAllNodes": true,
              "useAllDevices": true
            }
          }
        },
        {
          "apiVersion": "ceph.rook.io/v1",
          "kind": "CephBlockPool",
          "metadata": {
            "name": "replicapool",
            "namespace": "my-rook-ceph"
          },
          "spec": {
            "failureDomain": "host",
            "replicated": {
              "size": 3
            },
            "annotations": null
          }
        },
        {
          "apiVersion": "ceph.rook.io/v1",
          "kind": "CephObjectStore",
          "metadata": {
            "name": "my-store",
            "namespace": "my-rook-ceph"
          },
          "spec": {
            "metadataPool": {
              "failureDomain": "host",
              "replicated": {
                "size": 3
              }
            },
            "dataPool": {
              "failureDomain": "host",
              "replicated": {
                "size": 3
              }
            },
            "gateway": {
              "type": "s3",
              "sslCertificateRef": null,
              "port": 8080,
              "securePort": null,
              "instances": 1,
              "placement": null,
              "annotations": null,
              "resources": null
            }
          }
        },
        {
          "apiVersion": "ceph.rook.io/v1",
          "kind": "CephObjectStoreUser",
          "metadata": {
            "name": "my-user",
            "namespace": "my-rook-ceph"
          },
          "spec": {
            "store": "my-store",
            "displayName": "my display name"
          }
        },
        {
          "apiVersion": "ceph.rook.io/v1",
          "kind": "CephNFS",
          "metadata": {
            "name": "my-nfs",
            "namespace": "rook-ceph"
          },
          "spec": {
            "rados": {
              "pool": "myfs-data0",
              "namespace": "nfs-ns"
            },
            "server": {
              "active": 3,
              "placement": null,
              "annotations": null,
              "resources": null
            }
          }
        },
        {
          "apiVersion": "ceph.rook.io/v1",
          "kind": "CephClient",
          "metadata": {
            "name": "cinder",
            "namespace": "rook-ceph"
          },
          "spec": {
            "caps": {
              "mon": "profile rbd",
              "osd": "profile rbd pool=volumes, profile rbd pool=vms, profile rbd-read-only pool=images"
            }
          }
        },
        {
          "apiVersion": "ceph.rook.io/v1",
          "kind": "CephFilesystem",
          "metadata": {
            "name": "myfs",
            "namespace": "rook-ceph"
          },
          "spec": {
            "dataPools": [
              {
                "compressionMode": "",
                "crushRoot": "",
                "deviceClass": "",
                "erasureCoded": {
                  "algorithm": "",
                  "codingChunks": 0,
                  "dataChunks": 0
                },
                "failureDomain": "host",
                "replicated": {
                  "requireSafeReplicaSize": false,
                  "size": 1,
                  "targetSizeRatio": 0.5
                }
              }
            ],
            "metadataPool": {
              "compressionMode": "",
              "crushRoot": "",
              "deviceClass": "",
              "erasureCoded": {
                "algorithm": "",
                "codingChunks": 0,
                "dataChunks": 0
              },
              "failureDomain": "",
              "replicated": {
                "requireSafeReplicaSize": false,
                "size": 1,
                "targetSizeRatio": 0
              }
            },
            "metadataServer": {
              "activeCount": 1,
              "activeStandby": true,
              "placement": {},
              "resources": {}
            },
            "preservePoolsOnDelete": false,
            "preserveFilesystemOnDelete": false
          }
        },
        {
          "apiVersion": "ceph.rook.io/v1",
          "kind": "CephRBDMirror",
          "metadata": {
            "name": "my-rbd-mirror",
            "namespace": "rook-ceph"
          },
          "spec": {
            "annotations": null,
            "count": 1,
            "placement": {
              "topologyKey": "kubernetes.io/hostname"
            },
            "resources": null
          }
        }
      ]
    capabilities: Basic Install
    tectonic-visibility: ocs
    repository: https://github.com/rook/rook
    containerImage: '{{.RookOperatorImage}}'
    externalClusterScript: |-
      IiIiCkNvcHlyaWdodCAyMDIwIFRoZSBSb29rIEF1dGhvcnMuIEFsbCByaWdodHMgcmVzZXJ2ZWQu
      CgpMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxp
      Y2Vuc2UiKTsKeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3
      aXRoIHRoZSBMaWNlbnNlLgpZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQK
      CglodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjAKClVubGVzcyByZXF1
      aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUK
      ZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElT
      IiBCQVNJUywKV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVp
      dGhlciBleHByZXNzIG9yIGltcGxpZWQuClNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmlj
      IGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQKbGltaXRhdGlvbnMgdW5kZXIgdGhl
      IExpY2Vuc2UuCiIiIgoKaW1wb3J0IGVycm5vCmltcG9ydCBzeXMKaW1wb3J0IGpzb24KaW1wb3J0
      IGFyZ3BhcnNlCmltcG9ydCByZQpmcm9tIHRva2VuaXplIGltcG9ydCBzaW5nbGVfcXVvdGVkCmlt
      cG9ydCByZXF1ZXN0cwppbXBvcnQgc3VicHJvY2VzcwppbXBvcnQgaG1hYwpmcm9tIGhhc2hsaWIg
      aW1wb3J0IHNoYTEgYXMgc2hhCmZyb20gb3MgaW1wb3J0IGxpbmVzZXAgYXMgTElORVNFUApmcm9t
      IG9zIGltcG9ydCBwYXRoCmltcG9ydCB1cmxsaWIucGFyc2UKZnJvbSBlbWFpbC51dGlscyBpbXBv
      cnQgZm9ybWF0ZGF0ZQpmcm9tIHJlcXVlc3RzLmF1dGggaW1wb3J0IEF1dGhCYXNlCgpNb2R1bGVO
      b3RGb3VuZEVycm9yID0gSW1wb3J0RXJyb3IKCnRyeToKICAgIGltcG9ydCByYWRvcwpleGNlcHQg
      TW9kdWxlTm90Rm91bmRFcnJvciBhcyBub01vZEVycjoKICAgIHByaW50KCJFcnJvcjogJXNcbkV4
      aXRpbmcgdGhlIHNjcmlwdC4uLiIgJSBub01vZEVycikKICAgIHN5cy5leGl0KDEpCgp0cnk6CiAg
      ICBpbXBvcnQgcmJkCmV4Y2VwdCBNb2R1bGVOb3RGb3VuZEVycm9yIGFzIG5vTW9kRXJyOgogICAg
      cHJpbnQoIkVycm9yOiAlc1xuRXhpdGluZyB0aGUgc2NyaXB0Li4uIiAlIG5vTW9kRXJyKQogICAg
      c3lzLmV4aXQoMSkKCnRyeToKICAgICMgZm9yIDIuNy54CiAgICBmcm9tIFN0cmluZ0lPIGltcG9y
      dCBTdHJpbmdJTwpleGNlcHQgTW9kdWxlTm90Rm91bmRFcnJvcjoKICAgICMgZm9yIDMueAogICAg
      ZnJvbSBpbyBpbXBvcnQgU3RyaW5nSU8KCnRyeToKICAgICMgZm9yIDIuNy54CiAgICBmcm9tIHVy
      bHBhcnNlIGltcG9ydCB1cmxwYXJzZQpleGNlcHQgTW9kdWxlTm90Rm91bmRFcnJvcjoKICAgICMg
      Zm9yIDMueAogICAgZnJvbSB1cmxsaWIucGFyc2UgaW1wb3J0IHVybHBhcnNlCgpweTNrID0gRmFs
      c2UKdHJ5OgogICAgZnJvbSB1cmxwYXJzZSBpbXBvcnQgdXJscGFyc2UsIHVucXVvdGUKICAgIGZy
      b20gYmFzZTY0IGltcG9ydCBlbmNvZGVzdHJpbmcKZXhjZXB0OgogICAgcHkzayA9IFRydWUKICAg
      IGZyb20gdXJsbGliLnBhcnNlIGltcG9ydCB1cmxwYXJzZSwgdW5xdW90ZQogICAgZnJvbSBiYXNl
      NjQgaW1wb3J0IGVuY29kZWJ5dGVzIGFzIGVuY29kZXN0cmluZwoKCmNsYXNzIEV4ZWN1dGlvbkZh
      aWx1cmVFeGNlcHRpb24oRXhjZXB0aW9uKToKICAgIHBhc3MKCgojIyMjIyMjIyMjIyMjIyMjIyMj
      IyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMKIyMjIyMjIyMjIyMjIyMjIyMjIER1bW15UmFk
      b3MgIyMjIyMjIyMjIyMjIyMjIyMjCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMj
      IyMjIyMjIyMjIyMjIwojIHRoaXMgaXMgbWFpbmx5IGZvciB0ZXN0aW5nIGFuZCBjb3VsZCBiZSB1
      c2VkIHdoZXJlICdyYWRvcycgaXMgbm90IGF2YWlsYWJsZQoKCmNsYXNzIER1bW15UmFkb3Mob2Jq
      ZWN0KToKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzZWxmLnJldHVybl92YWwgPSAw
      CiAgICAgICAgc2VsZi5lcnJfbWVzc2FnZSA9ICIiCiAgICAgICAgc2VsZi5zdGF0ZSA9ICJjb25u
      ZWN0ZWQiCiAgICAgICAgc2VsZi5jbWRfb3V0cHV0X21hcCA9IHt9CiAgICAgICAgc2VsZi5jbWRf
      bmFtZXMgPSB7fQogICAgICAgIHNlbGYuX2luaXRfY21kX291dHB1dF9tYXAoKQogICAgICAgIHNl
      bGYuZHVtbXlfaG9zdF9pcF9tYXAgPSB7fQoKICAgIGRlZiBfaW5pdF9jbWRfb3V0cHV0X21hcChz
      ZWxmKToKICAgICAgICBqc29uX2ZpbGVfbmFtZSA9ICJ0ZXN0LWRhdGEvY2VwaC1zdGF0dXMtb3V0
      IgogICAgICAgIHNjcmlwdF9kaXIgPSBwYXRoLmFic3BhdGgocGF0aC5kaXJuYW1lKF9fZmlsZV9f
      KSkKICAgICAgICBjZXBoX3N0YXR1c19zdHIgPSAiIgogICAgICAgIHdpdGggb3BlbihwYXRoLmpv
      aW4oc2NyaXB0X2RpciwganNvbl9maWxlX25hbWUpLCAiciIpIGFzIGpzb25fZmlsZToKICAgICAg
      ICAgICAgY2VwaF9zdGF0dXNfc3RyID0ganNvbl9maWxlLnJlYWQoKQogICAgICAgIHNlbGYuY21k
      X25hbWVzWyJmcyBscyJdID0gIiIieyJmb3JtYXQiOiAianNvbiIsICJwcmVmaXgiOiAiZnMgbHMi
      fSIiIgogICAgICAgIHNlbGYuY21kX25hbWVzWwogICAgICAgICAgICAicXVvcnVtX3N0YXR1cyIK
      ICAgICAgICBdID0gIiIieyJmb3JtYXQiOiAianNvbiIsICJwcmVmaXgiOiAicXVvcnVtX3N0YXR1
      cyJ9IiIiCiAgICAgICAgc2VsZi5jbWRfbmFtZXNbCiAgICAgICAgICAgICJtZ3Igc2VydmljZXMi
      CiAgICAgICAgXSA9ICIiInsiZm9ybWF0IjogImpzb24iLCAicHJlZml4IjogIm1nciBzZXJ2aWNl
      cyJ9IiIiCiAgICAgICAgIyBhbGwgdGhlIGNvbW1hbmRzIGFuZCB0aGVpciBvdXRwdXQKICAgICAg
      ICBzZWxmLmNtZF9vdXRwdXRfbWFwWwogICAgICAgICAgICBzZWxmLmNtZF9uYW1lc1siZnMgbHMi
      XQogICAgICAgIF0gPSAiIiJbeyJuYW1lIjoibXlmcyIsIm1ldGFkYXRhX3Bvb2wiOiJteWZzLW1l
      dGFkYXRhIiwibWV0YWRhdGFfcG9vbF9pZCI6MiwiZGF0YV9wb29sX2lkcyI6WzNdLCJkYXRhX3Bv
      b2xzIjpbIm15ZnMtcmVwbGljYXRlZCJdfV0iIiIKICAgICAgICBzZWxmLmNtZF9vdXRwdXRfbWFw
      WwogICAgICAgICAgICBzZWxmLmNtZF9uYW1lc1sicXVvcnVtX3N0YXR1cyJdCiAgICAgICAgXSA9
      ICIiInsiZWxlY3Rpb25fZXBvY2giOjMsInF1b3J1bSI6WzBdLCJxdW9ydW1fbmFtZXMiOlsiYSJd
      LCJxdW9ydW1fbGVhZGVyX25hbWUiOiJhIiwicXVvcnVtX2FnZSI6MTQzODUsImZlYXR1cmVzIjp7
      InF1b3J1bV9jb24iOiI0NTQwMTM4MjkyODM2Njk2MDYzIiwicXVvcnVtX21vbiI6WyJrcmFrZW4i
      LCJsdW1pbm91cyIsIm1pbWljIiwib3NkbWFwLXBydW5lIiwibmF1dGlsdXMiLCJvY3RvcHVzIl19
      LCJtb25tYXAiOnsiZXBvY2giOjEsImZzaWQiOiJhZjRlMTY3My0wYjcyLTQwMmQtOTkwYS0yMmQy
      OTE5ZDBmMWMiLCJtb2RpZmllZCI6IjIwMjAtMDUtMDdUMDM6MzY6MzkuOTE4MDM1WiIsImNyZWF0
      ZWQiOiIyMDIwLTA1LTA3VDAzOjM2OjM5LjkxODAzNVoiLCJtaW5fbW9uX3JlbGVhc2UiOjE1LCJt
      aW5fbW9uX3JlbGVhc2VfbmFtZSI6Im9jdG9wdXMiLCJmZWF0dXJlcyI6eyJwZXJzaXN0ZW50Ijpb
      ImtyYWtlbiIsImx1bWlub3VzIiwibWltaWMiLCJvc2RtYXAtcHJ1bmUiLCJuYXV0aWx1cyIsIm9j
      dG9wdXMiXSwib3B0aW9uYWwiOltdfSwibW9ucyI6W3sicmFuayI6MCwibmFtZSI6ImEiLCJwdWJs
      aWNfYWRkcnMiOnsiYWRkcnZlYyI6W3sidHlwZSI6InYyIiwiYWRkciI6IjEwLjExMC4yMDUuMTc0
      OjMzMDAiLCJub25jZSI6MH0seyJ0eXBlIjoidjEiLCJhZGRyIjoiMTAuMTEwLjIwNS4xNzQ6Njc4
      OSIsIm5vbmNlIjowfV19LCJhZGRyIjoiMTAuMTEwLjIwNS4xNzQ6Njc4OS8wIiwicHVibGljX2Fk
      ZHIiOiIxMC4xMTAuMjA1LjE3NDo2Nzg5LzAiLCJwcmlvcml0eSI6MCwid2VpZ2h0IjowfV19fSIi
      IgogICAgICAgIHNlbGYuY21kX291dHB1dF9tYXBbCiAgICAgICAgICAgIHNlbGYuY21kX25hbWVz
      WyJtZ3Igc2VydmljZXMiXQogICAgICAgIF0gPSAiIiJ7ImRhc2hib2FyZCI6Imh0dHBzOi8vY2Vw
      aC1kYXNoYm9hcmQ6ODQ0My8iLCJwcm9tZXRoZXVzIjoiaHR0cDovL2NlcGgtZGFzaGJvYXJkLWRi
      OjkyODMvIn0iIiIKICAgICAgICBzZWxmLmNtZF9vdXRwdXRfbWFwWwogICAgICAgICAgICAiIiJ7
      ImNhcHMiOiBbIm1vbiIsICJhbGxvdyByLCBhbGxvdyBjb21tYW5kIHF1b3J1bV9zdGF0dXMiLCAi
      b3NkIiwgImFsbG93IHJ3eCBwb29sPWRlZmF1bHQucmd3Lm1ldGEsIGFsbG93IHIgcG9vbD0ucmd3
      LnJvb3QsIGFsbG93IHJ3IHBvb2w9ZGVmYXVsdC5yZ3cuY29udHJvbCwgYWxsb3cgeCBwb29sPWRl
      ZmF1bHQucmd3LmJ1Y2tldHMuaW5kZXgiXSwgImVudGl0eSI6ICJjbGllbnQuaGVhbHRoY2hlY2tl
      ciIsICJmb3JtYXQiOiAianNvbiIsICJwcmVmaXgiOiAiYXV0aCBnZXQtb3ItY3JlYXRlIn0iIiIK
      ICAgICAgICBdID0gIiIiW3siZW50aXR5IjoiY2xpZW50LmhlYWx0aGNoZWNrZXIiLCJrZXkiOiJB
      UURGa2JOZWZ0NWJGUkFBVG5kTE5VU0VLcnVvenhpWmkzbHJkQT09IiwiY2FwcyI6eyJtb24iOiJh
      bGxvdyByLCBhbGxvdyBjb21tYW5kIHF1b3J1bV9zdGF0dXMiLCJvc2QiOiJhbGxvdyByd3ggcG9v
      bD1kZWZhdWx0LnJndy5tZXRhLCBhbGxvdyByIHBvb2w9LnJndy5yb290LCBhbGxvdyBydyBwb29s
      PWRlZmF1bHQucmd3LmNvbnRyb2wsIGFsbG93IHggcG9vbD1kZWZhdWx0LnJndy5idWNrZXRzLmlu
      ZGV4In19XSIiIgogICAgICAgIHNlbGYuY21kX291dHB1dF9tYXBbCiAgICAgICAgICAgICIiInsi
      Y2FwcyI6IFsibW9uIiwgInByb2ZpbGUgcmJkLCBhbGxvdyBjb21tYW5kICdvc2QgYmxvY2tsaXN0
      JyIsICJvc2QiLCAicHJvZmlsZSByYmQiXSwgImVudGl0eSI6ICJjbGllbnQuY3NpLXJiZC1ub2Rl
      IiwgImZvcm1hdCI6ICJqc29uIiwgInByZWZpeCI6ICJhdXRoIGdldC1vci1jcmVhdGUifSIiIgog
      ICAgICAgIF0gPSAiIiJbeyJlbnRpdHkiOiJjbGllbnQuY3NpLXJiZC1ub2RlIiwia2V5IjoiQVFC
      T2dyTmVIYksxQXhBQXViWUJlVjhTMVUvR1B6cTVTVmVxNmc9PSIsImNhcHMiOnsibW9uIjoicHJv
      ZmlsZSByYmQsIGFsbG93IGNvbW1hbmQgJ29zZCBibG9ja2xpc3QnIiwib3NkIjoicHJvZmlsZSBy
      YmQifX1dIiIiCiAgICAgICAgc2VsZi5jbWRfb3V0cHV0X21hcFsKICAgICAgICAgICAgIiIieyJj
      YXBzIjogWyJtb24iLCAicHJvZmlsZSByYmQsIGFsbG93IGNvbW1hbmQgJ29zZCBibG9ja2xpc3Qn
      IiwgIm1nciIsICJhbGxvdyBydyIsICJvc2QiLCAicHJvZmlsZSByYmQiXSwgImVudGl0eSI6ICJj
      bGllbnQuY3NpLXJiZC1wcm92aXNpb25lciIsICJmb3JtYXQiOiAianNvbiIsICJwcmVmaXgiOiAi
      YXV0aCBnZXQtb3ItY3JlYXRlIn0iIiIKICAgICAgICBdID0gIiIiW3siZW50aXR5IjoiY2xpZW50
      LmNzaS1yYmQtcHJvdmlzaW9uZXIiLCJrZXkiOiJBUUJOZ3JOZTFnZXlLeEFBOGVrVmlSZEUraHNz
      NU93ZVlCa3dOZz09IiwiY2FwcyI6eyJtZ3IiOiJhbGxvdyBydyIsIm1vbiI6InByb2ZpbGUgcmJk
      LCBhbGxvdyBjb21tYW5kICdvc2QgYmxvY2tsaXN0JyIsIm9zZCI6InByb2ZpbGUgcmJkIn19XSIi
      IgogICAgICAgIHNlbGYuY21kX291dHB1dF9tYXBbCiAgICAgICAgICAgICIiInsiY2FwcyI6IFsi
      bW9uIiwgImFsbG93IHIsIGFsbG93IGNvbW1hbmQgJ29zZCBibG9ja2xpc3QnIiwgIm1nciIsICJh
      bGxvdyBydyIsICJvc2QiLCAiYWxsb3cgcncgdGFnIGNlcGhmcyAqPSoiLCAibWRzIiwgImFsbG93
      IHJ3Il0sICJlbnRpdHkiOiAiY2xpZW50LmNzaS1jZXBoZnMtbm9kZSIsICJmb3JtYXQiOiAianNv
      biIsICJwcmVmaXgiOiAiYXV0aCBnZXQtb3ItY3JlYXRlIn0iIiIKICAgICAgICBdID0gIiIiW3si
      ZW50aXR5IjoiY2xpZW50LmNzaS1jZXBoZnMtbm9kZSIsImtleSI6IkFRQk9nck5lRU51bkt4QUFQ
      Q21nRTdSNkc4RGNYbmFKMUYzMnFnPT0iLCJjYXBzIjp7Im1kcyI6ImFsbG93IHJ3IiwibWdyIjoi
      YWxsb3cgcnciLCJtb24iOiJhbGxvdyByLCBhbGxvdyBjb21tYW5kICdvc2QgYmxvY2tsaXN0JyIs
      Im9zZCI6ImFsbG93IHJ3IHRhZyBjZXBoZnMgKj0qIn19XSIiIgogICAgICAgIHNlbGYuY21kX291
      dHB1dF9tYXBbCiAgICAgICAgICAgICIiInsiY2FwcyI6IFsibW9uIiwgImFsbG93IHIsIGFsbG93
      IGNvbW1hbmQgJ29zZCBibG9ja2xpc3QnIiwgIm1nciIsICJhbGxvdyBydyIsICJvc2QiLCAiYWxs
      b3cgcncgdGFnIGNlcGhmcyBtZXRhZGF0YT0qIl0sICJlbnRpdHkiOiAiY2xpZW50LmNzaS1jZXBo
      ZnMtcHJvdmlzaW9uZXIiLCAiZm9ybWF0IjogImpzb24iLCAicHJlZml4IjogImF1dGggZ2V0LW9y
      LWNyZWF0ZSJ9IiIiCiAgICAgICAgXSA9ICIiIlt7ImVudGl0eSI6ImNsaWVudC5jc2ktY2VwaGZz
      LXByb3Zpc2lvbmVyIiwia2V5IjoiQVFCT2dyTmVBRmdjR0JBQXZHcUtPQUQwRDN4eG1WWTBSOTEy
      ZGc9PSIsImNhcHMiOnsibWdyIjoiYWxsb3cgcnciLCJtb24iOiJhbGxvdyByLCBhbGxvdyBjb21t
      YW5kICdvc2QgYmxvY2tsaXN0JyIsIm9zZCI6ImFsbG93IHJ3IHRhZyBjZXBoZnMgbWV0YWRhdGE9
      KiJ9fV0iIiIKICAgICAgICBzZWxmLmNtZF9vdXRwdXRfbWFwWwogICAgICAgICAgICAiIiJ7ImNh
      cHMiOiBbIm1vbiIsICJhbGxvdyByLCBhbGxvdyBjb21tYW5kICdvc2QgYmxvY2tsaXN0JyIsICJt
      Z3IiLCAiYWxsb3cgcnciLCAib3NkIiwgImFsbG93IHJ3IHRhZyBjZXBoZnMgbWV0YWRhdGE9KiJd
      LCAiZW50aXR5IjogImNsaWVudC5jc2ktY2VwaGZzLXByb3Zpc2lvbmVyLW9wZW5zaGlmdC1zdG9y
      YWdlIiwgImZvcm1hdCI6ICJqc29uIiwgInByZWZpeCI6ICJhdXRoIGdldC1vci1jcmVhdGUifSIi
      IgogICAgICAgIF0gPSAiIiJbeyJlbnRpdHkiOiJjbGllbnQuY3NpLWNlcGhmcy1wcm92aXNpb25l
      ci1vcGVuc2hpZnQtc3RvcmFnZSIsImtleSI6IkJRQk9nck5lQUZnY0dCQUF2R3FLT0FEMEQzeHht
      VlkwUjkxMmRnPT0iLCJjYXBzIjp7Im1nciI6ImFsbG93IHJ3IiwibW9uIjoiYWxsb3cgciwgYWxs
      b3cgY29tbWFuZCAnb3NkIGJsb2NrbGlzdCciLCJvc2QiOiJhbGxvdyBydyB0YWcgY2VwaGZzIG1l
      dGFkYXRhPSoifX1dIiIiCiAgICAgICAgc2VsZi5jbWRfb3V0cHV0X21hcFsKICAgICAgICAgICAg
      IiIieyJjYXBzIjogWyJtb24iLCAiYWxsb3cgciwgYWxsb3cgY29tbWFuZCAnb3NkIGJsb2NrbGlz
      dCciLCAibWdyIiwgImFsbG93IHJ3IiwgIm9zZCIsICJhbGxvdyBydyB0YWcgY2VwaGZzIG1ldGFk
      YXRhPW15ZnMiXSwgImVudGl0eSI6ICJjbGllbnQuY3NpLWNlcGhmcy1wcm92aXNpb25lci1vcGVu
      c2hpZnQtc3RvcmFnZS1teWZzIiwgImZvcm1hdCI6ICJqc29uIiwgInByZWZpeCI6ICJhdXRoIGdl
      dC1vci1jcmVhdGUifSIiIgogICAgICAgIF0gPSAiIiJbeyJlbnRpdHkiOiJjbGllbnQuY3NpLWNl
      cGhmcy1wcm92aXNpb25lci1vcGVuc2hpZnQtc3RvcmFnZS1teWZzIiwia2V5IjoiQ1FCT2dyTmVB
      RmdjR0JBQXZHcUtPQUQwRDN4eG1WWTBSOTEyZGc9PSIsImNhcHMiOnsibWdyIjoiYWxsb3cgcnci
      LCJtb24iOiJhbGxvdyByLCBhbGxvdyBjb21tYW5kICdvc2QgYmxvY2tsaXN0JyIsIm9zZCI6ImFs
      bG93IHJ3IHRhZyBjZXBoZnMgbWV0YWRhdGE9bXlmcyJ9fV0iIiIKICAgICAgICBzZWxmLmNtZF9v
      dXRwdXRfbWFwWwogICAgICAgICAgICAiIiJ7ImNhcHMiOiBbIm1vbiIsICJhbGxvdyByLCBhbGxv
      dyBjb21tYW5kIHF1b3J1bV9zdGF0dXMsIGFsbG93IGNvbW1hbmQgdmVyc2lvbiIsICJtZ3IiLCAi
      YWxsb3cgY29tbWFuZCBjb25maWciLCAib3NkIiwgImFsbG93IHJ3eCBwb29sPWRlZmF1bHQucmd3
      Lm1ldGEsIGFsbG93IHIgcG9vbD0ucmd3LnJvb3QsIGFsbG93IHJ3IHBvb2w9ZGVmYXVsdC5yZ3cu
      Y29udHJvbCwgYWxsb3cgcnggcG9vbD1kZWZhdWx0LnJndy5sb2csIGFsbG93IHggcG9vbD1kZWZh
      dWx0LnJndy5idWNrZXRzLmluZGV4Il0sICJlbnRpdHkiOiAiY2xpZW50LmhlYWx0aGNoZWNrZXIi
      LCAiZm9ybWF0IjogImpzb24iLCAicHJlZml4IjogImF1dGggZ2V0LW9yLWNyZWF0ZSJ9IiIiCiAg
      ICAgICAgXSA9ICIiIlt7ImVudGl0eSI6ImNsaWVudC5oZWFsdGhjaGVja2VyIiwia2V5IjoiQVFE
      RmtiTmVmdDViRlJBQVRuZExOVVNFS3J1b3p4aVppM2xyZEE9PSIsImNhcHMiOnsibW9uIjogImFs
      bG93IHIsIGFsbG93IGNvbW1hbmQgcXVvcnVtX3N0YXR1cywgYWxsb3cgY29tbWFuZCB2ZXJzaW9u
      IiwgIm1nciI6ICJhbGxvdyBjb21tYW5kIGNvbmZpZyIsICJvc2QiOiAiYWxsb3cgcnd4IHBvb2w9
      ZGVmYXVsdC5yZ3cubWV0YSwgYWxsb3cgciBwb29sPS5yZ3cucm9vdCwgYWxsb3cgcncgcG9vbD1k
      ZWZhdWx0LnJndy5jb250cm9sLCBhbGxvdyByeCBwb29sPWRlZmF1bHQucmd3LmxvZywgYWxsb3cg
      eCBwb29sPWRlZmF1bHQucmd3LmJ1Y2tldHMuaW5kZXgifX1dIiIiCiAgICAgICAgc2VsZi5jbWRf
      b3V0cHV0X21hcFsKICAgICAgICAgICAgIiIieyJmb3JtYXQiOiAianNvbiIsICJwcmVmaXgiOiAi
      bWdyIHNlcnZpY2VzIn0iIiIKICAgICAgICBdID0gIiIieyJkYXNoYm9hcmQiOiAiaHR0cDovL3Jv
      b2stY2VwaC1tZ3ItYS01N2NmOWY4NGJjLWY0am5sOjcwMDAvIiwgInByb21ldGhldXMiOiAiaHR0
      cDovL3Jvb2stY2VwaC1tZ3ItYS01N2NmOWY4NGJjLWY0am5sOjkyODMvIn0iIiIKICAgICAgICBz
      ZWxmLmNtZF9vdXRwdXRfbWFwWwogICAgICAgICAgICAiIiJ7ImVudGl0eSI6ICJjbGllbnQuaGVh
      bHRoY2hlY2tlciIsICJmb3JtYXQiOiAianNvbiIsICJwcmVmaXgiOiAiYXV0aCBnZXQifSIiIgog
      ICAgICAgIF0gPSAiIiJ7ImRhc2hib2FyZCI6ICJodHRwOi8vcm9vay1jZXBoLW1nci1hLTU3Y2Y5
      Zjg0YmMtZjRqbmw6NzAwMC8iLCAicHJvbWV0aGV1cyI6ICJodHRwOi8vcm9vay1jZXBoLW1nci1h
      LTU3Y2Y5Zjg0YmMtZjRqbmw6OTI4My8ifSIiIgogICAgICAgIHNlbGYuY21kX291dHB1dF9tYXBb
      CiAgICAgICAgICAgICIiInsiZW50aXR5IjogImNsaWVudC5oZWFsdGhjaGVja2VyIiwgImZvcm1h
      dCI6ICJqc29uIiwgInByZWZpeCI6ICJhdXRoIGdldCJ9IiIiCiAgICAgICAgXSA9ICIiIlt7ImVu
      dGl0eSI6ImNsaWVudC5oZWFsdGhjaGVja2VyIiwia2V5IjoiQVFERmtiTmVmdDViRlJBQVRuZExO
      VVNFS3J1b3p4aVppM2xyZEE9PSIsImNhcHMiOnsibW9uIjogImFsbG93IHIsIGFsbG93IGNvbW1h
      bmQgcXVvcnVtX3N0YXR1cywgYWxsb3cgY29tbWFuZCB2ZXJzaW9uIiwgIm1nciI6ICJhbGxvdyBj
      b21tYW5kIGNvbmZpZyIsICJvc2QiOiAiYWxsb3cgcnd4IHBvb2w9ZGVmYXVsdC5yZ3cubWV0YSwg
      YWxsb3cgciBwb29sPS5yZ3cucm9vdCwgYWxsb3cgcncgcG9vbD1kZWZhdWx0LnJndy5jb250cm9s
      LCBhbGxvdyByeCBwb29sPWRlZmF1bHQucmd3LmxvZywgYWxsb3cgeCBwb29sPWRlZmF1bHQucmd3
      LmJ1Y2tldHMuaW5kZXgifX1dIiIiCiAgICAgICAgc2VsZi5jbWRfb3V0cHV0X21hcFsKICAgICAg
      ICAgICAgIiIieyJlbnRpdHkiOiAiY2xpZW50LmNzaS1jZXBoZnMtbm9kZSIsICJmb3JtYXQiOiAi
      anNvbiIsICJwcmVmaXgiOiAiYXV0aCBnZXQifSIiIgogICAgICAgIF0gPSAiIiJbXSIiIgogICAg
      ICAgIHNlbGYuY21kX291dHB1dF9tYXBbCiAgICAgICAgICAgICIiInsiZW50aXR5IjogImNsaWVu
      dC5jc2ktcmJkLW5vZGUiLCAiZm9ybWF0IjogImpzb24iLCAicHJlZml4IjogImF1dGggZ2V0In0i
      IiIKICAgICAgICBdID0gIiIiW10iIiIKICAgICAgICBzZWxmLmNtZF9vdXRwdXRfbWFwWwogICAg
      ICAgICAgICAiIiJ7ImVudGl0eSI6ICJjbGllbnQuY3NpLXJiZC1wcm92aXNpb25lciIsICJmb3Jt
      YXQiOiAianNvbiIsICJwcmVmaXgiOiAiYXV0aCBnZXQifSIiIgogICAgICAgIF0gPSAiIiJbXSIi
      IgogICAgICAgIHNlbGYuY21kX291dHB1dF9tYXBbCiAgICAgICAgICAgICIiInsiZW50aXR5Ijog
      ImNsaWVudC5jc2ktY2VwaGZzLXByb3Zpc2lvbmVyIiwgImZvcm1hdCI6ICJqc29uIiwgInByZWZp
      eCI6ICJhdXRoIGdldCJ9IiIiCiAgICAgICAgXSA9ICIiIltdIiIiCiAgICAgICAgc2VsZi5jbWRf
      b3V0cHV0X21hcFsKICAgICAgICAgICAgIiIieyJlbnRpdHkiOiAiY2xpZW50LmNzaS1jZXBoZnMt
      cHJvdmlzaW9uZXItb3BlbnNoaWZ0LXN0b3JhZ2UiLCAiZm9ybWF0IjogImpzb24iLCAicHJlZml4
      IjogImF1dGggZ2V0In0iIiIKICAgICAgICBdID0gIiIiW10iIiIKICAgICAgICBzZWxmLmNtZF9v
      dXRwdXRfbWFwWwogICAgICAgICAgICAiIiJ7ImVudGl0eSI6ICJjbGllbnQuY3NpLWNlcGhmcy1w
      cm92aXNpb25lci1vcGVuc2hpZnQtc3RvcmFnZS1teWZzIiwgImZvcm1hdCI6ICJqc29uIiwgInBy
      ZWZpeCI6ICJhdXRoIGdldCJ9IiIiCiAgICAgICAgXSA9ICIiIltdIiIiCiAgICAgICAgc2VsZi5j
      bWRfb3V0cHV0X21hcFsKICAgICAgICAgICAgIiIieyJlbnRpdHkiOiAiY2xpZW50LmNzaS1jZXBo
      ZnMtcHJvdmlzaW9uZXIiLCAiZm9ybWF0IjogImpzb24iLCAicHJlZml4IjogImF1dGggZ2V0In0i
      IiIKICAgICAgICBdID0gIiIiW3siZW50aXR5IjoiY2xpZW50LmNzaS1jZXBoZnMtcHJvdmlzaW9u
      ZXIiLCJrZXkiOiJBUURGa2JOZWZ0NWJGUkFBVG5kTE5VU0VLcnVvenhpWmkzbHJkQT09IiwiY2Fw
      cyI6eyJtb24iOiJhbGxvdyByIiwgIm1nciI6ImFsbG93IHJ3IiwgIm9zZCI6ImFsbG93IHJ3IHRh
      ZyBjZXBoZnMgbWV0YWRhdGE9KiJ9fV0iIiIKICAgICAgICBzZWxmLmNtZF9vdXRwdXRfbWFwWwog
      ICAgICAgICAgICAiIiJ7ImNhcHMiOiBbIm1vbiIsICJhbGxvdyByLCBhbGxvdyBjb21tYW5kICdv
      c2QgYmxvY2tsaXN0JyIsICJtZ3IiLCAiYWxsb3cgcnciLCAib3NkIiwgImFsbG93IHJ3IHRhZyBj
      ZXBoZnMgbWV0YWRhdGE9KiJdLCAiZW50aXR5IjogImNsaWVudC5jc2ktY2VwaGZzLXByb3Zpc2lv
      bmVyIiwgImZvcm1hdCI6ICJqc29uIiwgInByZWZpeCI6ICJhdXRoIGNhcHMifSIiIgogICAgICAg
      IF0gPSAiIiJbeyJlbnRpdHkiOiJjbGllbnQuY3NpLWNlcGhmcy1wcm92aXNpb25lciIsImtleSI6
      IkFRREZrYk5lZnQ1YkZSQUFUbmRMTlVTRUtydW96eGlaaTNscmRBPT0iLCJjYXBzIjp7Im1vbiI6
      ImFsbG93IHIsICBhbGxvdyBjb21tYW5kICdvc2QgYmxvY2tsaXN0JyIsICJtZ3IiOiJhbGxvdyBy
      dyIsICJvc2QiOiJhbGxvdyBydyB0YWcgY2VwaGZzIG1ldGFkYXRhPSoifX1dIiIiCiAgICAgICAg
      c2VsZi5jbWRfb3V0cHV0X21hcFsneyJmb3JtYXQiOiAianNvbiIsICJwcmVmaXgiOiAic3RhdHVz
      In0nXSA9IGNlcGhfc3RhdHVzX3N0cgoKICAgIGRlZiBzaHV0ZG93bihzZWxmKToKICAgICAgICBw
      YXNzCgogICAgZGVmIGdldF9mc2lkKHNlbGYpOgogICAgICAgIHJldHVybiAiYWY0ZTE2NzMtMGI3
      Mi00MDJkLTk5MGEtMjJkMjkxOWQwZjFjIgoKICAgIGRlZiBjb25mX3JlYWRfZmlsZShzZWxmKToK
      ICAgICAgICBwYXNzCgogICAgZGVmIGNvbm5lY3Qoc2VsZik6CiAgICAgICAgcGFzcwoKICAgIGRl
      ZiBwb29sX2V4aXN0cyhzZWxmLCBwb29sX25hbWUpOgogICAgICAgIHJldHVybiBUcnVlCgogICAg
      ZGVmIG1vbl9jb21tYW5kKHNlbGYsIGNtZCwgb3V0KToKICAgICAgICBqc29uX2NtZCA9IGpzb24u
      bG9hZHMoY21kKQogICAgICAgIGpzb25fY21kX3N0ciA9IGpzb24uZHVtcHMoanNvbl9jbWQsIHNv
      cnRfa2V5cz1UcnVlKQogICAgICAgIGNtZF9vdXRwdXQgPSBzZWxmLmNtZF9vdXRwdXRfbWFwW2pz
      b25fY21kX3N0cl0KICAgICAgICByZXR1cm4gKAogICAgICAgICAgICBzZWxmLnJldHVybl92YWws
      CiAgICAgICAgICAgIGNtZF9vdXRwdXQsCiAgICAgICAgICAgICJ7fSIuZm9ybWF0KHNlbGYuZXJy
      X21lc3NhZ2UpLmVuY29kZSgidXRmLTgiKSwKICAgICAgICApCgogICAgZGVmIF9jb252ZXJ0X2hv
      c3RuYW1lX3RvX2lwKHNlbGYsIGhvc3RfbmFtZSk6CiAgICAgICAgaXBfcmVnX3ggPSByZS5jb21w
      aWxlKHIiXGR7MSwzfS5cZHsxLDN9LlxkezEsM30uXGR7MSwzfSIpCiAgICAgICAgIyBpZiBwcm92
      aWRlZCBob3N0IGlzIGRpcmVjdGx5IGFuIElQIGFkZHJlc3MsIHJldHVybiB0aGUgc2FtZQogICAg
      ICAgIGlmIGlwX3JlZ194Lm1hdGNoKGhvc3RfbmFtZSk6CiAgICAgICAgICAgIHJldHVybiBob3N0
      X25hbWUKICAgICAgICBpbXBvcnQgcmFuZG9tCgogICAgICAgIGhvc3RfaXAgPSBzZWxmLmR1bW15
      X2hvc3RfaXBfbWFwLmdldChob3N0X25hbWUsICIiKQogICAgICAgIGlmIG5vdCBob3N0X2lwOgog
      ICAgICAgICAgICBob3N0X2lwID0gIjE3Mi45Lnt9Lnt9Ii5mb3JtYXQoCiAgICAgICAgICAgICAg
      ICByYW5kb20ucmFuZGludCgwLCAyNTQpLCByYW5kb20ucmFuZGludCgwLCAyNTQpCiAgICAgICAg
      ICAgICkKICAgICAgICAgICAgc2VsZi5kdW1teV9ob3N0X2lwX21hcFtob3N0X25hbWVdID0gaG9z
      dF9pcAogICAgICAgIGRlbCByYW5kb20KICAgICAgICByZXR1cm4gaG9zdF9pcAoKICAgIEBjbGFz
      c21ldGhvZAogICAgZGVmIFJhZG9zKGNvbmZmaWxlPU5vbmUpOgogICAgICAgIHJldHVybiBEdW1t
      eVJhZG9zKCkKCgpjbGFzcyBTM0F1dGgoQXV0aEJhc2UpOgoKICAgICIiIkF0dGFjaGVzIEFXUyBB
      dXRoZW50aWNhdGlvbiB0byB0aGUgZ2l2ZW4gUmVxdWVzdCBvYmplY3QuIiIiCgogICAgc2Vydmlj
      ZV9iYXNlX3VybCA9ICJzMy5hbWF6b25hd3MuY29tIgoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBh
      Y2Nlc3Nfa2V5LCBzZWNyZXRfa2V5LCBzZXJ2aWNlX3VybD1Ob25lKToKICAgICAgICBpZiBzZXJ2
      aWNlX3VybDoKICAgICAgICAgICAgc2VsZi5zZXJ2aWNlX2Jhc2VfdXJsID0gc2VydmljZV91cmwK
      ICAgICAgICBzZWxmLmFjY2Vzc19rZXkgPSBzdHIoYWNjZXNzX2tleSkKICAgICAgICBzZWxmLnNl
      Y3JldF9rZXkgPSBzdHIoc2VjcmV0X2tleSkKCiAgICBkZWYgX19jYWxsX18oc2VsZiwgcik6CiAg
      ICAgICAgIyBDcmVhdGUgZGF0ZSBoZWFkZXIgaWYgaXQgaXMgbm90IGNyZWF0ZWQgeWV0LgogICAg
      ICAgIGlmICJkYXRlIiBub3QgaW4gci5oZWFkZXJzIGFuZCAieC1hbXotZGF0ZSIgbm90IGluIHIu
      aGVhZGVyczoKICAgICAgICAgICAgci5oZWFkZXJzWyJkYXRlIl0gPSBmb3JtYXRkYXRlKHRpbWV2
      YWw9Tm9uZSwgbG9jYWx0aW1lPUZhbHNlLCB1c2VnbXQ9VHJ1ZSkKICAgICAgICBzaWduYXR1cmUg
      PSBzZWxmLmdldF9zaWduYXR1cmUocikKICAgICAgICBpZiBweTNrOgogICAgICAgICAgICBzaWdu
      YXR1cmUgPSBzaWduYXR1cmUuZGVjb2RlKCJ1dGYtOCIpCiAgICAgICAgci5oZWFkZXJzWyJBdXRo
      b3JpemF0aW9uIl0gPSAiQVdTICVzOiVzIiAlIChzZWxmLmFjY2Vzc19rZXksIHNpZ25hdHVyZSkK
      ICAgICAgICByZXR1cm4gcgoKICAgIGRlZiBnZXRfc2lnbmF0dXJlKHNlbGYsIHIpOgogICAgICAg
      IGNhbm9uaWNhbF9zdHJpbmcgPSBzZWxmLmdldF9jYW5vbmljYWxfc3RyaW5nKHIudXJsLCByLmhl
      YWRlcnMsIHIubWV0aG9kKQogICAgICAgIGlmIHB5M2s6CiAgICAgICAgICAgIGtleSA9IHNlbGYu
      c2VjcmV0X2tleS5lbmNvZGUoInV0Zi04IikKICAgICAgICAgICAgbXNnID0gY2Fub25pY2FsX3N0
      cmluZy5lbmNvZGUoInV0Zi04IikKICAgICAgICBlbHNlOgogICAgICAgICAgICBrZXkgPSBzZWxm
      LnNlY3JldF9rZXkKICAgICAgICAgICAgbXNnID0gY2Fub25pY2FsX3N0cmluZwogICAgICAgIGgg
      PSBobWFjLm5ldyhrZXksIG1zZywgZGlnZXN0bW9kPXNoYSkKICAgICAgICByZXR1cm4gZW5jb2Rl
      c3RyaW5nKGguZGlnZXN0KCkpLnN0cmlwKCkKCiAgICBkZWYgZ2V0X2Nhbm9uaWNhbF9zdHJpbmco
      c2VsZiwgdXJsLCBoZWFkZXJzLCBtZXRob2QpOgogICAgICAgIHBhcnNlZHVybCA9IHVybHBhcnNl
      KHVybCkKICAgICAgICBvYmplY3RrZXkgPSBwYXJzZWR1cmwucGF0aFsxOl0KCiAgICAgICAgYnVj
      a2V0ID0gcGFyc2VkdXJsLm5ldGxvY1s6IC1sZW4oc2VsZi5zZXJ2aWNlX2Jhc2VfdXJsKV0KICAg
      ICAgICBpZiBsZW4oYnVja2V0KSA+IDE6CiAgICAgICAgICAgICMgcmVtb3ZlIGxhc3QgZG90CiAg
      ICAgICAgICAgIGJ1Y2tldCA9IGJ1Y2tldFs6LTFdCgogICAgICAgIGludGVyZXN0aW5nX2hlYWRl
      cnMgPSB7ImNvbnRlbnQtbWQ1IjogIiIsICJjb250ZW50LXR5cGUiOiAiIiwgImRhdGUiOiAiIn0K
      ICAgICAgICBmb3Iga2V5IGluIGhlYWRlcnM6CiAgICAgICAgICAgIGxrID0ga2V5Lmxvd2VyKCkK
      ICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgbGsgPSBsay5kZWNvZGUoInV0Zi04IikK
      ICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICBpZiBo
      ZWFkZXJzW2tleV0gYW5kICgKICAgICAgICAgICAgICAgIGxrIGluIGludGVyZXN0aW5nX2hlYWRl
      cnMua2V5cygpIG9yIGxrLnN0YXJ0c3dpdGgoIngtYW16LSIpCiAgICAgICAgICAgICk6CiAgICAg
      ICAgICAgICAgICBpbnRlcmVzdGluZ19oZWFkZXJzW2xrXSA9IGhlYWRlcnNba2V5XS5zdHJpcCgp
      CgogICAgICAgICMgSWYgeC1hbXotZGF0ZSBpcyB1c2VkIGl0IHN1cGVyc2VkZXMgdGhlIGRhdGUg
      aGVhZGVyLgogICAgICAgIGlmIG5vdCBweTNrOgogICAgICAgICAgICBpZiAieC1hbXotZGF0ZSIg
      aW4gaW50ZXJlc3RpbmdfaGVhZGVyczoKICAgICAgICAgICAgICAgIGludGVyZXN0aW5nX2hlYWRl
      cnNbImRhdGUiXSA9ICIiCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaWYgIngtYW16LWRhdGUi
      IGluIGludGVyZXN0aW5nX2hlYWRlcnM6CiAgICAgICAgICAgICAgICBpbnRlcmVzdGluZ19oZWFk
      ZXJzWyJkYXRlIl0gPSAiIgoKICAgICAgICBidWYgPSAiJXNcbiIgJSBtZXRob2QKICAgICAgICBm
      b3Iga2V5IGluIHNvcnRlZChpbnRlcmVzdGluZ19oZWFkZXJzLmtleXMoKSk6CiAgICAgICAgICAg
      IHZhbCA9IGludGVyZXN0aW5nX2hlYWRlcnNba2V5XQogICAgICAgICAgICBpZiBrZXkuc3RhcnRz
      d2l0aCgieC1hbXotIik6CiAgICAgICAgICAgICAgICBidWYgKz0gIiVzOiVzXG4iICUgKGtleSwg
      dmFsKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgYnVmICs9ICIlc1xuIiAlIHZh
      bAoKICAgICAgICAjIGFwcGVuZCB0aGUgYnVja2V0IGlmIGl0IGV4aXN0cwogICAgICAgIGlmIGJ1
      Y2tldCAhPSAiIjoKICAgICAgICAgICAgYnVmICs9ICIvJXMiICUgYnVja2V0CgogICAgICAgICMg
      YWRkIHRoZSBvYmplY3RrZXkuIGV2ZW4gaWYgaXQgZG9lc24ndCBleGlzdCwgYWRkIHRoZSBzbGFz
      aAogICAgICAgIGJ1ZiArPSAiLyVzIiAlIG9iamVjdGtleQoKICAgICAgICByZXR1cm4gYnVmCgoK
      Y2xhc3MgUmFkb3NKU09OOgogICAgRVhURVJOQUxfVVNFUl9OQU1FID0gImNsaWVudC5oZWFsdGhj
      aGVja2VyIgogICAgRVhURVJOQUxfUkdXX0FETUlOX09QU19VU0VSX05BTUUgPSAicmd3LWFkbWlu
      LW9wcy11c2VyIgogICAgRU1QVFlfT1VUUFVUX0xJU1QgPSAiRW1wdHkgb3V0cHV0IGxpc3QiCiAg
      ICBERUZBVUxUX1JHV19QT09MX1BSRUZJWCA9ICJkZWZhdWx0IgogICAgREVGQVVMVF9NT05JVE9S
      SU5HX0VORFBPSU5UX1BPUlQgPSAiOTI4MyIKCiAgICBAY2xhc3NtZXRob2QKICAgIGRlZiBnZW5f
      YXJnX3BhcnNlcihjbHMsIGFyZ3NfdG9fcGFyc2U9Tm9uZSk6CiAgICAgICAgYXJnUCA9IGFyZ3Bh
      cnNlLkFyZ3VtZW50UGFyc2VyKCkKCiAgICAgICAgY29tbW9uX2dyb3VwID0gYXJnUC5hZGRfYXJn
      dW1lbnRfZ3JvdXAoImNvbW1vbiIpCiAgICAgICAgY29tbW9uX2dyb3VwLmFkZF9hcmd1bWVudCgi
      LS12ZXJib3NlIiwgIi12IiwgYWN0aW9uPSJzdG9yZV90cnVlIiwgZGVmYXVsdD1GYWxzZSkKICAg
      ICAgICBjb21tb25fZ3JvdXAuYWRkX2FyZ3VtZW50KAogICAgICAgICAgICAiLS1jZXBoLWNvbmYi
      LCAiLWMiLCBoZWxwPSJQcm92aWRlIGEgY2VwaCBjb25mIGZpbGUuIiwgdHlwZT1zdHIKICAgICAg
      ICApCiAgICAgICAgY29tbW9uX2dyb3VwLmFkZF9hcmd1bWVudCgKICAgICAgICAgICAgIi0tcnVu
      LWFzLXVzZXIiLAogICAgICAgICAgICAiLXUiLAogICAgICAgICAgICBkZWZhdWx0PSIiLAogICAg
      ICAgICAgICB0eXBlPXN0ciwKICAgICAgICAgICAgaGVscD0iUHJvdmlkZXMgYSB1c2VyIG5hbWUg
      dG8gY2hlY2sgdGhlIGNsdXN0ZXIncyBoZWFsdGggc3RhdHVzLCBtdXN0IGJlIHByZWZpeGVkIGJ5
      ICdjbGllbnQuJyIsCiAgICAgICAgKQogICAgICAgIGNvbW1vbl9ncm91cC5hZGRfYXJndW1lbnQo
      CiAgICAgICAgICAgICItLWNsdXN0ZXItbmFtZSIsIGRlZmF1bHQ9IiIsIGhlbHA9IkNlcGggY2x1
      c3RlciBuYW1lIgogICAgICAgICkKICAgICAgICBjb21tb25fZ3JvdXAuYWRkX2FyZ3VtZW50KAog
      ICAgICAgICAgICAiLS1uYW1lc3BhY2UiLCBkZWZhdWx0PSIiLCBoZWxwPSJOYW1lc3BhY2Ugd2hl
      cmUgQ2VwaENsdXN0ZXIgaXMgcnVubmluZyIKICAgICAgICApCiAgICAgICAgY29tbW9uX2dyb3Vw
      LmFkZF9hcmd1bWVudCgKICAgICAgICAgICAgIi0tcmd3LXBvb2wtcHJlZml4IiwgZGVmYXVsdD0i
      IiwgaGVscD0iUkdXIFBvb2wgcHJlZml4IgogICAgICAgICkKICAgICAgICBjb21tb25fZ3JvdXAu
      YWRkX2FyZ3VtZW50KAogICAgICAgICAgICAiLS1yZXN0cmljdGVkLWF1dGgtcGVybWlzc2lvbiIs
      CiAgICAgICAgICAgIGRlZmF1bHQ9RmFsc2UsCiAgICAgICAgICAgIGhlbHA9IlJlc3RyaWN0ZWQg
      Y2VwaENTSUtleXJpbmdzIGF1dGggcGVybWlzc2lvbnMgdG8gc3BlY2lmaWMgcG9vbHMsIGNsdXN0
      ZXIuIgogICAgICAgICAgICArICJNYW5kYXRvcnkgZmxhZ3MgdGhhdCBuZWVkIHRvIGJlIHNldCBh
      cmUgLS1yYmQtZGF0YS1wb29sLW5hbWUsIGFuZCAtLWNsdXN0ZXItbmFtZS4iCiAgICAgICAgICAg
      ICsgIi0tY2VwaGZzLWZpbGVzeXN0ZW0tbmFtZSBmbGFnIGNhbiBhbHNvIGJlIHBhc3NlZCBpbiBj
      YXNlIG9mIGNlcGhmcyB1c2VyIHJlc3RyaWN0aW9uLCBzbyBpdCBjYW4gcmVzdHJpY3QgdXNlciB0
      byBwYXJ0aWN1bGFyIGNlcGhmcyBmaWxlc3lzdGVtIgogICAgICAgICAgICArICJzYW1wbGUgcnVu
      OiBgcHl0aG9uMyAvZXRjL2NlcGgvY3JlYXRlLWV4dGVybmFsLWNsdXN0ZXItcmVzb3VyY2VzLnB5
      IC0tY2VwaGZzLWZpbGVzeXN0ZW0tbmFtZSBteWZzIC0tcmJkLWRhdGEtcG9vbC1uYW1lIHJlcGxp
      Y2Fwb29sIC0tY2x1c3Rlci1uYW1lIHJvb2tTdG9yYWdlIC0tcmVzdHJpY3RlZC1hdXRoLXBlcm1p
      c3Npb24gdHJ1ZWAiCiAgICAgICAgICAgICsgIk5vdGU6IFJlc3RyaWN0aW5nIHRoZSB1c2VycyBw
      ZXIgcG9vbCwgYW5kIHBlciBjbHVzdGVyIHdpbGwgcmVxdWlyZSB0byBjcmVhdGUgbmV3IHVzZXJz
      IGFuZCBuZXcgc2VjcmV0cyBmb3IgdGhhdCB1c2Vycy4iLAogICAgICAgICkKCiAgICAgICAgb3V0
      cHV0X2dyb3VwID0gYXJnUC5hZGRfYXJndW1lbnRfZ3JvdXAoIm91dHB1dCIpCiAgICAgICAgb3V0
      cHV0X2dyb3VwLmFkZF9hcmd1bWVudCgKICAgICAgICAgICAgIi0tZm9ybWF0IiwKICAgICAgICAg
      ICAgIi10IiwKICAgICAgICAgICAgY2hvaWNlcz1bImpzb24iLCAiYmFzaCJdLAogICAgICAgICAg
      ICBkZWZhdWx0PSJqc29uIiwKICAgICAgICAgICAgaGVscD0iUHJvdmlkZXMgdGhlIG91dHB1dCBm
      b3JtYXQgKGpzb24gfCBiYXNoKSIsCiAgICAgICAgKQogICAgICAgIG91dHB1dF9ncm91cC5hZGRf
      YXJndW1lbnQoCiAgICAgICAgICAgICItLW91dHB1dCIsCiAgICAgICAgICAgICItbyIsCiAgICAg
      ICAgICAgIGRlZmF1bHQ9IiIsCiAgICAgICAgICAgIGhlbHA9Ik91dHB1dCB3aWxsIGJlIHN0b3Jl
      ZCBpbnRvIHRoZSBwcm92aWRlZCBmaWxlIiwKICAgICAgICApCiAgICAgICAgb3V0cHV0X2dyb3Vw
      LmFkZF9hcmd1bWVudCgKICAgICAgICAgICAgIi0tY2VwaGZzLWZpbGVzeXN0ZW0tbmFtZSIsCiAg
      ICAgICAgICAgIGRlZmF1bHQ9IiIsCiAgICAgICAgICAgIGhlbHA9IlByb3ZpZGVzIHRoZSBuYW1l
      IG9mIHRoZSBDZXBoIGZpbGVzeXN0ZW0iLAogICAgICAgICkKICAgICAgICBvdXRwdXRfZ3JvdXAu
      YWRkX2FyZ3VtZW50KAogICAgICAgICAgICAiLS1jZXBoZnMtbWV0YWRhdGEtcG9vbC1uYW1lIiwK
      ICAgICAgICAgICAgZGVmYXVsdD0iIiwKICAgICAgICAgICAgaGVscD0iUHJvdmlkZXMgdGhlIG5h
      bWUgb2YgdGhlIGNlcGhmcyBtZXRhZGF0YSBwb29sIiwKICAgICAgICApCiAgICAgICAgb3V0cHV0
      X2dyb3VwLmFkZF9hcmd1bWVudCgKICAgICAgICAgICAgIi0tY2VwaGZzLWRhdGEtcG9vbC1uYW1l
      IiwKICAgICAgICAgICAgZGVmYXVsdD0iIiwKICAgICAgICAgICAgaGVscD0iUHJvdmlkZXMgdGhl
      IG5hbWUgb2YgdGhlIGNlcGhmcyBkYXRhIHBvb2wiLAogICAgICAgICkKICAgICAgICBvdXRwdXRf
      Z3JvdXAuYWRkX2FyZ3VtZW50KAogICAgICAgICAgICAiLS1yYmQtZGF0YS1wb29sLW5hbWUiLAog
      ICAgICAgICAgICBkZWZhdWx0PSIiLAogICAgICAgICAgICByZXF1aXJlZD1GYWxzZSwKICAgICAg
      ICAgICAgaGVscD0iUHJvdmlkZXMgdGhlIG5hbWUgb2YgdGhlIFJCRCBkYXRhcG9vbCIsCiAgICAg
      ICAgKQogICAgICAgIG91dHB1dF9ncm91cC5hZGRfYXJndW1lbnQoCiAgICAgICAgICAgICItLXJn
      dy1lbmRwb2ludCIsCiAgICAgICAgICAgIGRlZmF1bHQ9IiIsCiAgICAgICAgICAgIHJlcXVpcmVk
      PUZhbHNlLAogICAgICAgICAgICBoZWxwPSJSQURPUyBHYXRld2F5IGVuZHBvaW50IChpbiA8SVA+
      OjxQT1JUPiBmb3JtYXQpLiBOb3RlOiBGUUROIGlzIGFsc28gc3VwcG9ydGVkKGluIDxGUUROPjo8
      UE9SVD4gZm9ybWF0KSIsCiAgICAgICAgKQogICAgICAgIG91dHB1dF9ncm91cC5hZGRfYXJndW1l
      bnQoCiAgICAgICAgICAgICItLXJndy10bHMtY2VydC1wYXRoIiwKICAgICAgICAgICAgZGVmYXVs
      dD0iIiwKICAgICAgICAgICAgcmVxdWlyZWQ9RmFsc2UsCiAgICAgICAgICAgIGhlbHA9IlJBRE9T
      IEdhdGV3YXkgZW5kcG9pbnQgVExTIGNlcnRpZmljYXRlIiwKICAgICAgICApCiAgICAgICAgb3V0
      cHV0X2dyb3VwLmFkZF9hcmd1bWVudCgKICAgICAgICAgICAgIi0tcmd3LXNraXAtdGxzIiwKICAg
      ICAgICAgICAgcmVxdWlyZWQ9RmFsc2UsCiAgICAgICAgICAgIGRlZmF1bHQ9RmFsc2UsCiAgICAg
      ICAgICAgIGhlbHA9Iklnbm9yZSBUTFMgY2VydGlmaWNhdGlvbiB2YWxpZGF0aW9uIHdoZW4gYSBz
      ZWxmLXNpZ25lZCBjZXJ0aWZpY2F0ZSBpcyBwcm92aWRlZCAoTk9UIFJFQ09NTUVOREVEIiwKICAg
      ICAgICApCiAgICAgICAgb3V0cHV0X2dyb3VwLmFkZF9hcmd1bWVudCgKICAgICAgICAgICAgIi0t
      bW9uaXRvcmluZy1lbmRwb2ludCIsCiAgICAgICAgICAgIGRlZmF1bHQ9IiIsCiAgICAgICAgICAg
      IHJlcXVpcmVkPUZhbHNlLAogICAgICAgICAgICBoZWxwPSJDZXBoIE1hbmFnZXIgcHJvbWV0aGV1
      cyBleHBvcnRlciBlbmRwb2ludHMgKGNvbW1hIHNlcGFyYXRlZCBsaXN0IG9mIDxJUD4gZW50cmll
      cyBvZiBhY3RpdmUgYW5kIHN0YW5kYnkgbWdycykiLAogICAgICAgICkKICAgICAgICBvdXRwdXRf
      Z3JvdXAuYWRkX2FyZ3VtZW50KAogICAgICAgICAgICAiLS1tb25pdG9yaW5nLWVuZHBvaW50LXBv
      cnQiLAogICAgICAgICAgICBkZWZhdWx0PSIiLAogICAgICAgICAgICByZXF1aXJlZD1GYWxzZSwK
      ICAgICAgICAgICAgaGVscD0iQ2VwaCBNYW5hZ2VyIHByb21ldGhldXMgZXhwb3J0ZXIgcG9ydCIs
      CiAgICAgICAgKQogICAgICAgIG91dHB1dF9ncm91cC5hZGRfYXJndW1lbnQoCiAgICAgICAgICAg
      ICItLXJiZC1tZXRhZGF0YS1lYy1wb29sLW5hbWUiLAogICAgICAgICAgICBkZWZhdWx0PSIiLAog
      ICAgICAgICAgICByZXF1aXJlZD1GYWxzZSwKICAgICAgICAgICAgaGVscD0iUHJvdmlkZXMgdGhl
      IG5hbWUgb2YgZXJhc3VyZSBjb2RlZCBSQkQgbWV0YWRhdGEgcG9vbCIsCiAgICAgICAgKQogICAg
      ICAgIG91dHB1dF9ncm91cC5hZGRfYXJndW1lbnQoCiAgICAgICAgICAgICItLWRyeS1ydW4iLAog
      ICAgICAgICAgICBkZWZhdWx0PUZhbHNlLAogICAgICAgICAgICBhY3Rpb249InN0b3JlX3RydWUi
      LAogICAgICAgICAgICBoZWxwPSJEcnkgcnVuIHByaW50cyB0aGUgZXhlY3V0ZWQgY29tbWFuZHMg
      d2l0aG91dCBydW5uaW5nIHRoZW0iLAogICAgICAgICkKICAgICAgICBvdXRwdXRfZ3JvdXAuYWRk
      X2FyZ3VtZW50KAogICAgICAgICAgICAiLS1yYWRvcy1uYW1lc3BhY2UiLAogICAgICAgICAgICBk
      ZWZhdWx0PSIiLAogICAgICAgICAgICByZXF1aXJlZD1GYWxzZSwKICAgICAgICAgICAgaGVscD0i
      ZGl2aWRlcyBhIHBvb2wgaW50byBzZXBhcmF0ZSBsb2dpY2FsIG5hbWVzcGFjZXMiLAogICAgICAg
      ICkKICAgICAgICBvdXRwdXRfZ3JvdXAuYWRkX2FyZ3VtZW50KAogICAgICAgICAgICAiLS1zdWJ2
      b2x1bWUtZ3JvdXAiLAogICAgICAgICAgICBkZWZhdWx0PSIiLAogICAgICAgICAgICByZXF1aXJl
      ZD1GYWxzZSwKICAgICAgICAgICAgaGVscD0icHJvdmlkZXMgdGhlIG5hbWUgb2YgdGhlIHN1YnZv
      bHVtZSBncm91cCIsCiAgICAgICAgKQoKICAgICAgICB1cGdyYWRlX2dyb3VwID0gYXJnUC5hZGRf
      YXJndW1lbnRfZ3JvdXAoInVwZ3JhZGUiKQogICAgICAgIHVwZ3JhZGVfZ3JvdXAuYWRkX2FyZ3Vt
      ZW50KAogICAgICAgICAgICAiLS11cGdyYWRlIiwKICAgICAgICAgICAgYWN0aW9uPSJzdG9yZV90
      cnVlIiwKICAgICAgICAgICAgZGVmYXVsdD1GYWxzZSwKICAgICAgICAgICAgaGVscD0iVXBncmFk
      ZXMgdGhlIGNlcGhDU0lLZXlyaW5ncyhGb3IgZXhhbXBsZTogY2xpZW50LmNzaS1jZXBoZnMtcHJv
      dmlzaW9uZXIpIHdpdGggbmV3IHBlcm1pc3Npb25zIG5lZWRlZCBmb3IgdGhlIG5ldyBjbHVzdGVy
      IHZlcnNpb24gYW5kIG9sZGVyIHBlcm1pc3Npb24gd2lsbCBzdGlsbCBiZSBhcHBsaWVkLiIKICAg
      ICAgICAgICAgKyAiU2FtcGxlIHJ1bjogYHB5dGhvbjMgL2V0Yy9jZXBoL2NyZWF0ZS1leHRlcm5h
      bC1jbHVzdGVyLXJlc291cmNlcy5weSAtLXVwZ3JhZGVgLCB0aGlzIHdpbGwgdXBncmFkZSBhbGwg
      dGhlIGRlZmF1bHQgY3NpIHVzZXJzKG5vbi1yZXN0cmljdGVkKSIKICAgICAgICAgICAgKyAiRm9y
      IHJlc3RyaWN0ZWQgdXNlcnMoRm9yIGV4YW1wbGU6IGNsaWVudC5jc2ktY2VwaGZzLXByb3Zpc2lv
      bmVyLW9wZW5zaGlmdC1zdG9yYWdlLW15ZnMpLCB1c2VycyBjcmVhdGVkIHVzaW5nIC0tcmVzdHJp
      Y3RlZC1hdXRoLXBlcm1pc3Npb24gZmxhZyBuZWVkIHRvIHBhc3MgbWFuZGF0b3J5IGZsYWdzIgog
      ICAgICAgICAgICArICJtYW5kYXRvcnkgZmxhZ3M6ICctLXJiZC1kYXRhLXBvb2wtbmFtZSwgLS1j
      bHVzdGVyLW5hbWUgYW5kIC0tcnVuLWFzLXVzZXInIGZsYWdzIHdoaWxlIHVwZ3JhZGluZyIKICAg
      ICAgICAgICAgKyAiaW4gY2FzZSBvZiBjZXBoZnMgdXNlcnMgaWYgeW91IGhhdmUgcGFzc2VkIC0t
      Y2VwaGZzLWZpbGVzeXN0ZW0tbmFtZSBmbGFnIHdoaWxlIGNyZWF0aW5nIHVzZXIgdGhlbiB3aGls
      ZSB1cGdyYWRpbmcgaXQgd2lsbCBiZSBtYW5kYXRvcnkgdG9vIgogICAgICAgICAgICArICJTYW1w
      bGUgcnVuOiBgcHl0aG9uMyAvZXRjL2NlcGgvY3JlYXRlLWV4dGVybmFsLWNsdXN0ZXItcmVzb3Vy
      Y2VzLnB5IC0tdXBncmFkZSAtLXJiZC1kYXRhLXBvb2wtbmFtZSByZXBsaWNhcG9vbCAtLWNsdXN0
      ZXItbmFtZSByb29rU3RvcmFnZSAgLS1ydW4tYXMtdXNlciBjbGllbnQuY3NpLXJiZC1ub2RlLXJv
      b2tTdG9yYWdlLXJlcGxpY2Fwb29sYCIKICAgICAgICAgICAgKyAiUFM6IEFuIGV4aXN0aW5nIG5v
      bi1yZXN0cmljdGVkIHVzZXIgY2Fubm90IGJlIGRvd25ncmFkZWQgdG8gYSByZXN0cmljdGVkIHVz
      ZXIgYnkgdXBncmFkaW5nLiBBZG1pbiBuZWVkIHRvIGNyZWF0ZSBhIG5ldyByZXN0cmljdGVkIHVz
      ZXIgZm9yIHRoaXMgYnkgcmUtcnVubmluZyB0aGUgc2NyaXB0LiIKICAgICAgICAgICAgKyAiVXBn
      cmFkZSBmbGFnIHNob3VsZCBvbmx5IGJlIHVzZWQgdG8gYXBwZW5kIG5ldyBwZXJtaXNzaW9ucyB0
      byB1c2VycywgaXQgc2hvdWxkbid0IGJlIHVzZWQgZm9yIGNoYW5naW5nIHVzZXIgYWxyZWFkeSBh
      cHBsaWVkIHBlcm1pc3Npb24sIGZvciBleGFtcGxlIHlvdSBzaG91bGRuJ3QgY2hhbmdlIGluIHdo
      aWNoIHBvb2wgdXNlciBoYXMgYWNjZXNzIiwKICAgICAgICApCgogICAgICAgIGlmIGFyZ3NfdG9f
      cGFyc2U6CiAgICAgICAgICAgIGFzc2VydCAoCiAgICAgICAgICAgICAgICB0eXBlKGFyZ3NfdG9f
      cGFyc2UpID09IGxpc3QKICAgICAgICAgICAgKSwgIkFyZ3VtZW50IHRvICdnZW5fYXJnX3BhcnNl
      cicgc2hvdWxkIGJlIGEgbGlzdCIKICAgICAgICBlbHNlOgogICAgICAgICAgICBhcmdzX3RvX3Bh
      cnNlID0gc3lzLmFyZ3ZbMTpdCiAgICAgICAgcmV0dXJuIGFyZ1AucGFyc2VfYXJncyhhcmdzX3Rv
      X3BhcnNlKQoKICAgIGRlZiB2YWxpZGF0ZV9yZ3dfbWV0YWRhdGFfZWNfcG9vbF9uYW1lKHNlbGYp
      OgogICAgICAgIGlmIHNlbGYuX2FyZ19wYXJzZXIucmJkX21ldGFkYXRhX2VjX3Bvb2xfbmFtZToK
      ICAgICAgICAgICAgcmJkX21ldGFkYXRhX2VjX3Bvb2xfbmFtZSA9IHNlbGYuX2FyZ19wYXJzZXIu
      cmJkX21ldGFkYXRhX2VjX3Bvb2xfbmFtZQogICAgICAgICAgICByYmRfcG9vbF9uYW1lID0gc2Vs
      Zi5fYXJnX3BhcnNlci5yYmRfZGF0YV9wb29sX25hbWUKCiAgICAgICAgICAgIGlmIHJiZF9wb29s
      X25hbWUgPT0gIiI6CiAgICAgICAgICAgICAgICByYWlzZSBFeGVjdXRpb25GYWlsdXJlRXhjZXB0
      aW9uKAogICAgICAgICAgICAgICAgICAgICJGbGFnICctLXJiZC1kYXRhLXBvb2wtbmFtZScgc2hv
      dWxkIG5vdCBiZSBlbXB0eSIKICAgICAgICAgICAgICAgICkKCiAgICAgICAgICAgIGlmIHJiZF9t
      ZXRhZGF0YV9lY19wb29sX25hbWUgPT0gIiI6CiAgICAgICAgICAgICAgICByYWlzZSBFeGVjdXRp
      b25GYWlsdXJlRXhjZXB0aW9uKAogICAgICAgICAgICAgICAgICAgICJGbGFnICctLXJiZC1tZXRh
      ZGF0YS1lYy1wb29sLW5hbWUnIHNob3VsZCBub3QgYmUgZW1wdHkiCiAgICAgICAgICAgICAgICAp
      CgogICAgICAgICAgICBjbWRfanNvbiA9IHsicHJlZml4IjogIm9zZCBkdW1wIiwgImZvcm1hdCI6
      ICJqc29uIn0KICAgICAgICAgICAgcmV0X3ZhbCwganNvbl9vdXQsIGVycl9tc2cgPSBzZWxmLl9j
      b21tb25fY21kX2pzb25fZ2VuKGNtZF9qc29uKQogICAgICAgICAgICBpZiByZXRfdmFsICE9IDAg
      b3IgbGVuKGpzb25fb3V0KSA9PSAwOgogICAgICAgICAgICAgICAgcmFpc2UgRXhlY3V0aW9uRmFp
      bHVyZUV4Y2VwdGlvbigKICAgICAgICAgICAgICAgICAgICAie30iLmZvcm1hdChjbWRfanNvblsi
      cHJlZml4Il0pCiAgICAgICAgICAgICAgICAgICAgKyAiIGNvbW1hbmQgZmFpbGVkLlxuIgogICAg
      ICAgICAgICAgICAgICAgICsgIkVycm9yOiB7fSIuZm9ybWF0KAogICAgICAgICAgICAgICAgICAg
      ICAgICBlcnJfbXNnIGlmIHJldF92YWwgIT0gMCBlbHNlIHNlbGYuRU1QVFlfT1VUUFVUX0xJU1QK
      ICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgIG1ldGFk
      YXRhX3Bvb2xfZXhpc3QsIHBvb2xfZXhpc3QgPSBGYWxzZSwgRmFsc2UKCiAgICAgICAgICAgIGZv
      ciBrZXkgaW4ganNvbl9vdXRbInBvb2xzIl06CiAgICAgICAgICAgICAgICAjIGlmIGVyYXN1cmVf
      Y29kZV9wcm9maWxlIGlzIGVtcHR5IGFuZCBwb29sIG5hbWUgZXhpc3RzIHRoZW4gaXQgcmVwbGlj
      YSBwb29sCiAgICAgICAgICAgICAgICBpZiAoCiAgICAgICAgICAgICAgICAgICAga2V5WyJlcmFz
      dXJlX2NvZGVfcHJvZmlsZSJdID09ICIiCiAgICAgICAgICAgICAgICAgICAgYW5kIGtleVsicG9v
      bF9uYW1lIl0gPT0gcmJkX21ldGFkYXRhX2VjX3Bvb2xfbmFtZQogICAgICAgICAgICAgICAgKToK
      ICAgICAgICAgICAgICAgICAgICBtZXRhZGF0YV9wb29sX2V4aXN0ID0gVHJ1ZQogICAgICAgICAg
      ICAgICAgIyBpZiBlcmFzdXJlX2NvZGVfcHJvZmlsZSBpcyBub3QgZW1wdHkgYW5kIHBvb2wgbmFt
      ZSBleGlzdHMgdGhlbiBpdCBpcyBlYyBwb29sCiAgICAgICAgICAgICAgICBpZiBrZXlbImVyYXN1
      cmVfY29kZV9wcm9maWxlIl0gYW5kIGtleVsicG9vbF9uYW1lIl0gPT0gcmJkX3Bvb2xfbmFtZToK
      ICAgICAgICAgICAgICAgICAgICBwb29sX2V4aXN0ID0gVHJ1ZQoKICAgICAgICAgICAgaWYgbm90
      IG1ldGFkYXRhX3Bvb2xfZXhpc3Q6CiAgICAgICAgICAgICAgICByYWlzZSBFeGVjdXRpb25GYWls
      dXJlRXhjZXB0aW9uKAogICAgICAgICAgICAgICAgICAgICJQcm92aWRlZCByYmRfZWNfbWV0YWRh
      dGFfcG9vbCBuYW1lLCB7fSwgZG9lcyBub3QgZXhpc3QiLmZvcm1hdCgKICAgICAgICAgICAgICAg
      ICAgICAgICAgcmJkX21ldGFkYXRhX2VjX3Bvb2xfbmFtZQogICAgICAgICAgICAgICAgICAgICkK
      ICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgaWYgbm90IHBvb2xfZXhpc3Q6CiAgICAgICAg
      ICAgICAgICByYWlzZSBFeGVjdXRpb25GYWlsdXJlRXhjZXB0aW9uKAogICAgICAgICAgICAgICAg
      ICAgICJQcm92aWRlZCByYmRfZGF0YV9wb29sIG5hbWUsIHt9LCBkb2VzIG5vdCBleGlzdCIuZm9y
      bWF0KAogICAgICAgICAgICAgICAgICAgICAgICByYmRfcG9vbF9uYW1lCiAgICAgICAgICAgICAg
      ICAgICAgKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICByZXR1cm4gcmJkX21ldGFkYXRh
      X2VjX3Bvb2xfbmFtZQoKICAgIGRlZiBkcnlfcnVuKHNlbGYsIG1zZyk6CiAgICAgICAgaWYgc2Vs
      Zi5fYXJnX3BhcnNlci5kcnlfcnVuOgogICAgICAgICAgICBwcmludCgiRXhlY3V0ZTogIiArICIn
      IiArIG1zZyArICInIikKCiAgICBkZWYgdmFsaWRhdGVfcmd3X2VuZHBvaW50X3Rsc19jZXJ0KHNl
      bGYpOgogICAgICAgIGlmIHNlbGYuX2FyZ19wYXJzZXIucmd3X3Rsc19jZXJ0X3BhdGg6CiAgICAg
      ICAgICAgIHdpdGggb3BlbihzZWxmLl9hcmdfcGFyc2VyLnJnd190bHNfY2VydF9wYXRoLCBlbmNv
      ZGluZz0idXRmOCIpIGFzIGY6CiAgICAgICAgICAgICAgICBjb250ZW50cyA9IGYucmVhZCgpCiAg
      ICAgICAgICAgICAgICByZXR1cm4gY29udGVudHMucnN0cmlwKCkKCiAgICBkZWYgX2NoZWNrX2Nv
      bmZsaWN0aW5nX29wdGlvbnMoc2VsZik6CiAgICAgICAgaWYgbm90IHNlbGYuX2FyZ19wYXJzZXIu
      dXBncmFkZSBhbmQgbm90IHNlbGYuX2FyZ19wYXJzZXIucmJkX2RhdGFfcG9vbF9uYW1lOgogICAg
      ICAgICAgICByYWlzZSBFeGVjdXRpb25GYWlsdXJlRXhjZXB0aW9uKAogICAgICAgICAgICAgICAg
      IkVpdGhlciAnLS11cGdyYWRlJyBvciAnLS1yYmQtZGF0YS1wb29sLW5hbWUgPHBvb2xfbmFtZT4n
      IHNob3VsZCBiZSBzcGVjaWZpZWQiCiAgICAgICAgICAgICkKCiAgICBkZWYgX2ludmFsaWRfZW5k
      cG9pbnQoc2VsZiwgZW5kcG9pbnRfc3RyKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIGlwdjQs
      IHBvcnQgPSBlbmRwb2ludF9zdHIuc3BsaXQoIjoiKQogICAgICAgIGV4Y2VwdCBWYWx1ZUVycm9y
      OgogICAgICAgICAgICByYWlzZSBFeGVjdXRpb25GYWlsdXJlRXhjZXB0aW9uKAogICAgICAgICAg
      ICAgICAgIk5vdCBhIHByb3BlciBlbmRwb2ludDoge30sIDxJUHY0Pjo8UE9SVD4sIGZvcm1hdCBp
      cyBleHBlY3RlZCIuZm9ybWF0KAogICAgICAgICAgICAgICAgICAgIGVuZHBvaW50X3N0cgogICAg
      ICAgICAgICAgICAgKQogICAgICAgICAgICApCiAgICAgICAgaXBQYXJ0cyA9IGlwdjQuc3BsaXQo
      Ii4iKQogICAgICAgIGlmIGxlbihpcFBhcnRzKSAhPSA0OgogICAgICAgICAgICByYWlzZSBFeGVj
      dXRpb25GYWlsdXJlRXhjZXB0aW9uKCJOb3QgYSB2YWxpZCBJUCBhZGRyZXNzOiB7fSIuZm9ybWF0
      KGlwdjQpKQogICAgICAgIGZvciBlYWNoUGFydCBpbiBpcFBhcnRzOgogICAgICAgICAgICBpZiBu
      b3QgZWFjaFBhcnQuaXNkaWdpdCgpOgogICAgICAgICAgICAgICAgcmFpc2UgRXhlY3V0aW9uRmFp
      bHVyZUV4Y2VwdGlvbigKICAgICAgICAgICAgICAgICAgICAiSVAgYWRkcmVzcyBwYXJ0cyBzaG91
      bGQgYmUgbnVtYmVyczoge30iLmZvcm1hdChpcHY0KQogICAgICAgICAgICAgICAgKQogICAgICAg
      ICAgICBpbnRQYXJ0ID0gaW50KGVhY2hQYXJ0KQogICAgICAgICAgICBpZiBpbnRQYXJ0IDwgMCBv
      ciBpbnRQYXJ0ID4gMjU0OgogICAgICAgICAgICAgICAgcmFpc2UgRXhlY3V0aW9uRmFpbHVyZUV4
      Y2VwdGlvbigKICAgICAgICAgICAgICAgICAgICAiT3V0IG9mIHJhbmdlIElQIGFkZHJlc3Nlczog
      e30iLmZvcm1hdChpcHY0KQogICAgICAgICAgICAgICAgKQogICAgICAgIGlmIG5vdCBwb3J0Lmlz
      ZGlnaXQoKToKICAgICAgICAgICAgcmFpc2UgRXhlY3V0aW9uRmFpbHVyZUV4Y2VwdGlvbigiUG9y
      dCBub3QgdmFsaWQ6IHt9Ii5mb3JtYXQocG9ydCkpCiAgICAgICAgaW50UG9ydCA9IGludChwb3J0
      KQogICAgICAgIGlmIGludFBvcnQgPCAxIG9yIGludFBvcnQgPiAyKioxNiAtIDE6CiAgICAgICAg
      ICAgIHJhaXNlIEV4ZWN1dGlvbkZhaWx1cmVFeGNlcHRpb24oIk91dCBvZiByYW5nZSBwb3J0IG51
      bWJlcjoge30iLmZvcm1hdChwb3J0KSkKICAgICAgICByZXR1cm4gRmFsc2UKCiAgICBkZWYgZW5k
      cG9pbnRfZGlhbChzZWxmLCBlbmRwb2ludF9zdHIsIHRpbWVvdXQ9MywgY2VydD1Ob25lKToKICAg
      ICAgICAjIGlmIHRoZSAnY2x1c3RlcicgaW5zdGFuY2UgaXMgYSBkdW1teSBvbmUsCiAgICAgICAg
      IyBkb24ndCB0cnkgdG8gcmVhY2ggb3V0IHRvIHRoZSBlbmRwb2ludAogICAgICAgIGlmIGlzaW5z
      dGFuY2Uoc2VsZi5jbHVzdGVyLCBEdW1teVJhZG9zKToKICAgICAgICAgICAgcmV0dXJuCiAgICAg
      ICAgcHJvdG9jb2xzID0gWyJodHRwIiwgImh0dHBzIl0KICAgICAgICBmb3IgcHJlZml4IGluIHBy
      b3RvY29sczoKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgZXAgPSAie306Ly97fSIu
      Zm9ybWF0KHByZWZpeCwgZW5kcG9pbnRfc3RyKQogICAgICAgICAgICAgICAgIyBJZiB2ZXJpZnkg
      aXMgc2V0IHRvIGEgcGF0aCB0byBhIGRpcmVjdG9yeSwKICAgICAgICAgICAgICAgICMgdGhlIGRp
      cmVjdG9yeSBtdXN0IGhhdmUgYmVlbiBwcm9jZXNzZWQgdXNpbmcgdGhlIGNfcmVoYXNoIHV0aWxp
      dHkgc3VwcGxpZWQgd2l0aCBPcGVuU1NMLgogICAgICAgICAgICAgICAgaWYgcHJlZml4ID09ICJo
      dHRwcyIgYW5kIGNlcnQgYW5kIHNlbGYuX2FyZ19wYXJzZXIucmd3X3NraXBfdGxzOgogICAgICAg
      ICAgICAgICAgICAgIHIgPSByZXF1ZXN0cy5oZWFkKGVwLCB0aW1lb3V0PXRpbWVvdXQsIHZlcmlm
      eT1GYWxzZSkKICAgICAgICAgICAgICAgIGVsaWYgcHJlZml4ID09ICJodHRwcyIgYW5kIGNlcnQ6
      CiAgICAgICAgICAgICAgICAgICAgciA9IHJlcXVlc3RzLmhlYWQoZXAsIHRpbWVvdXQ9dGltZW91
      dCwgdmVyaWZ5PWNlcnQpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAg
      IHIgPSByZXF1ZXN0cy5oZWFkKGVwLCB0aW1lb3V0PXRpbWVvdXQpCiAgICAgICAgICAgICAgICBp
      ZiByLnN0YXR1c19jb2RlID09IDIwMDoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcHJlZml4
      CiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgcmFp
      c2UgRXhlY3V0aW9uRmFpbHVyZUV4Y2VwdGlvbigKICAgICAgICAgICAgInVuYWJsZSB0byBjb25u
      ZWN0IHRvIGVuZHBvaW50OiB7fSIuZm9ybWF0KGVuZHBvaW50X3N0cikKICAgICAgICApCgogICAg
      ZGVmIF9faW5pdF9fKHNlbGYsIGFyZ19saXN0PU5vbmUpOgogICAgICAgIHNlbGYub3V0X21hcCA9
      IHt9CiAgICAgICAgc2VsZi5fZXhjbHVkZWRfa2V5cyA9IHNldCgpCiAgICAgICAgc2VsZi5fYXJn
      X3BhcnNlciA9IHNlbGYuZ2VuX2FyZ19wYXJzZXIoYXJnc190b19wYXJzZT1hcmdfbGlzdCkKICAg
      ICAgICBzZWxmLl9jaGVja19jb25mbGljdGluZ19vcHRpb25zKCkKICAgICAgICBzZWxmLnJ1bl9h
      c191c2VyID0gc2VsZi5fYXJnX3BhcnNlci5ydW5fYXNfdXNlcgogICAgICAgIHNlbGYub3V0cHV0
      X2ZpbGUgPSBzZWxmLl9hcmdfcGFyc2VyLm91dHB1dAogICAgICAgIHNlbGYuY2VwaF9jb25mID0g
      c2VsZi5fYXJnX3BhcnNlci5jZXBoX2NvbmYKICAgICAgICBzZWxmLk1JTl9VU0VSX0NBUF9QRVJN
      SVNTSU9OUyA9IHsKICAgICAgICAgICAgIm1nciI6ICJhbGxvdyBjb21tYW5kIGNvbmZpZyIsCiAg
      ICAgICAgICAgICJtb24iOiAiYWxsb3cgciwgYWxsb3cgY29tbWFuZCBxdW9ydW1fc3RhdHVzLCBh
      bGxvdyBjb21tYW5kIHZlcnNpb24iLAogICAgICAgICAgICAib3NkIjogImFsbG93IHJ3eCBwb29s
      PXswfS5yZ3cubWV0YSwgIgogICAgICAgICAgICArICJhbGxvdyByIHBvb2w9LnJndy5yb290LCAi
      CiAgICAgICAgICAgICsgImFsbG93IHJ3IHBvb2w9ezB9LnJndy5jb250cm9sLCAiCiAgICAgICAg
      ICAgICsgImFsbG93IHJ4IHBvb2w9ezB9LnJndy5sb2csICIKICAgICAgICAgICAgKyAiYWxsb3cg
      eCBwb29sPXswfS5yZ3cuYnVja2V0cy5pbmRleCIsCiAgICAgICAgfQogICAgICAgICMgaWYgdXNl
      ciBub3QgcHJvdmlkZWQsIGdpdmUgYSBkZWZhdWx0IHVzZXIKICAgICAgICBpZiBub3Qgc2VsZi5y
      dW5fYXNfdXNlciBhbmQgbm90IHNlbGYuX2FyZ19wYXJzZXIudXBncmFkZToKICAgICAgICAgICAg
      c2VsZi5ydW5fYXNfdXNlciA9IHNlbGYuRVhURVJOQUxfVVNFUl9OQU1FCiAgICAgICAgaWYgbm90
      IHNlbGYuX2FyZ19wYXJzZXIucmd3X3Bvb2xfcHJlZml4IGFuZCBub3Qgc2VsZi5fYXJnX3BhcnNl
      ci51cGdyYWRlOgogICAgICAgICAgICBzZWxmLl9hcmdfcGFyc2VyLnJnd19wb29sX3ByZWZpeCA9
      IHNlbGYuREVGQVVMVF9SR1dfUE9PTF9QUkVGSVgKICAgICAgICBpZiBzZWxmLmNlcGhfY29uZjoK
      ICAgICAgICAgICAgc2VsZi5jbHVzdGVyID0gcmFkb3MuUmFkb3MoY29uZmZpbGU9c2VsZi5jZXBo
      X2NvbmYpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgc2VsZi5jbHVzdGVyID0gcmFkb3MuUmFk
      b3MoKQogICAgICAgICAgICBzZWxmLmNsdXN0ZXIuY29uZl9yZWFkX2ZpbGUoKQogICAgICAgIHNl
      bGYuY2x1c3Rlci5jb25uZWN0KCkKCiAgICBkZWYgc2h1dGRvd24oc2VsZik6CiAgICAgICAgaWYg
      c2VsZi5jbHVzdGVyLnN0YXRlID09ICJjb25uZWN0ZWQiOgogICAgICAgICAgICBzZWxmLmNsdXN0
      ZXIuc2h1dGRvd24oKQoKICAgIGRlZiBnZXRfZnNpZChzZWxmKToKICAgICAgICBpZiBzZWxmLl9h
      cmdfcGFyc2VyLmRyeV9ydW46CiAgICAgICAgICAgIHJldHVybiBzZWxmLmRyeV9ydW4oImNlcGgg
      ZnNpZCIpCiAgICAgICAgcmV0dXJuIHN0cihzZWxmLmNsdXN0ZXIuZ2V0X2ZzaWQoKSkKCiAgICBk
      ZWYgX2NvbW1vbl9jbWRfanNvbl9nZW4oc2VsZiwgY21kX2pzb24pOgogICAgICAgIGNtZCA9IGpz
      b24uZHVtcHMoY21kX2pzb24sIHNvcnRfa2V5cz1UcnVlKQogICAgICAgIHJldF92YWwsIGNtZF9v
      dXQsIGVycl9tc2cgPSBzZWxmLmNsdXN0ZXIubW9uX2NvbW1hbmQoY21kLCBiIiIpCiAgICAgICAg
      aWYgc2VsZi5fYXJnX3BhcnNlci52ZXJib3NlOgogICAgICAgICAgICBwcmludCgiQ29tbWFuZCBJ
      bnB1dDoge30iLmZvcm1hdChjbWQpKQogICAgICAgICAgICBwcmludCgKICAgICAgICAgICAgICAg
      ICJSZXR1cm4gVmFsOiB7fVxuQ29tbWFuZCBPdXRwdXQ6IHt9XG5FcnJvciBNZXNzYWdlOiB7fVxu
      LS0tLS0tLS0tLVxuIi5mb3JtYXQoCiAgICAgICAgICAgICAgICAgICAgcmV0X3ZhbCwgY21kX291
      dCwgZXJyX21zZwogICAgICAgICAgICAgICAgKQogICAgICAgICAgICApCiAgICAgICAganNvbl9v
      dXQgPSB7fQogICAgICAgICMgaWYgdGhlcmUgaXMgbm8gZXJyb3IgKGkuZTsgcmV0X3ZhbCBpcyBa
      RVJPKSBhbmQgJ2NtZF9vdXQnIGlzIG5vdCBlbXB0eQogICAgICAgICMgdGhlbiBjb252ZXJ0ICdj
      bWRfb3V0JyB0byBhIGpzb24gb3V0cHV0CiAgICAgICAgaWYgcmV0X3ZhbCA9PSAwIGFuZCBjbWRf
      b3V0OgogICAgICAgICAgICBqc29uX291dCA9IGpzb24ubG9hZHMoY21kX291dCkKICAgICAgICBy
      ZXR1cm4gcmV0X3ZhbCwganNvbl9vdXQsIGVycl9tc2cKCiAgICBkZWYgZ2V0X2NlcGhfZXh0ZXJu
      YWxfbW9uX2RhdGEoc2VsZik6CiAgICAgICAgY21kX2pzb24gPSB7InByZWZpeCI6ICJxdW9ydW1f
      c3RhdHVzIiwgImZvcm1hdCI6ICJqc29uIn0KICAgICAgICBpZiBzZWxmLl9hcmdfcGFyc2VyLmRy
      eV9ydW46CiAgICAgICAgICAgIHJldHVybiBzZWxmLmRyeV9ydW4oImNlcGggIiArIGNtZF9qc29u
      WyJwcmVmaXgiXSkKICAgICAgICByZXRfdmFsLCBqc29uX291dCwgZXJyX21zZyA9IHNlbGYuX2Nv
      bW1vbl9jbWRfanNvbl9nZW4oY21kX2pzb24pCiAgICAgICAgIyBpZiB0aGVyZSBpcyBhbiB1bnN1
      Y2Nlc3NmdWwgYXR0ZW1wdCwKICAgICAgICBpZiByZXRfdmFsICE9IDAgb3IgbGVuKGpzb25fb3V0
      KSA9PSAwOgogICAgICAgICAgICByYWlzZSBFeGVjdXRpb25GYWlsdXJlRXhjZXB0aW9uKAogICAg
      ICAgICAgICAgICAgIidxdW9ydW1fc3RhdHVzJyBjb21tYW5kIGZhaWxlZC5cbiIKICAgICAgICAg
      ICAgICAgICsgIkVycm9yOiB7fSIuZm9ybWF0KAogICAgICAgICAgICAgICAgICAgIGVycl9tc2cg
      aWYgcmV0X3ZhbCAhPSAwIGVsc2Ugc2VsZi5FTVBUWV9PVVRQVVRfTElTVAogICAgICAgICAgICAg
      ICAgKQogICAgICAgICAgICApCiAgICAgICAgcV9sZWFkZXJfbmFtZSA9IGpzb25fb3V0WyJxdW9y
      dW1fbGVhZGVyX25hbWUiXQogICAgICAgIHFfbGVhZGVyX2RldGFpbHMgPSB7fQogICAgICAgIHFf
      bGVhZGVyX21hdGNoaW5nX2xpc3QgPSBbCiAgICAgICAgICAgIGwgZm9yIGwgaW4ganNvbl9vdXRb
      Im1vbm1hcCJdWyJtb25zIl0gaWYgbFsibmFtZSJdID09IHFfbGVhZGVyX25hbWUKICAgICAgICBd
      CiAgICAgICAgaWYgbGVuKHFfbGVhZGVyX21hdGNoaW5nX2xpc3QpID09IDA6CiAgICAgICAgICAg
      IHJhaXNlIEV4ZWN1dGlvbkZhaWx1cmVFeGNlcHRpb24oIk5vIG1hdGNoaW5nICdtb24nIGRldGFp
      bHMgZm91bmQiKQogICAgICAgIHFfbGVhZGVyX2RldGFpbHMgPSBxX2xlYWRlcl9tYXRjaGluZ19s
      aXN0WzBdCiAgICAgICAgIyBnZXQgdGhlIGFkZHJlc3MgdmVjdG9yIG9mIHRoZSBxdW9ydW0tbGVh
      ZGVyCiAgICAgICAgcV9sZWFkZXJfYWRkcnZlYyA9IHFfbGVhZGVyX2RldGFpbHMuZ2V0KCJwdWJs
      aWNfYWRkcnMiLCB7fSkuZ2V0KCJhZGRydmVjIiwgW10pCiAgICAgICAgIyBpZiB0aGUgcXVvcnVt
      LWxlYWRlciBoYXMgb25seSBvbmUgYWRkcmVzcyBpbiB0aGUgYWRkcmVzcy12ZWN0b3IKICAgICAg
      ICAjIGFuZCBpdCBpcyBvZiB0eXBlICd2MicgKGllOyB3aXRoIDxJUD46MzMwMCksCiAgICAgICAg
      IyByYWlzZSBhbiBleGNlcHRpb24gdG8gbWFrZSB1c2VyIGF3YXJlIHRoYXQKICAgICAgICAjIHRo
      ZXkgaGF2ZSB0byBlbmFibGUgJ3YxJyAoaWU7IHdpdGggPElQPjo2Nzg5KSB0eXBlIGFzIHdlbGwK
      ICAgICAgICBpZiBsZW4ocV9sZWFkZXJfYWRkcnZlYykgPT0gMSBhbmQgcV9sZWFkZXJfYWRkcnZl
      Y1swXVsidHlwZSJdID09ICJ2MiI6CiAgICAgICAgICAgIHJhaXNlIEV4ZWN1dGlvbkZhaWx1cmVF
      eGNlcHRpb24oCiAgICAgICAgICAgICAgICAiT25seSAndjInIGFkZHJlc3MgdHlwZSBpcyBlbmFi
      bGVkLCB1c2VyIHNob3VsZCBhbHNvIGVuYWJsZSAndjEnIHR5cGUgYXMgd2VsbCIKICAgICAgICAg
      ICAgKQogICAgICAgIGlwX3BvcnQgPSBzdHIocV9sZWFkZXJfZGV0YWlsc1sicHVibGljX2FkZHIi
      XS5zcGxpdCgiLyIpWzBdKQogICAgICAgIHJldHVybiAie309e30iLmZvcm1hdChzdHIocV9sZWFk
      ZXJfbmFtZSksIGlwX3BvcnQpCgogICAgZGVmIF9qb2luX2hvc3RfcG9ydChzZWxmLCBlbmRwb2lu
      dCwgcG9ydCk6CiAgICAgICAgcG9ydCA9ICJ7fSIuZm9ybWF0KHBvcnQpCiAgICAgICAgIyByZWdl
      eCB0byBjaGVjayB0aGUgZ2l2ZW4gZW5kcG9pbnQgaXMgZW5jbG9zZWQgaW4gc3F1YXJlIGJyYWNr
      ZXRzCiAgICAgICAgaXB2Nl9yZWdleCA9IHJlLmNvbXBpbGUociJeXFtbXl1dKlxdJCIpCiAgICAg
      ICAgIyBlbmRwb2ludCBoYXMgJzonIGluIGl0IGFuZCBpZiBub3QgKGFscmVhZHkpIGVuY2xvc2Vk
      IGluIHNxdWFyZSBicmFja2V0cwogICAgICAgIGlmIGVuZHBvaW50LmNvdW50KCI6IikgYW5kIG5v
      dCBpcHY2X3JlZ2V4Lm1hdGNoKGVuZHBvaW50KToKICAgICAgICAgICAgZW5kcG9pbnQgPSAiW3t9
      XSIuZm9ybWF0KGVuZHBvaW50KQogICAgICAgIGlmIG5vdCBwb3J0OgogICAgICAgICAgICByZXR1
      cm4gZW5kcG9pbnQKICAgICAgICByZXR1cm4gIjoiLmpvaW4oW2VuZHBvaW50LCBwb3J0XSkKCiAg
      ICBkZWYgX2NvbnZlcnRfaG9zdG5hbWVfdG9faXAoc2VsZiwgaG9zdF9uYW1lKToKICAgICAgICAj
      IGlmICdjbHVzdGVyJyBpbnN0YW5jZSBpcyBhIGR1bW15IHR5cGUsCiAgICAgICAgIyBjYWxsIHRo
      ZSBkdW1teSBpbnN0YW5jZSdzICJjb252ZXJ0IiBtZXRob2QKICAgICAgICBpZiBub3QgaG9zdF9u
      YW1lOgogICAgICAgICAgICByYWlzZSBFeGVjdXRpb25GYWlsdXJlRXhjZXB0aW9uKCJFbXB0eSBo
      b3N0bmFtZSBwcm92aWRlZCIpCiAgICAgICAgaWYgaXNpbnN0YW5jZShzZWxmLmNsdXN0ZXIsIER1
      bW15UmFkb3MpOgogICAgICAgICAgICByZXR1cm4gc2VsZi5jbHVzdGVyLl9jb252ZXJ0X2hvc3Ru
      YW1lX3RvX2lwKGhvc3RfbmFtZSkKICAgICAgICBpbXBvcnQgc29ja2V0CgogICAgICAgIGlwID0g
      c29ja2V0LmdldGhvc3RieW5hbWUoaG9zdF9uYW1lKQogICAgICAgIGRlbCBzb2NrZXQKICAgICAg
      ICByZXR1cm4gaXAKCiAgICBkZWYgZ2V0X2FjdGl2ZV9hbmRfc3RhbmRieV9tZ3JzKHNlbGYpOgog
      ICAgICAgIGlmIHNlbGYuX2FyZ19wYXJzZXIuZHJ5X3J1bjoKICAgICAgICAgICAgcmV0dXJuICIi
      LCBzZWxmLmRyeV9ydW4oImNlcGggc3RhdHVzIikKICAgICAgICBtb25pdG9yaW5nX2VuZHBvaW50
      X3BvcnQgPSBzZWxmLl9hcmdfcGFyc2VyLm1vbml0b3JpbmdfZW5kcG9pbnRfcG9ydAogICAgICAg
      IG1vbml0b3JpbmdfZW5kcG9pbnRfaXBfbGlzdCA9IHNlbGYuX2FyZ19wYXJzZXIubW9uaXRvcmlu
      Z19lbmRwb2ludAogICAgICAgIHN0YW5kYnlfbWdycyA9IFtdCiAgICAgICAgaWYgbm90IG1vbml0
      b3JpbmdfZW5kcG9pbnRfaXBfbGlzdDoKICAgICAgICAgICAgY21kX2pzb24gPSB7InByZWZpeCI6
      ICJzdGF0dXMiLCAiZm9ybWF0IjogImpzb24ifQogICAgICAgICAgICByZXRfdmFsLCBqc29uX291
      dCwgZXJyX21zZyA9IHNlbGYuX2NvbW1vbl9jbWRfanNvbl9nZW4oY21kX2pzb24pCiAgICAgICAg
      ICAgICMgaWYgdGhlcmUgaXMgYW4gdW5zdWNjZXNzZnVsIGF0dGVtcHQsCiAgICAgICAgICAgIGlm
      IHJldF92YWwgIT0gMCBvciBsZW4oanNvbl9vdXQpID09IDA6CiAgICAgICAgICAgICAgICByYWlz
      ZSBFeGVjdXRpb25GYWlsdXJlRXhjZXB0aW9uKAogICAgICAgICAgICAgICAgICAgICInbWdyIHNl
      cnZpY2VzJyBjb21tYW5kIGZhaWxlZC5cbiIKICAgICAgICAgICAgICAgICAgICArICJFcnJvcjog
      e30iLmZvcm1hdCgKICAgICAgICAgICAgICAgICAgICAgICAgZXJyX21zZyBpZiByZXRfdmFsICE9
      IDAgZWxzZSBzZWxmLkVNUFRZX09VVFBVVF9MSVNUCiAgICAgICAgICAgICAgICAgICAgKQogICAg
      ICAgICAgICAgICAgKQogICAgICAgICAgICBtb25pdG9yaW5nX2VuZHBvaW50ID0gKAogICAgICAg
      ICAgICAgICAganNvbl9vdXQuZ2V0KCJtZ3JtYXAiLCB7fSkuZ2V0KCJzZXJ2aWNlcyIsIHt9KS5n
      ZXQoInByb21ldGhldXMiLCAiIikKICAgICAgICAgICAgKQogICAgICAgICAgICBpZiBub3QgbW9u
      aXRvcmluZ19lbmRwb2ludDoKICAgICAgICAgICAgICAgIHJhaXNlIEV4ZWN1dGlvbkZhaWx1cmVF
      eGNlcHRpb24oCiAgICAgICAgICAgICAgICAgICAgIidwcm9tZXRoZXVzJyBzZXJ2aWNlIG5vdCBm
      b3VuZCwgaXMgdGhlIGV4cG9ydGVyIGVuYWJsZWQ/Jy5cbiIKICAgICAgICAgICAgICAgICkKICAg
      ICAgICAgICAgIyBub3cgY2hlY2sgdGhlIHN0YW5kLWJ5IG1nci1zCiAgICAgICAgICAgIHN0YW5k
      YnlfYXJyID0ganNvbl9vdXQuZ2V0KCJtZ3JtYXAiLCB7fSkuZ2V0KCJzdGFuZGJ5cyIsIFtdKQog
      ICAgICAgICAgICBmb3IgZWFjaF9zdGFuZGJ5IGluIHN0YW5kYnlfYXJyOgogICAgICAgICAgICAg
      ICAgaWYgIm5hbWUiIGluIGVhY2hfc3RhbmRieS5rZXlzKCk6CiAgICAgICAgICAgICAgICAgICAg
      c3RhbmRieV9tZ3JzLmFwcGVuZChlYWNoX3N0YW5kYnlbIm5hbWUiXSkKICAgICAgICAgICAgdHJ5
      OgogICAgICAgICAgICAgICAgcGFyc2VkX2VuZHBvaW50ID0gdXJscGFyc2UobW9uaXRvcmluZ19l
      bmRwb2ludCkKICAgICAgICAgICAgZXhjZXB0IFZhbHVlRXJyb3I6CiAgICAgICAgICAgICAgICBy
      YWlzZSBFeGVjdXRpb25GYWlsdXJlRXhjZXB0aW9uKAogICAgICAgICAgICAgICAgICAgICJpbnZh
      bGlkIGVuZHBvaW50OiB7fSIuZm9ybWF0KG1vbml0b3JpbmdfZW5kcG9pbnQpCiAgICAgICAgICAg
      ICAgICApCiAgICAgICAgICAgIG1vbml0b3JpbmdfZW5kcG9pbnRfaXBfbGlzdCA9IHBhcnNlZF9l
      bmRwb2ludC5ob3N0bmFtZQogICAgICAgICAgICBpZiBub3QgbW9uaXRvcmluZ19lbmRwb2ludF9w
      b3J0OgogICAgICAgICAgICAgICAgbW9uaXRvcmluZ19lbmRwb2ludF9wb3J0ID0gInt9Ii5mb3Jt
      YXQocGFyc2VkX2VuZHBvaW50LnBvcnQpCgogICAgICAgICMgaWYgbW9uaXRvcmluZyBlbmRwb2lu
      dCBwb3J0IGlzIG5vdCBzZXQsIHB1dCBhIGRlZmF1bHQgbW9uIHBvcnQKICAgICAgICBpZiBub3Qg
      bW9uaXRvcmluZ19lbmRwb2ludF9wb3J0OgogICAgICAgICAgICBtb25pdG9yaW5nX2VuZHBvaW50
      X3BvcnQgPSBzZWxmLkRFRkFVTFRfTU9OSVRPUklOR19FTkRQT0lOVF9QT1JUCgogICAgICAgICMg
      dXNlciBjb3VsZCBnaXZlIGNvbW1hIGFuZCBzcGFjZSBzZXBhcmF0ZWQgaW5wdXRzIChsaWtlIC0t
      bW9uaXRvcmluZy1lbmRwb2ludD0iPGlwMT4sIDxpcDI+IikKICAgICAgICBtb25pdG9yaW5nX2Vu
      ZHBvaW50X2lwX2xpc3QgPSBtb25pdG9yaW5nX2VuZHBvaW50X2lwX2xpc3QucmVwbGFjZSgiLCIs
      ICIgIikKICAgICAgICBtb25pdG9yaW5nX2VuZHBvaW50X2lwX2xpc3Rfc3BsaXQgPSBtb25pdG9y
      aW5nX2VuZHBvaW50X2lwX2xpc3Quc3BsaXQoKQogICAgICAgICMgaWYgbW9uaXRvcmluZy1lbmRw
      b2ludCBjb3VsZCBub3QgYmUgZm91bmQsIHJhaXNlIGFuIGVycm9yCiAgICAgICAgaWYgbGVuKG1v
      bml0b3JpbmdfZW5kcG9pbnRfaXBfbGlzdF9zcGxpdCkgPT0gMDoKICAgICAgICAgICAgcmFpc2Ug
      RXhlY3V0aW9uRmFpbHVyZUV4Y2VwdGlvbigiTm8gJ21vbml0b3JpbmctZW5kcG9pbnQnIGZvdW5k
      IikKICAgICAgICAjIGZpcnN0IGlwIGlzIHRyZWF0ZWQgYXMgdGhlIG1haW4gbW9uaXRvcmluZy1l
      bmRwb2ludAogICAgICAgIG1vbml0b3JpbmdfZW5kcG9pbnRfaXAgPSBtb25pdG9yaW5nX2VuZHBv
      aW50X2lwX2xpc3Rfc3BsaXRbMF0KICAgICAgICAjIHJlc3Qgb2YgdGhlIGlwLXMgYXJlIGFkZGVk
      IHRvIHRoZSAnc3RhbmRieV9tZ3JzJyBsaXN0CiAgICAgICAgc3RhbmRieV9tZ3JzLmV4dGVuZCht
      b25pdG9yaW5nX2VuZHBvaW50X2lwX2xpc3Rfc3BsaXRbMTpdKQogICAgICAgIGZhaWxlZF9pcCA9
      IG1vbml0b3JpbmdfZW5kcG9pbnRfaXAKCiAgICAgICAgdHJ5OgogICAgICAgICAgICBtb25pdG9y
      aW5nX2VuZHBvaW50X2lwID0gc2VsZi5fY29udmVydF9ob3N0bmFtZV90b19pcCgKICAgICAgICAg
      ICAgICAgIG1vbml0b3JpbmdfZW5kcG9pbnRfaXAKICAgICAgICAgICAgKQogICAgICAgICAgICAj
      IGNvbGxlY3QgYWxsIHRoZSAnc3RhbmQtYnknIG1nciBpcHMKICAgICAgICAgICAgbWdyX2lwcyA9
      IFtdCiAgICAgICAgICAgIGZvciBlYWNoX3N0YW5kYnlfbWdyIGluIHN0YW5kYnlfbWdyczoKICAg
      ICAgICAgICAgICAgIGZhaWxlZF9pcCA9IGVhY2hfc3RhbmRieV9tZ3IKICAgICAgICAgICAgICAg
      IG1ncl9pcHMuYXBwZW5kKHNlbGYuX2NvbnZlcnRfaG9zdG5hbWVfdG9faXAoZWFjaF9zdGFuZGJ5
      X21ncikpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICByYWlzZSBFeGVjdXRpb25GYWlsdXJl
      RXhjZXB0aW9uKAogICAgICAgICAgICAgICAgIkNvbnZlcnNpb24gb2YgaG9zdDoge30gdG8gSVAg
      ZmFpbGVkLiAiCiAgICAgICAgICAgICAgICAiUGxlYXNlIGVudGVyIHRoZSBJUCBhZGRyZXNzZXMg
      b2YgYWxsIHRoZSBjZXBoLW1ncnMgd2l0aCB0aGUgJy0tbW9uaXRvcmluZy1lbmRwb2ludCcgZmxh
      ZyIuZm9ybWF0KAogICAgICAgICAgICAgICAgICAgIGZhaWxlZF9pcAogICAgICAgICAgICAgICAg
      KQogICAgICAgICAgICApCiAgICAgICAgbW9uaXRvcmluZ19lbmRwb2ludCA9IHNlbGYuX2pvaW5f
      aG9zdF9wb3J0KAogICAgICAgICAgICBtb25pdG9yaW5nX2VuZHBvaW50X2lwLCBtb25pdG9yaW5n
      X2VuZHBvaW50X3BvcnQKICAgICAgICApCiAgICAgICAgc2VsZi5faW52YWxpZF9lbmRwb2ludCht
      b25pdG9yaW5nX2VuZHBvaW50KQogICAgICAgIHNlbGYuZW5kcG9pbnRfZGlhbChtb25pdG9yaW5n
      X2VuZHBvaW50KQoKICAgICAgICAjIGFkZCB0aGUgdmFsaWRhdGVkIGFjdGl2ZSBtZ3IgSVAgaW50
      byB0aGUgZmlyc3QgaW5kZXgKICAgICAgICBtZ3JfaXBzLmluc2VydCgwLCBtb25pdG9yaW5nX2Vu
      ZHBvaW50X2lwKQogICAgICAgIGFsbF9tZ3JfaXBzX3N0ciA9ICIsIi5qb2luKG1ncl9pcHMpCiAg
      ICAgICAgcmV0dXJuIGFsbF9tZ3JfaXBzX3N0ciwgbW9uaXRvcmluZ19lbmRwb2ludF9wb3J0Cgog
      ICAgZGVmIGNoZWNrX3VzZXJfZXhpc3Qoc2VsZiwgdXNlcik6CiAgICAgICAgY21kX2pzb24gPSB7
      InByZWZpeCI6ICJhdXRoIGdldCIsICJlbnRpdHkiOiAie30iLmZvcm1hdCh1c2VyKSwgImZvcm1h
      dCI6ICJqc29uIn0KICAgICAgICByZXRfdmFsLCBqc29uX291dCwgXyA9IHNlbGYuX2NvbW1vbl9j
      bWRfanNvbl9nZW4oY21kX2pzb24pCiAgICAgICAgaWYgcmV0X3ZhbCAhPSAwIG9yIGxlbihqc29u
      X291dCkgPT0gMDoKICAgICAgICAgICAgcmV0dXJuICIiCiAgICAgICAgcmV0dXJuIHN0cihqc29u
      X291dFswXVsia2V5Il0pCgogICAgZGVmIGdldF9jZXBoZnNfcHJvdmlzaW9uZXJfY2Fwc19hbmRf
      ZW50aXR5KHNlbGYpOgogICAgICAgIGVudGl0eSA9ICJjbGllbnQuY3NpLWNlcGhmcy1wcm92aXNp
      b25lciIKICAgICAgICBjYXBzID0gewogICAgICAgICAgICAibW9uIjogImFsbG93IHIsIGFsbG93
      IGNvbW1hbmQgJ29zZCBibG9ja2xpc3QnIiwKICAgICAgICAgICAgIm1nciI6ICJhbGxvdyBydyIs
      CiAgICAgICAgICAgICJvc2QiOiAiYWxsb3cgcncgdGFnIGNlcGhmcyBtZXRhZGF0YT0qIiwKICAg
      ICAgICB9CiAgICAgICAgaWYgc2VsZi5fYXJnX3BhcnNlci5yZXN0cmljdGVkX2F1dGhfcGVybWlz
      c2lvbjoKICAgICAgICAgICAgY2x1c3Rlcl9uYW1lID0gc2VsZi5fYXJnX3BhcnNlci5jbHVzdGVy
      X25hbWUKICAgICAgICAgICAgaWYgY2x1c3Rlcl9uYW1lID09ICIiOgogICAgICAgICAgICAgICAg
      cmFpc2UgRXhlY3V0aW9uRmFpbHVyZUV4Y2VwdGlvbigKICAgICAgICAgICAgICAgICAgICAiY2x1
      c3Rlcl9uYW1lIG5vdCBmb3VuZCwgcGxlYXNlIHNldCB0aGUgJy0tY2x1c3Rlci1uYW1lJyBmbGFn
      IgogICAgICAgICAgICAgICAgKQogICAgICAgICAgICBjZXBoZnNfZmlsZXN5c3RlbSA9IHNlbGYu
      X2FyZ19wYXJzZXIuY2VwaGZzX2ZpbGVzeXN0ZW1fbmFtZQogICAgICAgICAgICBpZiBjZXBoZnNf
      ZmlsZXN5c3RlbSA9PSAiIjoKICAgICAgICAgICAgICAgIGVudGl0eSA9ICJ7fS17fSIuZm9ybWF0
      KGVudGl0eSwgY2x1c3Rlcl9uYW1lKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAg
      ZW50aXR5ID0gInt9LXt9LXt9Ii5mb3JtYXQoZW50aXR5LCBjbHVzdGVyX25hbWUsIGNlcGhmc19m
      aWxlc3lzdGVtKQogICAgICAgICAgICAgICAgY2Fwc1sib3NkIl0gPSAiYWxsb3cgcncgdGFnIGNl
      cGhmcyBtZXRhZGF0YT17fSIuZm9ybWF0KAogICAgICAgICAgICAgICAgICAgIGNlcGhmc19maWxl
      c3lzdGVtCiAgICAgICAgICAgICAgICApCgogICAgICAgIHJldHVybiBjYXBzLCBlbnRpdHkKCiAg
      ICBkZWYgZ2V0X2NlcGhmc19ub2RlX2NhcHNfYW5kX2VudGl0eShzZWxmKToKICAgICAgICBlbnRp
      dHkgPSAiY2xpZW50LmNzaS1jZXBoZnMtbm9kZSIKICAgICAgICBjYXBzID0gewogICAgICAgICAg
      ICAibW9uIjogImFsbG93IHIsIGFsbG93IGNvbW1hbmQgJ29zZCBibG9ja2xpc3QnIiwKICAgICAg
      ICAgICAgIm1nciI6ICJhbGxvdyBydyIsCiAgICAgICAgICAgICJvc2QiOiAiYWxsb3cgcncgdGFn
      IGNlcGhmcyAqPSoiLAogICAgICAgICAgICAibWRzIjogImFsbG93IHJ3IiwKICAgICAgICB9CiAg
      ICAgICAgaWYgc2VsZi5fYXJnX3BhcnNlci5yZXN0cmljdGVkX2F1dGhfcGVybWlzc2lvbjoKICAg
      ICAgICAgICAgY2x1c3Rlcl9uYW1lID0gc2VsZi5fYXJnX3BhcnNlci5jbHVzdGVyX25hbWUKICAg
      ICAgICAgICAgaWYgY2x1c3Rlcl9uYW1lID09ICIiOgogICAgICAgICAgICAgICAgcmFpc2UgRXhl
      Y3V0aW9uRmFpbHVyZUV4Y2VwdGlvbigKICAgICAgICAgICAgICAgICAgICAiY2x1c3Rlcl9uYW1l
      IG5vdCBmb3VuZCwgcGxlYXNlIHNldCB0aGUgJy0tY2x1c3Rlci1uYW1lJyBmbGFnIgogICAgICAg
      ICAgICAgICAgKQogICAgICAgICAgICBjZXBoZnNfZmlsZXN5c3RlbSA9IHNlbGYuX2FyZ19wYXJz
      ZXIuY2VwaGZzX2ZpbGVzeXN0ZW1fbmFtZQogICAgICAgICAgICBpZiBjZXBoZnNfZmlsZXN5c3Rl
      bSA9PSAiIjoKICAgICAgICAgICAgICAgIGVudGl0eSA9ICJ7fS17fSIuZm9ybWF0KGVudGl0eSwg
      Y2x1c3Rlcl9uYW1lKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgZW50aXR5ID0g
      Int9LXt9LXt9Ii5mb3JtYXQoZW50aXR5LCBjbHVzdGVyX25hbWUsIGNlcGhmc19maWxlc3lzdGVt
      KQogICAgICAgICAgICAgICAgY2Fwc1sib3NkIl0gPSAiYWxsb3cgcncgdGFnIGNlcGhmcyAqPXt9
      Ii5mb3JtYXQoY2VwaGZzX2ZpbGVzeXN0ZW0pCgogICAgICAgIHJldHVybiBjYXBzLCBlbnRpdHkK
      CiAgICBkZWYgZ2V0X3JiZF9wcm92aXNpb25lcl9jYXBzX2FuZF9lbnRpdHkoc2VsZik6CiAgICAg
      ICAgZW50aXR5ID0gImNsaWVudC5jc2ktcmJkLXByb3Zpc2lvbmVyIgogICAgICAgIGNhcHMgPSB7
      CiAgICAgICAgICAgICJtb24iOiAicHJvZmlsZSByYmQsIGFsbG93IGNvbW1hbmQgJ29zZCBibG9j
      a2xpc3QnIiwKICAgICAgICAgICAgIm1nciI6ICJhbGxvdyBydyIsCiAgICAgICAgICAgICJvc2Qi
      OiAicHJvZmlsZSByYmQiLAogICAgICAgIH0KICAgICAgICBpZiBzZWxmLl9hcmdfcGFyc2VyLnJl
      c3RyaWN0ZWRfYXV0aF9wZXJtaXNzaW9uOgogICAgICAgICAgICByYmRfcG9vbF9uYW1lID0gc2Vs
      Zi5fYXJnX3BhcnNlci5yYmRfZGF0YV9wb29sX25hbWUKICAgICAgICAgICAgY2x1c3Rlcl9uYW1l
      ID0gc2VsZi5fYXJnX3BhcnNlci5jbHVzdGVyX25hbWUKICAgICAgICAgICAgaWYgcmJkX3Bvb2xf
      bmFtZSA9PSAiIiBvciBjbHVzdGVyX25hbWUgPT0gIiI6CiAgICAgICAgICAgICAgICByYWlzZSBF
      eGVjdXRpb25GYWlsdXJlRXhjZXB0aW9uKAogICAgICAgICAgICAgICAgICAgICJtYW5kYXRvcnkg
      ZmxhZ3Mgbm90IGZvdW5kLCBwbGVhc2Ugc2V0IHRoZSAnLS1yYmQtZGF0YS1wb29sLW5hbWUnLCAn
      LS1jbHVzdGVyLW5hbWUnIGZsYWdzIgogICAgICAgICAgICAgICAgKQogICAgICAgICAgICBlbnRp
      dHkgPSAie30te30te30iLmZvcm1hdCgKICAgICAgICAgICAgICAgIGVudGl0eSwgY2x1c3Rlcl9u
      YW1lLCByYmRfcG9vbF9uYW1lCiAgICAgICAgICAgICkKICAgICAgICAgICAgY2Fwc1sib3NkIl0g
      PSAicHJvZmlsZSByYmQgcG9vbD17fSIuZm9ybWF0KHJiZF9wb29sX25hbWUpCgogICAgICAgIHJl
      dHVybiBjYXBzLCBlbnRpdHkKCiAgICBkZWYgZ2V0X3JiZF9ub2RlX2NhcHNfYW5kX2VudGl0eShz
      ZWxmKToKICAgICAgICBlbnRpdHkgPSAiY2xpZW50LmNzaS1yYmQtbm9kZSIKICAgICAgICBjYXBz
      ID0gewogICAgICAgICAgICAibW9uIjogInByb2ZpbGUgcmJkLCBhbGxvdyBjb21tYW5kICdvc2Qg
      YmxvY2tsaXN0JyIsCiAgICAgICAgICAgICJvc2QiOiAicHJvZmlsZSByYmQiLAogICAgICAgIH0K
      ICAgICAgICBpZiBzZWxmLl9hcmdfcGFyc2VyLnJlc3RyaWN0ZWRfYXV0aF9wZXJtaXNzaW9uOgog
      ICAgICAgICAgICByYmRfcG9vbF9uYW1lID0gc2VsZi5fYXJnX3BhcnNlci5yYmRfZGF0YV9wb29s
      X25hbWUKICAgICAgICAgICAgY2x1c3Rlcl9uYW1lID0gc2VsZi5fYXJnX3BhcnNlci5jbHVzdGVy
      X25hbWUKICAgICAgICAgICAgaWYgcmJkX3Bvb2xfbmFtZSA9PSAiIiBvciBjbHVzdGVyX25hbWUg
      PT0gIiI6CiAgICAgICAgICAgICAgICByYWlzZSBFeGVjdXRpb25GYWlsdXJlRXhjZXB0aW9uKAog
      ICAgICAgICAgICAgICAgICAgICJtYW5kYXRvcnkgZmxhZ3Mgbm90IGZvdW5kLCBwbGVhc2Ugc2V0
      IHRoZSAnLS1yYmQtZGF0YS1wb29sLW5hbWUnLCAnLS1jbHVzdGVyLW5hbWUnIGZsYWdzIgogICAg
      ICAgICAgICAgICAgKQogICAgICAgICAgICBlbnRpdHkgPSAie30te30te30iLmZvcm1hdCgKICAg
      ICAgICAgICAgICAgIGVudGl0eSwgY2x1c3Rlcl9uYW1lLCByYmRfcG9vbF9uYW1lCiAgICAgICAg
      ICAgICkKICAgICAgICAgICAgY2Fwc1sib3NkIl0gPSAicHJvZmlsZSByYmQgcG9vbD17fSIuZm9y
      bWF0KHJiZF9wb29sX25hbWUpCgogICAgICAgIHJldHVybiBjYXBzLCBlbnRpdHkKCiAgICBkZWYg
      Z2V0X2NhcHNfYW5kX2VudGl0eShzZWxmLCB1c2VyX25hbWUpOgogICAgICAgIGlmICJjbGllbnQu
      Y3NpLWNlcGhmcy1wcm92aXNpb25lciIgaW4gdXNlcl9uYW1lOgogICAgICAgICAgICBpZiAiY2xp
      ZW50LmNzaS1jZXBoZnMtcHJvdmlzaW9uZXIiICE9IHVzZXJfbmFtZToKICAgICAgICAgICAgICAg
      IHNlbGYuX2FyZ19wYXJzZXIucmVzdHJpY3RlZF9hdXRoX3Blcm1pc3Npb24gPSBUcnVlCiAgICAg
      ICAgICAgIHJldHVybiBzZWxmLmdldF9jZXBoZnNfcHJvdmlzaW9uZXJfY2Fwc19hbmRfZW50aXR5
      KCkKICAgICAgICBlbGlmICJjbGllbnQuY3NpLWNlcGhmcy1ub2RlIiBpbiB1c2VyX25hbWU6CiAg
      ICAgICAgICAgIGlmICJjbGllbnQuY3NpLWNlcGhmcy1ub2RlIiAhPSB1c2VyX25hbWU6CiAgICAg
      ICAgICAgICAgICBzZWxmLl9hcmdfcGFyc2VyLnJlc3RyaWN0ZWRfYXV0aF9wZXJtaXNzaW9uID0g
      VHJ1ZQogICAgICAgICAgICByZXR1cm4gc2VsZi5nZXRfY2VwaGZzX25vZGVfY2Fwc19hbmRfZW50
      aXR5KCkKICAgICAgICBlbGlmICJjbGllbnQuY3NpLXJiZC1wcm92aXNpb25lciIgaW4gdXNlcl9u
      YW1lOgogICAgICAgICAgICBpZiAiY2xpZW50LmNzaS1yYmQtcHJvdmlzaW9uZXIiICE9IHVzZXJf
      bmFtZToKICAgICAgICAgICAgICAgIHNlbGYuX2FyZ19wYXJzZXIucmVzdHJpY3RlZF9hdXRoX3Bl
      cm1pc3Npb24gPSBUcnVlCiAgICAgICAgICAgIHJldHVybiBzZWxmLmdldF9yYmRfcHJvdmlzaW9u
      ZXJfY2Fwc19hbmRfZW50aXR5KCkKICAgICAgICBlbGlmICJjbGllbnQuY3NpLXJiZC1ub2RlIiBp
      biB1c2VyX25hbWU6CiAgICAgICAgICAgIGlmICJjbGllbnQuY3NpLXJiZC1ub2RlIiAhPSB1c2Vy
      X25hbWU6CiAgICAgICAgICAgICAgICBzZWxmLl9hcmdfcGFyc2VyLnJlc3RyaWN0ZWRfYXV0aF9w
      ZXJtaXNzaW9uID0gVHJ1ZQogICAgICAgICAgICByZXR1cm4gc2VsZi5nZXRfcmJkX25vZGVfY2Fw
      c19hbmRfZW50aXR5KCkKCiAgICAgICAgcmFpc2UgRXhlY3V0aW9uRmFpbHVyZUV4Y2VwdGlvbigK
      ICAgICAgICAgICAgIm5vIHVzZXIgZm91bmQgd2l0aCB1c2VyX25hbWU6IHt9ICwiLmZvcm1hdCh1
      c2VyX25hbWUpCiAgICAgICAgICAgICsgImdldF9jYXBzX2FuZF9lbnRpdHkgY29tbWFuZCBmYWls
      ZWQuXG4iCiAgICAgICAgKQoKICAgIGRlZiBjcmVhdGVfY2VwaENTSUtleXJpbmdfdXNlcihzZWxm
      LCB1c2VyKToKICAgICAgICAiIiIKICAgICAgICBjb21tYW5kOiBjZXBoIGF1dGggZ2V0LW9yLWNy
      ZWF0ZSBjbGllbnQuY3NpLWNlcGhmcy1wcm92aXNpb25lciBtb24gJ2FsbG93IHInIG1nciAnYWxs
      b3cgcncnIG9zZCAnYWxsb3cgcncgdGFnIGNlcGhmcyBtZXRhZGF0YT0qJwogICAgICAgICIiIgog
      ICAgICAgIGNhcHMsIGVudGl0eSA9IHNlbGYuZ2V0X2NhcHNfYW5kX2VudGl0eSh1c2VyKQogICAg
      ICAgIGNtZF9qc29uID0gewogICAgICAgICAgICAicHJlZml4IjogImF1dGggZ2V0LW9yLWNyZWF0
      ZSIsCiAgICAgICAgICAgICJlbnRpdHkiOiBlbnRpdHksCiAgICAgICAgICAgICJjYXBzIjogW2Nh
      cCBmb3IgY2FwX2xpc3QgaW4gbGlzdChjYXBzLml0ZW1zKCkpIGZvciBjYXAgaW4gY2FwX2xpc3Rd
      LAogICAgICAgICAgICAiZm9ybWF0IjogImpzb24iLAogICAgICAgIH0KCiAgICAgICAgaWYgc2Vs
      Zi5fYXJnX3BhcnNlci5kcnlfcnVuOgogICAgICAgICAgICByZXR1cm4gc2VsZi5kcnlfcnVuKAog
      ICAgICAgICAgICAgICAgImNlcGggIgogICAgICAgICAgICAgICAgKyBjbWRfanNvblsicHJlZml4
      Il0KICAgICAgICAgICAgICAgICsgIiAiCiAgICAgICAgICAgICAgICArIGNtZF9qc29uWyJlbnRp
      dHkiXQogICAgICAgICAgICAgICAgKyAiICIKICAgICAgICAgICAgICAgICsgIiAiLmpvaW4oY21k
      X2pzb25bImNhcHMiXSkKICAgICAgICAgICAgKSwgIiIKICAgICAgICAjIGNoZWNrIGlmIHVzZXIg
      YWxyZWFkeSBleGlzdAogICAgICAgIHVzZXJfa2V5ID0gc2VsZi5jaGVja191c2VyX2V4aXN0KGVu
      dGl0eSkKICAgICAgICBpZiB1c2VyX2tleSAhPSAiIjoKICAgICAgICAgICAgcmV0dXJuIHVzZXJf
      a2V5LCAie30iLmZvcm1hdChlbnRpdHkuc3BsaXQoJy4nLDEpWzFdKSAgIyBlbnRpdHkuc3BsaXQo
      Jy4nLDEpWzFdIHRvIHJlbmFtZSBlbnRpdHkoY2xpZW50LmNzaS1yYmQtbm9kZSkgYXMgY3NpLXJi
      ZC1ub2RlCgogICAgICAgIHJldF92YWwsIGpzb25fb3V0LCBlcnJfbXNnID0gc2VsZi5fY29tbW9u
      X2NtZF9qc29uX2dlbihjbWRfanNvbikKICAgICAgICAjIGlmIHRoZXJlIGlzIGFuIHVuc3VjY2Vz
      c2Z1bCBhdHRlbXB0LAogICAgICAgIGlmIHJldF92YWwgIT0gMCBvciBsZW4oanNvbl9vdXQpID09
      IDA6CiAgICAgICAgICAgIHJhaXNlIEV4ZWN1dGlvbkZhaWx1cmVFeGNlcHRpb24oCiAgICAgICAg
      ICAgICAgICAiJ2F1dGggZ2V0LW9yLWNyZWF0ZSB7fScgY29tbWFuZCBmYWlsZWQuXG4iLmZvcm1h
      dCh1c2VyKQogICAgICAgICAgICAgICAgKyAiRXJyb3I6IHt9Ii5mb3JtYXQoCiAgICAgICAgICAg
      ICAgICAgICAgZXJyX21zZyBpZiByZXRfdmFsICE9IDAgZWxzZSBzZWxmLkVNUFRZX09VVFBVVF9M
      SVNUCiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICkKICAgICAgICByZXR1cm4gc3RyKGpz
      b25fb3V0WzBdWyJrZXkiXSksICJ7fSIuZm9ybWF0KGVudGl0eS5zcGxpdCgnLicsMSlbMV0pICAj
      IGVudGl0eS5zcGxpdCgnLicsMSlbMV0gdG8gcmVuYW1lIGVudGl0eShjbGllbnQuY3NpLXJiZC1u
      b2RlKSBhcyBjc2ktcmJkLW5vZGUKCiAgICBkZWYgZ2V0X2NlcGhmc19kYXRhX3Bvb2xfZGV0YWls
      cyhzZWxmKToKICAgICAgICBjbWRfanNvbiA9IHsicHJlZml4IjogImZzIGxzIiwgImZvcm1hdCI6
      ICJqc29uIn0KICAgICAgICBpZiBzZWxmLl9hcmdfcGFyc2VyLmRyeV9ydW46CiAgICAgICAgICAg
      IHJldHVybiBzZWxmLmRyeV9ydW4oImNlcGggIiArIGNtZF9qc29uWyJwcmVmaXgiXSkKICAgICAg
      ICByZXRfdmFsLCBqc29uX291dCwgZXJyX21zZyA9IHNlbGYuX2NvbW1vbl9jbWRfanNvbl9nZW4o
      Y21kX2pzb24pCiAgICAgICAgIyBpZiB0aGVyZSBpcyBhbiB1bnN1Y2Nlc3NmdWwgYXR0ZW1wdCwg
      cmVwb3J0IGFuIGVycm9yCiAgICAgICAgaWYgcmV0X3ZhbCAhPSAwOgogICAgICAgICAgICAjIGlm
      IGZzIGFuZCBkYXRhX3Bvb2wgYXJndW1lbnRzIGFyZSBub3Qgc2V0LCBzaWxlbnRseSByZXR1cm4K
      ICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgc2VsZi5fYXJnX3BhcnNlci5jZXBoZnNf
      ZmlsZXN5c3RlbV9uYW1lID09ICIiCiAgICAgICAgICAgICAgICBhbmQgc2VsZi5fYXJnX3BhcnNl
      ci5jZXBoZnNfZGF0YV9wb29sX25hbWUgPT0gIiIKICAgICAgICAgICAgKToKICAgICAgICAgICAg
      ICAgIHJldHVybgogICAgICAgICAgICAjIGlmIHVzZXIgaGFzIHByb3ZpZGVkIGFueSBvZiB0aGUK
      ICAgICAgICAgICAgIyAnLS1jZXBoZnMtZmlsZXN5c3RlbS1uYW1lJyBvciAnLS1jZXBoZnMtZGF0
      YS1wb29sLW5hbWUnIGFyZ3VtZW50cywKICAgICAgICAgICAgIyByYWlzZSBhbiBleGNlcHRpb24g
      YXMgd2UgYXJlIHVuYWJsZSB0byB2ZXJpZnkgdGhlIGFyZ3MKICAgICAgICAgICAgcmFpc2UgRXhl
      Y3V0aW9uRmFpbHVyZUV4Y2VwdGlvbigKICAgICAgICAgICAgICAgICInZnMgbHMnIGNlcGggY2Fs
      bCBmYWlsZWQgd2l0aCBlcnJvcjoge30iLmZvcm1hdChlcnJfbXNnKQogICAgICAgICAgICApCgog
      ICAgICAgIG1hdGNoaW5nX2pzb25fb3V0ID0ge30KICAgICAgICAjIGlmICctLWNlcGhmcy1maWxl
      c3lzdGVtLW5hbWUnIGFyZ3VtZW50IGlzIHByb3ZpZGVkLAogICAgICAgICMgY2hlY2sgd2hldGhl
      ciB0aGUgcHJvdmlkZWQgZmlsZXN5c3RlbS1uYW1lIGV4aXN0cyBvciBub3QKICAgICAgICBpZiBz
      ZWxmLl9hcmdfcGFyc2VyLmNlcGhmc19maWxlc3lzdGVtX25hbWU6CiAgICAgICAgICAgICMgZ2V0
      IHRoZSBtYXRjaGluZyBsaXN0CiAgICAgICAgICAgIG1hdGNoaW5nX2pzb25fb3V0X2xpc3QgPSBb
      CiAgICAgICAgICAgICAgICBtYXRjaGVkCiAgICAgICAgICAgICAgICBmb3IgbWF0Y2hlZCBpbiBq
      c29uX291dAogICAgICAgICAgICAgICAgaWYgc3RyKG1hdGNoZWRbIm5hbWUiXSkgPT0gc2VsZi5f
      YXJnX3BhcnNlci5jZXBoZnNfZmlsZXN5c3RlbV9uYW1lCiAgICAgICAgICAgIF0KICAgICAgICAg
      ICAgIyB1bmFibGUgdG8gZmluZCBhIG1hdGNoaW5nIGZzLW5hbWUsIHJhaXNlIGFuIGVycm9yCiAg
      ICAgICAgICAgIGlmIGxlbihtYXRjaGluZ19qc29uX291dF9saXN0KSA9PSAwOgogICAgICAgICAg
      ICAgICAgcmFpc2UgRXhlY3V0aW9uRmFpbHVyZUV4Y2VwdGlvbigKICAgICAgICAgICAgICAgICAg
      ICAoCiAgICAgICAgICAgICAgICAgICAgICAgICJGaWxlc3lzdGVtIHByb3ZpZGVkLCAne30nLCAi
      CiAgICAgICAgICAgICAgICAgICAgICAgICsgImlzIG5vdCBmb3VuZCBpbiB0aGUgZnMtbGlzdDog
      J3t9JyIKICAgICAgICAgICAgICAgICAgICApLmZvcm1hdCgKICAgICAgICAgICAgICAgICAgICAg
      ICAgc2VsZi5fYXJnX3BhcnNlci5jZXBoZnNfZmlsZXN5c3RlbV9uYW1lLAogICAgICAgICAgICAg
      ICAgICAgICAgICBbc3RyKHhbIm5hbWUiXSkgZm9yIHggaW4ganNvbl9vdXRdLAogICAgICAgICAg
      ICAgICAgICAgICkKICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgbWF0Y2hpbmdfanNvbl9v
      dXQgPSBtYXRjaGluZ19qc29uX291dF9saXN0WzBdCiAgICAgICAgIyBpZiBjZXBoZnMgZmlsZXN5
      c3RlbSBuYW1lIGlzIG5vdCBwcm92aWRlZCwKICAgICAgICAjIHRyeSB0byBnZXQgYSBkZWZhdWx0
      IGZzIG5hbWUgYnkgZG9pbmcgdGhlIGZvbGxvd2luZwogICAgICAgIGVsc2U6CiAgICAgICAgICAg
      ICMgYS4gY2hlY2sgaWYgdGhlcmUgaXMgb25seSBvbmUgZmlsZXN5c3RlbSBpcyBwcmVzZW50CiAg
      ICAgICAgICAgIGlmIGxlbihqc29uX291dCkgPT0gMToKICAgICAgICAgICAgICAgIG1hdGNoaW5n
      X2pzb25fb3V0ID0ganNvbl9vdXRbMF0KICAgICAgICAgICAgIyBiLiBvciBlbHNlLCBjaGVjayBp
      ZiBkYXRhX3Bvb2wgbmFtZSBpcyBwcm92aWRlZAogICAgICAgICAgICBlbGlmIHNlbGYuX2FyZ19w
      YXJzZXIuY2VwaGZzX2RhdGFfcG9vbF9uYW1lOgogICAgICAgICAgICAgICAgIyBhbmQgaWYgcHJl
      c2VudCwgY2hlY2sgd2hldGhlciB0aGVyZSBleGlzdHMgYSBmcyB3aGljaCBoYXMgdGhlIGRhdGFf
      cG9vbAogICAgICAgICAgICAgICAgZm9yIGVhY2hKIGluIGpzb25fb3V0OgogICAgICAgICAgICAg
      ICAgICAgIGlmIHNlbGYuX2FyZ19wYXJzZXIuY2VwaGZzX2RhdGFfcG9vbF9uYW1lIGluIGVhY2hK
      WyJkYXRhX3Bvb2xzIl06CiAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoaW5nX2pzb25fb3V0
      ID0gZWFjaEoKICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgICAgICMg
      aWYgdGhlcmUgaXMgbm8gbWF0Y2hpbmcgZnMgZXhpc3RzLCB0aGF0IG1lYW5zIHByb3ZpZGVkIGRh
      dGFfcG9vbCBuYW1lIGlzIGludmFsaWQKICAgICAgICAgICAgICAgIGlmIG5vdCBtYXRjaGluZ19q
      c29uX291dDoKICAgICAgICAgICAgICAgICAgICByYWlzZSBFeGVjdXRpb25GYWlsdXJlRXhjZXB0
      aW9uKAogICAgICAgICAgICAgICAgICAgICAgICAiUHJvdmlkZWQgZGF0YV9wb29sIG5hbWUsIHt9
      LCBkb2VzIG5vdCBleGlzdHMiLmZvcm1hdCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNl
      bGYuX2FyZ19wYXJzZXIuY2VwaGZzX2RhdGFfcG9vbF9uYW1lCiAgICAgICAgICAgICAgICAgICAg
      ICAgICkKICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICMgYy4gaWYgbm90aGluZyBp
      cyBzZXQgYW5kIGNvdWxkbid0IGZpbmQgYSBkZWZhdWx0LAogICAgICAgICAgICBlbHNlOgogICAg
      ICAgICAgICAgICAgIyBqdXN0IHJldHVybiBzaWxlbnRseQogICAgICAgICAgICAgICAgcmV0dXJu
      CgogICAgICAgIGlmIG1hdGNoaW5nX2pzb25fb3V0OgogICAgICAgICAgICBzZWxmLl9hcmdfcGFy
      c2VyLmNlcGhmc19maWxlc3lzdGVtX25hbWUgPSBzdHIobWF0Y2hpbmdfanNvbl9vdXRbIm5hbWUi
      XSkKICAgICAgICAgICAgc2VsZi5fYXJnX3BhcnNlci5jZXBoZnNfbWV0YWRhdGFfcG9vbF9uYW1l
      ID0gc3RyKAogICAgICAgICAgICAgICAgbWF0Y2hpbmdfanNvbl9vdXRbIm1ldGFkYXRhX3Bvb2wi
      XQogICAgICAgICAgICApCgogICAgICAgIGlmIHR5cGUobWF0Y2hpbmdfanNvbl9vdXRbImRhdGFf
      cG9vbHMiXSkgPT0gbGlzdDoKICAgICAgICAgICAgIyBpZiB0aGUgdXNlciBoYXMgYWxyZWFkeSBw
      cm92aWRlZCBkYXRhLXBvb2wtbmFtZSwKICAgICAgICAgICAgIyB0aHJvdWdoIC0tY2VwaGZzLWRh
      dGEtcG9vbC1uYW1lCiAgICAgICAgICAgIGlmIHNlbGYuX2FyZ19wYXJzZXIuY2VwaGZzX2RhdGFf
      cG9vbF9uYW1lOgogICAgICAgICAgICAgICAgIyBpZiB0aGUgcHJvdmlkZWQgbmFtZSBpcyBub3Qg
      bWF0Y2hpbmcgd2l0aCB0aGUgb25lIGluIHRoZSBsaXN0CiAgICAgICAgICAgICAgICBpZiAoCiAg
      ICAgICAgICAgICAgICAgICAgc2VsZi5fYXJnX3BhcnNlci5jZXBoZnNfZGF0YV9wb29sX25hbWUK
      ICAgICAgICAgICAgICAgICAgICBub3QgaW4gbWF0Y2hpbmdfanNvbl9vdXRbImRhdGFfcG9vbHMi
      XQogICAgICAgICAgICAgICAgKToKICAgICAgICAgICAgICAgICAgICByYWlzZSBFeGVjdXRpb25G
      YWlsdXJlRXhjZXB0aW9uKAogICAgICAgICAgICAgICAgICAgICAgICAie306ICd7fScsIHt9OiB7
      fSIuZm9ybWF0KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlByb3ZpZGVkIGRhdGEtcG9v
      bC1uYW1lIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2FyZ19wYXJzZXIuY2Vw
      aGZzX2RhdGFfcG9vbF9uYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgImRvZXNuJ3Qg
      bWF0Y2ggZnJvbSB0aGUgZGF0YS1wb29scycgbGlzdCIsCiAgICAgICAgICAgICAgICAgICAgICAg
      ICAgICBbc3RyKHgpIGZvciB4IGluIG1hdGNoaW5nX2pzb25fb3V0WyJkYXRhX3Bvb2xzIl1dLAog
      ICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAg
      ICAjIGlmIGRhdGFfcG9vbCBuYW1lIGlzIG5vdCBwcm92aWRlZCwKICAgICAgICAgICAgIyB0aGVu
      IHRyeSB0byBmaW5kIGEgZGVmYXVsdCBkYXRhIHBvb2wgbmFtZQogICAgICAgICAgICBlbHNlOgog
      ICAgICAgICAgICAgICAgIyBpZiBubyBkYXRhX3Bvb2xzIGV4aXN0LCBzaWxlbnRseSByZXR1cm4K
      ICAgICAgICAgICAgICAgIGlmIGxlbihtYXRjaGluZ19qc29uX291dFsiZGF0YV9wb29scyJdKSA9
      PSAwOgogICAgICAgICAgICAgICAgICAgIHJldHVybgogICAgICAgICAgICAgICAgc2VsZi5fYXJn
      X3BhcnNlci5jZXBoZnNfZGF0YV9wb29sX25hbWUgPSBzdHIoCiAgICAgICAgICAgICAgICAgICAg
      bWF0Y2hpbmdfanNvbl9vdXRbImRhdGFfcG9vbHMiXVswXQogICAgICAgICAgICAgICAgKQogICAg
      ICAgICAgICAjIGlmIHRoZXJlIGFyZSBtb3JlIHRoYW4gb25lICdkYXRhX3Bvb2xzJyBleGlzdCwK
      ICAgICAgICAgICAgIyB0aGVuIHdhcm4gdGhlIHVzZXIgdGhhdCB3ZSBhcmUgdXNpbmcgdGhlIHNl
      bGVjdGVkIG5hbWUKICAgICAgICAgICAgaWYgbGVuKG1hdGNoaW5nX2pzb25fb3V0WyJkYXRhX3Bv
      b2xzIl0pID4gMToKICAgICAgICAgICAgICAgIHByaW50KAogICAgICAgICAgICAgICAgICAgICJ7
      fToge31cbnt9OiAne30nXG4iLmZvcm1hdCgKICAgICAgICAgICAgICAgICAgICAgICAgIldBUk5J
      Tkc6IE11bHRpcGxlIGRhdGEgcG9vbHMgZGV0ZWN0ZWQiLAogICAgICAgICAgICAgICAgICAgICAg
      ICBbc3RyKHgpIGZvciB4IGluIG1hdGNoaW5nX2pzb25fb3V0WyJkYXRhX3Bvb2xzIl1dLAogICAg
      ICAgICAgICAgICAgICAgICAgICAiVXNpbmcgdGhlIGRhdGEtcG9vbCIsCiAgICAgICAgICAgICAg
      ICAgICAgICAgIHNlbGYuX2FyZ19wYXJzZXIuY2VwaGZzX2RhdGFfcG9vbF9uYW1lLAogICAgICAg
      ICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICkKCiAgICBkZWYgY3JlYXRlX2NoZWNrZXJL
      ZXkoc2VsZik6CiAgICAgICAgY21kX2pzb24gPSB7CiAgICAgICAgICAgICJwcmVmaXgiOiAiYXV0
      aCBnZXQtb3ItY3JlYXRlIiwKICAgICAgICAgICAgImVudGl0eSI6IHNlbGYucnVuX2FzX3VzZXIs
      CiAgICAgICAgICAgICJjYXBzIjogWwogICAgICAgICAgICAgICAgIm1vbiIsCiAgICAgICAgICAg
      ICAgICBzZWxmLk1JTl9VU0VSX0NBUF9QRVJNSVNTSU9OU1sibW9uIl0sCiAgICAgICAgICAgICAg
      ICAibWdyIiwKICAgICAgICAgICAgICAgIHNlbGYuTUlOX1VTRVJfQ0FQX1BFUk1JU1NJT05TWyJt
      Z3IiXSwKICAgICAgICAgICAgICAgICJvc2QiLAogICAgICAgICAgICAgICAgc2VsZi5NSU5fVVNF
      Ul9DQVBfUEVSTUlTU0lPTlNbIm9zZCJdLmZvcm1hdCgKICAgICAgICAgICAgICAgICAgICBzZWxm
      Ll9hcmdfcGFyc2VyLnJnd19wb29sX3ByZWZpeAogICAgICAgICAgICAgICAgKSwKICAgICAgICAg
      ICAgXSwKICAgICAgICAgICAgImZvcm1hdCI6ICJqc29uIiwKICAgICAgICB9CiAgICAgICAgaWYg
      c2VsZi5fYXJnX3BhcnNlci5kcnlfcnVuOgogICAgICAgICAgICByZXR1cm4gc2VsZi5kcnlfcnVu
      KAogICAgICAgICAgICAgICAgImNlcGggIgogICAgICAgICAgICAgICAgKyBjbWRfanNvblsicHJl
      Zml4Il0KICAgICAgICAgICAgICAgICsgIiAiCiAgICAgICAgICAgICAgICArIGNtZF9qc29uWyJl
      bnRpdHkiXQogICAgICAgICAgICAgICAgKyAiICIKICAgICAgICAgICAgICAgICsgIiAiLmpvaW4o
      Y21kX2pzb25bImNhcHMiXSkKICAgICAgICAgICAgKQogICAgICAgIHJldF92YWwsIGpzb25fb3V0
      LCBlcnJfbXNnID0gc2VsZi5fY29tbW9uX2NtZF9qc29uX2dlbihjbWRfanNvbikKICAgICAgICAj
      IGlmIHRoZXJlIGlzIGFuIHVuc3VjY2Vzc2Z1bCBhdHRlbXB0LAogICAgICAgIGlmIHJldF92YWwg
      IT0gMCBvciBsZW4oanNvbl9vdXQpID09IDA6CiAgICAgICAgICAgIHJhaXNlIEV4ZWN1dGlvbkZh
      aWx1cmVFeGNlcHRpb24oCiAgICAgICAgICAgICAgICAiJ2F1dGggZ2V0LW9yLWNyZWF0ZSB7fScg
      Y29tbWFuZCBmYWlsZWRcbiIuZm9ybWF0KHNlbGYucnVuX2FzX3VzZXIpCiAgICAgICAgICAgICAg
      ICArICJFcnJvcjoge30iLmZvcm1hdCgKICAgICAgICAgICAgICAgICAgICBlcnJfbXNnIGlmIHJl
      dF92YWwgIT0gMCBlbHNlIHNlbGYuRU1QVFlfT1VUUFVUX0xJU1QKICAgICAgICAgICAgICAgICkK
      ICAgICAgICAgICAgKQogICAgICAgIHJldHVybiBzdHIoanNvbl9vdXRbMF1bImtleSJdKQoKICAg
      IGRlZiBnZXRfY2VwaF9kYXNoYm9hcmRfbGluayhzZWxmKToKICAgICAgICBjbWRfanNvbiA9IHsi
      cHJlZml4IjogIm1nciBzZXJ2aWNlcyIsICJmb3JtYXQiOiAianNvbiJ9CiAgICAgICAgaWYgc2Vs
      Zi5fYXJnX3BhcnNlci5kcnlfcnVuOgogICAgICAgICAgICByZXR1cm4gc2VsZi5kcnlfcnVuKCJj
      ZXBoICIgKyBjbWRfanNvblsicHJlZml4Il0pCiAgICAgICAgcmV0X3ZhbCwganNvbl9vdXQsIF8g
      PSBzZWxmLl9jb21tb25fY21kX2pzb25fZ2VuKGNtZF9qc29uKQogICAgICAgICMgaWYgdGhlcmUg
      aXMgYW4gdW5zdWNjZXNzZnVsIGF0dGVtcHQsCiAgICAgICAgaWYgcmV0X3ZhbCAhPSAwIG9yIGxl
      bihqc29uX291dCkgPT0gMDoKICAgICAgICAgICAgcmV0dXJuIE5vbmUKICAgICAgICBpZiBub3Qg
      ImRhc2hib2FyZCIgaW4ganNvbl9vdXQ6CiAgICAgICAgICAgIHJldHVybiBOb25lCiAgICAgICAg
      cmV0dXJuIGpzb25fb3V0WyJkYXNoYm9hcmQiXQoKICAgIGRlZiBjcmVhdGVfcmd3X2FkbWluX29w
      c191c2VyKHNlbGYpOgogICAgICAgIGNtZCA9IFsKICAgICAgICAgICAgInJhZG9zZ3ctYWRtaW4i
      LAogICAgICAgICAgICAidXNlciIsCiAgICAgICAgICAgICJjcmVhdGUiLAogICAgICAgICAgICAi
      LS11aWQiLAogICAgICAgICAgICBzZWxmLkVYVEVSTkFMX1JHV19BRE1JTl9PUFNfVVNFUl9OQU1F
      LAogICAgICAgICAgICAiLS1kaXNwbGF5LW5hbWUiLAogICAgICAgICAgICAiUm9vayBSR1cgQWRt
      aW4gT3BzIHVzZXIiLAogICAgICAgICAgICAiLS1jYXBzIiwKICAgICAgICAgICAgImluZm89cmVh
      ZDtidWNrZXRzPSo7dXNlcnM9Kjt1c2FnZT1yZWFkO21ldGFkYXRhPXJlYWQ7em9uZT1yZWFkIiwK
      ICAgICAgICBdCiAgICAgICAgaWYgc2VsZi5fYXJnX3BhcnNlci5kcnlfcnVuOgogICAgICAgICAg
      ICByZXR1cm4gc2VsZi5kcnlfcnVuKCJjZXBoICIgKyAiICIuam9pbihjbWQpKQogICAgICAgIHRy
      eToKICAgICAgICAgICAgb3V0cHV0ID0gc3VicHJvY2Vzcy5jaGVja19vdXRwdXQoY21kLCBzdGRl
      cnI9c3VicHJvY2Vzcy5QSVBFKQogICAgICAgIGV4Y2VwdCBzdWJwcm9jZXNzLkNhbGxlZFByb2Nl
      c3NFcnJvciBhcyBleGVjRXJyOgogICAgICAgICAgICAjIGlmIHRoZSB1c2VyIGFscmVhZHkgZXhp
      c3RzLCB3ZSBqdXN0IHF1ZXJ5IGl0CiAgICAgICAgICAgIGlmIGV4ZWNFcnIucmV0dXJuY29kZSA9
      PSBlcnJuby5FRVhJU1Q6CiAgICAgICAgICAgICAgICBjbWQgPSBbCiAgICAgICAgICAgICAgICAg
      ICAgInJhZG9zZ3ctYWRtaW4iLAogICAgICAgICAgICAgICAgICAgICJ1c2VyIiwKICAgICAgICAg
      ICAgICAgICAgICAiaW5mbyIsCiAgICAgICAgICAgICAgICAgICAgIi0tdWlkIiwKICAgICAgICAg
      ICAgICAgICAgICBzZWxmLkVYVEVSTkFMX1JHV19BRE1JTl9PUFNfVVNFUl9OQU1FLAogICAgICAg
      ICAgICAgICAgXQogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIG91dHB1
      dCA9IHN1YnByb2Nlc3MuY2hlY2tfb3V0cHV0KGNtZCwgc3RkZXJyPXN1YnByb2Nlc3MuUElQRSkK
      ICAgICAgICAgICAgICAgIGV4Y2VwdCBzdWJwcm9jZXNzLkNhbGxlZFByb2Nlc3NFcnJvciBhcyBl
      eGVjRXJyOgogICAgICAgICAgICAgICAgICAgIGVycl9tc2cgPSAoCiAgICAgICAgICAgICAgICAg
      ICAgICAgICJmYWlsZWQgdG8gZXhlY3V0ZSBjb21tYW5kICVzLiBPdXRwdXQ6ICVzLiBDb2RlOiAl
      cy4gRXJyb3I6ICVzIgogICAgICAgICAgICAgICAgICAgICAgICAlIChjbWQsIGV4ZWNFcnIub3V0
      cHV0LCBleGVjRXJyLnJldHVybmNvZGUsIGV4ZWNFcnIuc3RkZXJyKQogICAgICAgICAgICAgICAg
      ICAgICkKICAgICAgICAgICAgICAgICAgICByYWlzZSBFeGNlcHRpb24oZXJyX21zZykKICAgICAg
      ICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGVycl9tc2cgPSAoCiAgICAgICAgICAgICAgICAg
      ICAgImZhaWxlZCB0byBleGVjdXRlIGNvbW1hbmQgJXMuIE91dHB1dDogJXMuIENvZGU6ICVzLiBF
      cnJvcjogJXMiCiAgICAgICAgICAgICAgICAgICAgJSAoY21kLCBleGVjRXJyLm91dHB1dCwgZXhl
      Y0Vyci5yZXR1cm5jb2RlLCBleGVjRXJyLnN0ZGVycikKICAgICAgICAgICAgICAgICkKICAgICAg
      ICAgICAgICAgIHJhaXNlIEV4Y2VwdGlvbihlcnJfbXNnKQoKICAgICAgICAjIHNlcGFyYXRlbHkg
      YWRkIGluZm89cmVhZCBjYXBzLCBiZWNhdXNlIHNvbWV0aW1lcyB1c2VycyBhbHJlYWR5IGV4aXRl
      ZCBhbmQgdGhlIGNhcCBkb2Vzbid0IHVwZGF0ZQogICAgICAgIGluZm9fY2FwX3N1cHBvcnRlZCA9
      IFRydWUKICAgICAgICBjbWQgPSBbCiAgICAgICAgICAgICJyYWRvc2d3LWFkbWluIiwKICAgICAg
      ICAgICAgImNhcHMiLAogICAgICAgICAgICAiYWRkIiwKICAgICAgICAgICAgIi0tdWlkIiwKICAg
      ICAgICAgICAgc2VsZi5FWFRFUk5BTF9SR1dfQURNSU5fT1BTX1VTRVJfTkFNRSwKICAgICAgICAg
      ICAgIi0tY2FwcyIsCiAgICAgICAgICAgICJpbmZvPXJlYWQiLAogICAgICAgIF0KICAgICAgICB0
      cnk6CiAgICAgICAgICAgIG91dHB1dCA9IHN1YnByb2Nlc3MuY2hlY2tfb3V0cHV0KGNtZCwgc3Rk
      ZXJyPXN1YnByb2Nlc3MuUElQRSkKICAgICAgICBleGNlcHQgc3VicHJvY2Vzcy5DYWxsZWRQcm9j
      ZXNzRXJyb3IgYXMgZXhlY0VycjoKICAgICAgICAgICAgIyBpZiB0aGUgY2VwaCB2ZXJzaW9uIG5v
      dCBzdXBwb3J0ZWQgZm9yIGFkZGluZyBgaW5mbz1yZWFkYCBjYXAocmd3X3ZhbGlkYXRpb24pCiAg
      ICAgICAgICAgIGlmICgKICAgICAgICAgICAgICAgICJjb3VsZCBub3QgYWRkIGNhcHM6IHVuYWJs
      ZSB0byBhZGQgY2FwczogaW5mbz1yZWFkXG4iCiAgICAgICAgICAgICAgICBpbiBleGVjRXJyLnN0
      ZGVyci5kZWNvZGUoInV0Zi04IikKICAgICAgICAgICAgICAgIGFuZCBleGVjRXJyLnJldHVybmNv
      ZGUgPT0gMjQ0CiAgICAgICAgICAgICk6CiAgICAgICAgICAgICAgICBpbmZvX2NhcF9zdXBwb3J0
      ZWQgPSBGYWxzZQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgZXJyX21zZyA9ICgK
      ICAgICAgICAgICAgICAgICAgICAiZmFpbGVkIHRvIGV4ZWN1dGUgY29tbWFuZCAlcy4gT3V0cHV0
      OiAlcy4gQ29kZTogJXMuIEVycm9yOiAlcyIKICAgICAgICAgICAgICAgICAgICAlIChjbWQsIGV4
      ZWNFcnIub3V0cHV0LCBleGVjRXJyLnJldHVybmNvZGUsIGV4ZWNFcnIuc3RkZXJyKQogICAgICAg
      ICAgICAgICAgKQogICAgICAgICAgICAgICAgcmFpc2UgRXhjZXB0aW9uKGVycl9tc2cpCgogICAg
      ICAgIGpzb25vdXRwdXQgPSBqc29uLmxvYWRzKG91dHB1dCkKICAgICAgICByZXR1cm4gKAogICAg
      ICAgICAgICBqc29ub3V0cHV0WyJrZXlzIl1bMF1bImFjY2Vzc19rZXkiXSwKICAgICAgICAgICAg
      anNvbm91dHB1dFsia2V5cyJdWzBdWyJzZWNyZXRfa2V5Il0sCiAgICAgICAgICAgIGluZm9fY2Fw
      X3N1cHBvcnRlZCwKICAgICAgICApCgogICAgZGVmIGNvbnZlcnRfZnFkbl9yZ3dfZW5kcG9pbnRf
      dG9faXAoc2VsZiwgZnFkbl9yZ3dfZW5kcG9pbnQpOgogICAgICAgIHRyeToKICAgICAgICAgICAg
      ZnFkbiwgcG9ydCA9IGZxZG5fcmd3X2VuZHBvaW50LnNwbGl0KCI6IikKICAgICAgICBleGNlcHQg
      VmFsdWVFcnJvcjoKICAgICAgICAgICAgcmFpc2UgRXhlY3V0aW9uRmFpbHVyZUV4Y2VwdGlvbigK
      ICAgICAgICAgICAgICAgICJOb3QgYSBwcm9wZXIgZW5kcG9pbnQ6IHt9LCA8RlFETj46PFBPUlQ+
      LCBmb3JtYXQgaXMgZXhwZWN0ZWQiLmZvcm1hdCgKICAgICAgICAgICAgICAgICAgICBmcWRuX3Jn
      d19lbmRwb2ludAogICAgICAgICAgICAgICAgKQogICAgICAgICAgICApCiAgICAgICAgcmd3X2Vu
      ZHBvaW50X2lwID0gc2VsZi5fY29udmVydF9ob3N0bmFtZV90b19pcChmcWRuKQogICAgICAgIHJn
      d19lbmRwb2ludF9wb3J0ID0gcG9ydAogICAgICAgIHJnd19lbmRwb2ludCA9IHNlbGYuX2pvaW5f
      aG9zdF9wb3J0KHJnd19lbmRwb2ludF9pcCwgcmd3X2VuZHBvaW50X3BvcnQpCiAgICAgICAgcmV0
      dXJuIHJnd19lbmRwb2ludAoKICAgIGRlZiB2YWxpZGF0ZV9wb29sKHNlbGYpOgogICAgICAgIHBv
      b2xzX3RvX3ZhbGlkYXRlID0gW3NlbGYuX2FyZ19wYXJzZXIucmJkX2RhdGFfcG9vbF9uYW1lXQog
      ICAgICAgICMgaWYgcmd3X2VuZHBvaW50IGlzIHByb3ZpZGVkLCB2YWxpZGF0ZSBpdAogICAgICAg
      IGlmIHNlbGYuX2FyZ19wYXJzZXIucmd3X2VuZHBvaW50OgogICAgICAgICAgICByZ3dfZW5kcG9p
      bnQgPSBzZWxmLl9hcmdfcGFyc2VyLnJnd19lbmRwb2ludAogICAgICAgICAgICBzZWxmLl9pbnZh
      bGlkX2VuZHBvaW50KHJnd19lbmRwb2ludCkKICAgICAgICAgICAgc2VsZi5lbmRwb2ludF9kaWFs
      KHJnd19lbmRwb2ludCwgY2VydD1zZWxmLnZhbGlkYXRlX3Jnd19lbmRwb2ludF90bHNfY2VydCgp
      KQogICAgICAgICAgICAjIG9ubHkgdmFsaWRhdGUgaWYgcmd3X3Bvb2xfcHJlZml4IGlzIHBhc3Nl
      ZCBlbHNlIGl0IHdpbGwgdGFrZSBkZWZhdWx0IHZhbHVlIGFuZCB3ZSBkb24ndCBjcmVhdGUgdGhl
      c2UgZGVmYXVsdCBwb29scwogICAgICAgICAgICBpZiBzZWxmLl9hcmdfcGFyc2VyLnJnd19wb29s
      X3ByZWZpeCAhPSAiZGVmYXVsdCI6CiAgICAgICAgICAgICAgICByZ3dfcG9vbF90b192YWxpZGF0
      ZSA9IFsKICAgICAgICAgICAgICAgICAgICAiezB9LnJndy5tZXRhIi5mb3JtYXQoc2VsZi5fYXJn
      X3BhcnNlci5yZ3dfcG9vbF9wcmVmaXgpLAogICAgICAgICAgICAgICAgICAgICIucmd3LnJvb3Qi
      LAogICAgICAgICAgICAgICAgICAgICJ7MH0ucmd3LmNvbnRyb2wiLmZvcm1hdChzZWxmLl9hcmdf
      cGFyc2VyLnJnd19wb29sX3ByZWZpeCksCiAgICAgICAgICAgICAgICAgICAgInswfS5yZ3cubG9n
      Ii5mb3JtYXQoc2VsZi5fYXJnX3BhcnNlci5yZ3dfcG9vbF9wcmVmaXgpLAogICAgICAgICAgICAg
      ICAgXQogICAgICAgICAgICAgICAgcG9vbHNfdG9fdmFsaWRhdGUuZXh0ZW5kKHJnd19wb29sX3Rv
      X3ZhbGlkYXRlKQoKICAgICAgICBmb3IgcG9vbCBpbiBwb29sc190b192YWxpZGF0ZToKICAgICAg
      ICAgICAgaWYgbm90IHNlbGYuY2x1c3Rlci5wb29sX2V4aXN0cyhwb29sKToKICAgICAgICAgICAg
      ICAgIHJhaXNlIEV4ZWN1dGlvbkZhaWx1cmVFeGNlcHRpb24oCiAgICAgICAgICAgICAgICAgICAg
      IlRoZSBwcm92aWRlZCBwb29sLCAne30nLCBkb2VzIG5vdCBleGlzdCIuZm9ybWF0KHBvb2wpCiAg
      ICAgICAgICAgICAgICApCgogICAgZGVmIHZhbGlkYXRlX3JhZG9zX25hbWVzcGFjZShzZWxmKToK
      ICAgICAgICByYmRfcG9vbF9uYW1lID0gc2VsZi5fYXJnX3BhcnNlci5yYmRfZGF0YV9wb29sX25h
      bWUKICAgICAgICByYWRvc19uYW1lc3BhY2UgPSBzZWxmLl9hcmdfcGFyc2VyLnJhZG9zX25hbWVz
      cGFjZQogICAgICAgIGlmIHJhZG9zX25hbWVzcGFjZSA9PSAiIjoKICAgICAgICAgICAgcmV0dXJu
      CiAgICAgICAgcmJkX2luc3QgPSByYmQuUkJEKCkKICAgICAgICBpb2N0eCA9IHNlbGYuY2x1c3Rl
      ci5vcGVuX2lvY3R4KHJiZF9wb29sX25hbWUpCiAgICAgICAgaWYgcmJkX2luc3QubmFtZXNwYWNl
      X2V4aXN0cyhpb2N0eCwgcmFkb3NfbmFtZXNwYWNlKSA9PSBGYWxzZToKICAgICAgICAgICAgcmFp
      c2UgRXhlY3V0aW9uRmFpbHVyZUV4Y2VwdGlvbigKICAgICAgICAgICAgICAgICgKICAgICAgICAg
      ICAgICAgICAgICAiVGhlIHByb3ZpZGVkIHJhZG9zIE5hbWVzcGFjZSwgJ3t9JywgaXMgbm90IGZv
      dW5kIGluIHRoZSBwb29sICd7fSciCiAgICAgICAgICAgICAgICApLmZvcm1hdChyYWRvc19uYW1l
      c3BhY2UsIHJiZF9wb29sX25hbWUpCiAgICAgICAgICAgICkKCiAgICBkZWYgdmFsaWRhdGVfc3Vi
      dm9sdW1lX2dyb3VwKHNlbGYpOgogICAgICAgIGNlcGhmc19maWxlc3lzdGVtX25hbWUgPSBzZWxm
      Ll9hcmdfcGFyc2VyLmNlcGhmc19maWxlc3lzdGVtX25hbWUKICAgICAgICBzdWJ2b2x1bWVfZ3Jv
      dXAgPSBzZWxmLl9hcmdfcGFyc2VyLnN1YnZvbHVtZV9ncm91cAogICAgICAgIGlmIHN1YnZvbHVt
      ZV9ncm91cCA9PSAiIjoKICAgICAgICAgICAgcmV0dXJuCiAgICAgICAgaWYgY2VwaGZzX2ZpbGVz
      eXN0ZW1fbmFtZSA9PSAiIjoKICAgICAgICAgICAgcmFpc2UgRXhlY3V0aW9uRmFpbHVyZUV4Y2Vw
      dGlvbigKICAgICAgICAgICAgICAgICJpZiBzdWJ2b2x1bWUgZ3JvdXAgaXMgcGFzc2VkIGNlcGhm
      cyBmaWxlc3lzdGVtIG5hbWUgaXMgbWFuZGF0b3J5IHRvIHBhc3MiCiAgICAgICAgICAgICkKCiAg
      ICAgICAgY21kID0gWwogICAgICAgICAgICAiY2VwaCIsCiAgICAgICAgICAgICJmcyIsCiAgICAg
      ICAgICAgICJzdWJ2b2x1bWVncm91cCIsCiAgICAgICAgICAgICJnZXRwYXRoIiwKICAgICAgICAg
      ICAgY2VwaGZzX2ZpbGVzeXN0ZW1fbmFtZSwKICAgICAgICAgICAgc3Vidm9sdW1lX2dyb3VwLAog
      ICAgICAgIF0KICAgICAgICB0cnk6CiAgICAgICAgICAgIF8gPSBzdWJwcm9jZXNzLmNoZWNrX291
      dHB1dChjbWQsIHN0ZGVycj1zdWJwcm9jZXNzLlBJUEUpCiAgICAgICAgZXhjZXB0IHN1YnByb2Nl
      c3MuQ2FsbGVkUHJvY2Vzc0Vycm9yIGFzIGV4ZWNFcnI6CiAgICAgICAgICAgIHJhaXNlIEV4ZWN1
      dGlvbkZhaWx1cmVFeGNlcHRpb24oCiAgICAgICAgICAgICAgICAic3Vidm9sdW1lIGdyb3VwIHt9
      IHBhc3NlZCBkb2Vzbid0IGV4aXN0Ii5mb3JtYXQoc3Vidm9sdW1lX2dyb3VwKQogICAgICAgICAg
      ICApCgogICAgZGVmIGdldF9yZ3dfZnNpZChzZWxmKToKICAgICAgICBhY2Nlc3Nfa2V5ID0gc2Vs
      Zi5vdXRfbWFwWyJSR1dfQURNSU5fT1BTX1VTRVJfQUNDRVNTX0tFWSJdCiAgICAgICAgc2VjcmV0
      X2tleSA9IHNlbGYub3V0X21hcFsiUkdXX0FETUlOX09QU19VU0VSX1NFQ1JFVF9LRVkiXQogICAg
      ICAgIHJnd19lbmRwb2ludCA9IHNlbGYuX2FyZ19wYXJzZXIucmd3X2VuZHBvaW50CiAgICAgICAg
      Y2VydCA9IE5vbmUKICAgICAgICB2ZXJpZnkgPSBOb25lCiAgICAgICAgaWYgc2VsZi5fYXJnX3Bh
      cnNlci5yZ3dfdGxzX2NlcnRfcGF0aCBhbmQgbm90IHNlbGYuX2FyZ19wYXJzZXIucmd3X3NraXBf
      dGxzOgogICAgICAgICAgICBjZXJ0ID0gc2VsZi52YWxpZGF0ZV9yZ3dfZW5kcG9pbnRfdGxzX2Nl
      cnQoKQogICAgICAgICAgICB2ZXJpZnkgPSBUcnVlCiAgICAgICAgaWYgc2VsZi5fYXJnX3BhcnNl
      ci5yZ3dfc2tpcF90bHM6CiAgICAgICAgICAgIHZlcmlmeSA9IEZhbHNlCiAgICAgICAgYmFzZV91
      cmwgPSBzZWxmLmVuZHBvaW50X2RpYWwocmd3X2VuZHBvaW50LCBjZXJ0PWNlcnQpICsgIjovLyIK
      ICAgICAgICBiYXNlX3VybCA9IGJhc2VfdXJsICsgcmd3X2VuZHBvaW50ICsgIi9hZG1pbi9pbmZv
      PyIKICAgICAgICBwYXJhbXMgPSB7ImZvcm1hdCI6ICJqc29uIn0KICAgICAgICByZXF1ZXN0X3Vy
      bCA9IGJhc2VfdXJsICsgdXJsbGliLnBhcnNlLnVybGVuY29kZShwYXJhbXMpCgogICAgICAgIHRy
      eToKICAgICAgICAgICAgciA9IHJlcXVlc3RzLmdldCgKICAgICAgICAgICAgICAgIHJlcXVlc3Rf
      dXJsLAogICAgICAgICAgICAgICAgYXV0aD1TM0F1dGgoYWNjZXNzX2tleSwgc2VjcmV0X2tleSwg
      cmd3X2VuZHBvaW50KSwKICAgICAgICAgICAgICAgIGNlcnQ9Y2VydCwKICAgICAgICAgICAgICAg
      IHZlcmlmeT12ZXJpZnksCiAgICAgICAgICAgICkKICAgICAgICBleGNlcHQgcmVxdWVzdHMuZXhj
      ZXB0aW9ucy5UaW1lb3V0OgogICAgICAgICAgICByYWlzZSBFeGVjdXRpb25GYWlsdXJlRXhjZXB0
      aW9uKAogICAgICAgICAgICAgICAgImludmFsaWQgZW5kcG9pbnQ6LCBub3QgYWJsZSB0byBjYWxs
      IGFkbWluLW9wcyBhcGl7fSIuZm9ybWF0KAogICAgICAgICAgICAgICAgICAgIHJnd19lbmRwb2lu
      dAogICAgICAgICAgICAgICAgKQogICAgICAgICAgICApCiAgICAgICAgcjEgPSByLmpzb24oKQog
      ICAgICAgIGlmIHIxIGlzIE5vbmUgb3IgcjEuZ2V0KCJpbmZvIikgaXMgTm9uZToKICAgICAgICAg
      ICAgcmV0dXJuICIiICAjIEludmFsaWQgcmd3LWVuZHBvaW50IGV4Y2VwdGlvbiB3aWxsIHJldHVy
      bmVkIGJ5IHZhbGlkYXRlX3Jnd19lbmRwb2ludCgpCgogICAgICAgIHJldHVybiByMVsiaW5mbyJd
      WyJzdG9yYWdlX2JhY2tlbmRzIl1bMF1bImNsdXN0ZXJfaWQiXQoKICAgIGRlZiB2YWxpZGF0ZV9y
      Z3dfZW5kcG9pbnQoc2VsZik6CiAgICAgICAgIyBpZiB0aGUgJ2NsdXN0ZXInIGluc3RhbmNlIGlz
      IGEgZHVtbXkgb25lLAogICAgICAgICMgZG9uJ3QgdHJ5IHRvIHJlYWNoIG91dCB0byB0aGUgZW5k
      cG9pbnQKICAgICAgICBpZiBpc2luc3RhbmNlKHNlbGYuY2x1c3RlciwgRHVtbXlSYWRvcyk6CiAg
      ICAgICAgICAgIHJldHVybgogICAgICAgIGZzaWQgPSBzZWxmLmdldF9mc2lkKCkKICAgICAgICBy
      Z3dfZnNpZCA9IHNlbGYuZ2V0X3Jnd19mc2lkKCkKICAgICAgICBpZiBmc2lkICE9IHJnd19mc2lk
      OgogICAgICAgICAgICByYWlzZSBFeGVjdXRpb25GYWlsdXJlRXhjZXB0aW9uKAogICAgICAgICAg
      ICAgICAgKAogICAgICAgICAgICAgICAgICAgICJUaGUgcHJvdmlkZWQgcmd3IEVuZHBvaW50LCAn
      e30nLCBpcyBpbnZhbGlkLiBXZSBhcmUgdmFsaWRhdGluZyBieSBjYWxsaW5nIHRoZSBhZG1pbm9w
      cyBhcGkgdGhyb3VnaCByZ3ctZW5kcG9pbnQgYW5kIHZhbGlkYXRpbmcgdGhlIGNsdXN0ZXJfaWQg
      J3t9JyBpcyBlcXVhbCB0byB0aGUgY2VwaCBjbHVzdGVyIGZzaWQgJ3t9JyIKICAgICAgICAgICAg
      ICAgICkuZm9ybWF0KHNlbGYuX2FyZ19wYXJzZXIucmd3X2VuZHBvaW50LCByZ3dfZnNpZCwgZnNp
      ZCkKICAgICAgICAgICAgKQoKICAgIGRlZiBfZ2VuX291dHB1dF9tYXAoc2VsZik6CiAgICAgICAg
      aWYgc2VsZi5vdXRfbWFwOgogICAgICAgICAgICByZXR1cm4KICAgICAgICBzZWxmLl9hcmdfcGFy
      c2VyLmNsdXN0ZXJfbmFtZSA9IHNlbGYuX2FyZ19wYXJzZXIuY2x1c3Rlcl9uYW1lLmxvd2VyKCkg
      IyBhbHdheXMgY29udmVydCBjbHVzdGVyIG5hbWUgdG8gbG93ZXJjYXNlIGNoYXJhY3RlcnMKICAg
      ICAgICBpZiBzZWxmLl9hcmdfcGFyc2VyLnJnd19lbmRwb2ludDoKICAgICAgICAgICAgc2VsZi5f
      YXJnX3BhcnNlci5yZ3dfZW5kcG9pbnQgPSBzZWxmLmNvbnZlcnRfZnFkbl9yZ3dfZW5kcG9pbnRf
      dG9faXAoCiAgICAgICAgICAgICAgICBzZWxmLl9hcmdfcGFyc2VyLnJnd19lbmRwb2ludAogICAg
      ICAgICAgICApCiAgICAgICAgc2VsZi52YWxpZGF0ZV9wb29sKCkKICAgICAgICBzZWxmLnZhbGlk
      YXRlX3JhZG9zX25hbWVzcGFjZSgpCiAgICAgICAgc2VsZi52YWxpZGF0ZV9zdWJ2b2x1bWVfZ3Jv
      dXAoKQogICAgICAgIHNlbGYuX2V4Y2x1ZGVkX2tleXMuYWRkKCJDTFVTVEVSX05BTUUiKQogICAg
      ICAgIHNlbGYuZ2V0X2NlcGhmc19kYXRhX3Bvb2xfZGV0YWlscygpCiAgICAgICAgc2VsZi5vdXRf
      bWFwWyJOQU1FU1BBQ0UiXSA9IHNlbGYuX2FyZ19wYXJzZXIubmFtZXNwYWNlCiAgICAgICAgc2Vs
      Zi5vdXRfbWFwWyJDTFVTVEVSX05BTUUiXSA9IHNlbGYuX2FyZ19wYXJzZXIuY2x1c3Rlcl9uYW1l
      CiAgICAgICAgc2VsZi5vdXRfbWFwWyJST09LX0VYVEVSTkFMX0ZTSUQiXSA9IHNlbGYuZ2V0X2Zz
      aWQoKQogICAgICAgIHNlbGYub3V0X21hcFsiUk9PS19FWFRFUk5BTF9VU0VSTkFNRSJdID0gc2Vs
      Zi5ydW5fYXNfdXNlcgogICAgICAgIHNlbGYub3V0X21hcFsiUk9PS19FWFRFUk5BTF9DRVBIX01P
      Tl9EQVRBIl0gPSBzZWxmLmdldF9jZXBoX2V4dGVybmFsX21vbl9kYXRhKCkKICAgICAgICBzZWxm
      Lm91dF9tYXBbIlJPT0tfRVhURVJOQUxfVVNFUl9TRUNSRVQiXSA9IHNlbGYuY3JlYXRlX2NoZWNr
      ZXJLZXkoKQogICAgICAgIHNlbGYub3V0X21hcFsiUk9PS19FWFRFUk5BTF9EQVNIQk9BUkRfTElO
      SyJdID0gc2VsZi5nZXRfY2VwaF9kYXNoYm9hcmRfbGluaygpCiAgICAgICAgc2VsZi5vdXRfbWFw
      WyJDU0lfUkJEX05PREVfU0VDUkVUIl0sIHNlbGYub3V0X21hcFsnQ1NJX1JCRF9OT0RFX1NFQ1JF
      VF9OQU1FJ10gPSBzZWxmLmNyZWF0ZV9jZXBoQ1NJS2V5cmluZ191c2VyKAogICAgICAgICAgICAi
      Y2xpZW50LmNzaS1yYmQtbm9kZSIKICAgICAgICApCiAgICAgICAgc2VsZi5vdXRfbWFwWyJDU0lf
      UkJEX1BST1ZJU0lPTkVSX1NFQ1JFVCJdLCBzZWxmLm91dF9tYXBbJ0NTSV9SQkRfUFJPVklTSU9O
      RVJfU0VDUkVUX05BTUUnXSA9IHNlbGYuY3JlYXRlX2NlcGhDU0lLZXlyaW5nX3VzZXIoCiAgICAg
      ICAgICAgICJjbGllbnQuY3NpLXJiZC1wcm92aXNpb25lciIKICAgICAgICApCiAgICAgICAgc2Vs
      Zi5vdXRfbWFwWyJDRVBIRlNfUE9PTF9OQU1FIl0gPSBzZWxmLl9hcmdfcGFyc2VyLmNlcGhmc19k
      YXRhX3Bvb2xfbmFtZQogICAgICAgIHNlbGYub3V0X21hcFsKICAgICAgICAgICAgIkNFUEhGU19N
      RVRBREFUQV9QT09MX05BTUUiCiAgICAgICAgXSA9IHNlbGYuX2FyZ19wYXJzZXIuY2VwaGZzX21l
      dGFkYXRhX3Bvb2xfbmFtZQogICAgICAgIHNlbGYub3V0X21hcFsiQ0VQSEZTX0ZTX05BTUUiXSA9
      IHNlbGYuX2FyZ19wYXJzZXIuY2VwaGZzX2ZpbGVzeXN0ZW1fbmFtZQogICAgICAgIHNlbGYub3V0
      X21hcFsKICAgICAgICAgICAgIlJFU1RSSUNURURfQVVUSF9QRVJNSVNTSU9OIgogICAgICAgIF0g
      PSBzZWxmLl9hcmdfcGFyc2VyLnJlc3RyaWN0ZWRfYXV0aF9wZXJtaXNzaW9uCiAgICAgICAgc2Vs
      Zi5vdXRfbWFwWyJSQURPU19OQU1FU1BBQ0UiXSA9IHNlbGYuX2FyZ19wYXJzZXIucmFkb3NfbmFt
      ZXNwYWNlCiAgICAgICAgc2VsZi5vdXRfbWFwWyJTVUJWT0xVTUVfR1JPVVAiXSA9IHNlbGYuX2Fy
      Z19wYXJzZXIuc3Vidm9sdW1lX2dyb3VwCiAgICAgICAgc2VsZi5vdXRfbWFwWyJDU0lfQ0VQSEZT
      X05PREVfU0VDUkVUIl0gPSAiIgogICAgICAgIHNlbGYub3V0X21hcFsiQ1NJX0NFUEhGU19QUk9W
      SVNJT05FUl9TRUNSRVQiXSA9ICIiCiAgICAgICAgIyBjcmVhdGUgQ2VwaEZTIG5vZGUgYW5kIHBy
      b3Zpc2lvbmVyIGtleXJpbmcgb25seSB3aGVuIE1EUyBleGlzdHMKICAgICAgICBpZiBzZWxmLm91
      dF9tYXBbIkNFUEhGU19GU19OQU1FIl0gYW5kIHNlbGYub3V0X21hcFsiQ0VQSEZTX1BPT0xfTkFN
      RSJdOgogICAgICAgICAgICBzZWxmLm91dF9tYXBbIkNTSV9DRVBIRlNfTk9ERV9TRUNSRVQiXSwg
      c2VsZi5vdXRfbWFwWydDU0lfQ0VQSEZTX05PREVfU0VDUkVUX05BTUUnXSA9IHNlbGYuY3JlYXRl
      X2NlcGhDU0lLZXlyaW5nX3VzZXIoCiAgICAgICAgICAgICAgICAiY2xpZW50LmNzaS1jZXBoZnMt
      bm9kZSIKICAgICAgICAgICAgKQogICAgICAgICAgICBzZWxmLm91dF9tYXBbIkNTSV9DRVBIRlNf
      UFJPVklTSU9ORVJfU0VDUkVUIl0sIHNlbGYub3V0X21hcFsnQ1NJX0NFUEhGU19QUk9WSVNJT05F
      Ul9TRUNSRVRfTkFNRSddID0gc2VsZi5jcmVhdGVfY2VwaENTSUtleXJpbmdfdXNlcigiY2xpZW50
      LmNzaS1jZXBoZnMtcHJvdmlzaW9uZXIiKQogICAgICAgIHNlbGYub3V0X21hcFsiUkdXX0VORFBP
      SU5UIl0gPSBzZWxmLl9hcmdfcGFyc2VyLnJnd19lbmRwb2ludAogICAgICAgIHNlbGYub3V0X21h
      cFsiUkdXX1RMU19DRVJUIl0gPSAiIgogICAgICAgICgKICAgICAgICAgICAgc2VsZi5vdXRfbWFw
      WyJNT05JVE9SSU5HX0VORFBPSU5UIl0sCiAgICAgICAgICAgIHNlbGYub3V0X21hcFsiTU9OSVRP
      UklOR19FTkRQT0lOVF9QT1JUIl0sCiAgICAgICAgKSA9IHNlbGYuZ2V0X2FjdGl2ZV9hbmRfc3Rh
      bmRieV9tZ3JzKCkKICAgICAgICBzZWxmLm91dF9tYXBbIlJCRF9QT09MX05BTUUiXSA9IHNlbGYu
      X2FyZ19wYXJzZXIucmJkX2RhdGFfcG9vbF9uYW1lCiAgICAgICAgc2VsZi5vdXRfbWFwWwogICAg
      ICAgICAgICAiUkJEX01FVEFEQVRBX0VDX1BPT0xfTkFNRSIKICAgICAgICBdID0gc2VsZi52YWxp
      ZGF0ZV9yZ3dfbWV0YWRhdGFfZWNfcG9vbF9uYW1lKCkKICAgICAgICBzZWxmLm91dF9tYXBbIlJH
      V19QT09MX1BSRUZJWCJdID0gc2VsZi5fYXJnX3BhcnNlci5yZ3dfcG9vbF9wcmVmaXgKICAgICAg
      ICBpZiBzZWxmLl9hcmdfcGFyc2VyLnJnd19lbmRwb2ludDoKICAgICAgICAgICAgaWYgc2VsZi5f
      YXJnX3BhcnNlci5kcnlfcnVuOgogICAgICAgICAgICAgICAgc2VsZi5jcmVhdGVfcmd3X2FkbWlu
      X29wc191c2VyKCkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICgKICAgICAgICAg
      ICAgICAgICAgICBzZWxmLm91dF9tYXBbIlJHV19BRE1JTl9PUFNfVVNFUl9BQ0NFU1NfS0VZIl0s
      CiAgICAgICAgICAgICAgICAgICAgc2VsZi5vdXRfbWFwWyJSR1dfQURNSU5fT1BTX1VTRVJfU0VD
      UkVUX0tFWSJdLAogICAgICAgICAgICAgICAgICAgIGluZm9fY2FwX3N1cHBvcnRlZCwKICAgICAg
      ICAgICAgICAgICkgPSBzZWxmLmNyZWF0ZV9yZ3dfYWRtaW5fb3BzX3VzZXIoKQogICAgICAgICAg
      ICAgICAgaWYgaW5mb19jYXBfc3VwcG9ydGVkOgogICAgICAgICAgICAgICAgICAgIHNlbGYudmFs
      aWRhdGVfcmd3X2VuZHBvaW50KCkKICAgICAgICAgICAgaWYgc2VsZi5fYXJnX3BhcnNlci5yZ3df
      dGxzX2NlcnRfcGF0aDoKICAgICAgICAgICAgICAgIHNlbGYub3V0X21hcFsiUkdXX1RMU19DRVJU
      Il0gPSBzZWxmLnZhbGlkYXRlX3Jnd19lbmRwb2ludF90bHNfY2VydCgpCgogICAgZGVmIGdlbl9z
      aGVsbF9vdXQoc2VsZik6CiAgICAgICAgc2VsZi5fZ2VuX291dHB1dF9tYXAoKQogICAgICAgIHNo
      T3V0SU8gPSBTdHJpbmdJTygpCiAgICAgICAgZm9yIGssIHYgaW4gc2VsZi5vdXRfbWFwLml0ZW1z
      KCk6CiAgICAgICAgICAgIGlmIHYgYW5kIGsgbm90IGluIHNlbGYuX2V4Y2x1ZGVkX2tleXM6CiAg
      ICAgICAgICAgICAgICBzaE91dElPLndyaXRlKCJleHBvcnQge309e317fSIuZm9ybWF0KGssIHYs
      IExJTkVTRVApKQogICAgICAgIHNoT3V0ID0gc2hPdXRJTy5nZXR2YWx1ZSgpCiAgICAgICAgc2hP
      dXRJTy5jbG9zZSgpCiAgICAgICAgcmV0dXJuIHNoT3V0CgogICAgZGVmIGdlbl9qc29uX291dChz
      ZWxmKToKICAgICAgICBzZWxmLl9nZW5fb3V0cHV0X21hcCgpCiAgICAgICAgaWYgc2VsZi5fYXJn
      X3BhcnNlci5kcnlfcnVuOgogICAgICAgICAgICByZXR1cm4gIiIKICAgICAgICBqc29uX291dCA9
      IFsKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgIm5hbWUiOiAicm9vay1jZXBoLW1vbi1l
      bmRwb2ludHMiLAogICAgICAgICAgICAgICAgImtpbmQiOiAiQ29uZmlnTWFwIiwKICAgICAgICAg
      ICAgICAgICJkYXRhIjogewogICAgICAgICAgICAgICAgICAgICJkYXRhIjogc2VsZi5vdXRfbWFw
      WyJST09LX0VYVEVSTkFMX0NFUEhfTU9OX0RBVEEiXSwKICAgICAgICAgICAgICAgICAgICAibWF4
      TW9uSWQiOiAiMCIsCiAgICAgICAgICAgICAgICAgICAgIm1hcHBpbmciOiAie30iLAogICAgICAg
      ICAgICAgICAgfSwKICAgICAgICAgICAgfSwKICAgICAgICAgICAgewogICAgICAgICAgICAgICAg
      Im5hbWUiOiAicm9vay1jZXBoLW1vbiIsCiAgICAgICAgICAgICAgICAia2luZCI6ICJTZWNyZXQi
      LAogICAgICAgICAgICAgICAgImRhdGEiOiB7CiAgICAgICAgICAgICAgICAgICAgImFkbWluLXNl
      Y3JldCI6ICJhZG1pbi1zZWNyZXQiLAogICAgICAgICAgICAgICAgICAgICJmc2lkIjogc2VsZi5v
      dXRfbWFwWyJST09LX0VYVEVSTkFMX0ZTSUQiXSwKICAgICAgICAgICAgICAgICAgICAibW9uLXNl
      Y3JldCI6ICJtb24tc2VjcmV0IiwKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH0sCiAg
      ICAgICAgICAgIHsKICAgICAgICAgICAgICAgICJuYW1lIjogInJvb2stY2VwaC1vcGVyYXRvci1j
      cmVkcyIsCiAgICAgICAgICAgICAgICAia2luZCI6ICJTZWNyZXQiLAogICAgICAgICAgICAgICAg
      ImRhdGEiOiB7CiAgICAgICAgICAgICAgICAgICAgInVzZXJJRCI6IHNlbGYub3V0X21hcFsiUk9P
      S19FWFRFUk5BTF9VU0VSTkFNRSJdLAogICAgICAgICAgICAgICAgICAgICJ1c2VyS2V5Ijogc2Vs
      Zi5vdXRfbWFwWyJST09LX0VYVEVSTkFMX1VTRVJfU0VDUkVUIl0sCiAgICAgICAgICAgICAgICB9
      LAogICAgICAgICAgICB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAibmFtZSI6ICJt
      b25pdG9yaW5nLWVuZHBvaW50IiwKICAgICAgICAgICAgICAgICJraW5kIjogIkNlcGhDbHVzdGVy
      IiwKICAgICAgICAgICAgICAgICJkYXRhIjogewogICAgICAgICAgICAgICAgICAgICJNb25pdG9y
      aW5nRW5kcG9pbnQiOiBzZWxmLm91dF9tYXBbIk1PTklUT1JJTkdfRU5EUE9JTlQiXSwKICAgICAg
      ICAgICAgICAgICAgICAiTW9uaXRvcmluZ1BvcnQiOiBzZWxmLm91dF9tYXBbIk1PTklUT1JJTkdf
      RU5EUE9JTlRfUE9SVCJdLAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgfSwKICAgICAg
      ICBdCgogICAgICAgICMgaWYgJ0NTSV9SQkRfTk9ERV9TRUNSRVQnIGV4aXN0cywgdGhlbiBvbmx5
      IGFkZCAncm9vay1jc2ktcmJkLXByb3Zpc2lvbmVyJyBTZWNyZXQKICAgICAgICBpZiBzZWxmLm91
      dF9tYXBbJ0NTSV9SQkRfTk9ERV9TRUNSRVQnXSBhbmQgc2VsZi5vdXRfbWFwWyJDU0lfUkJEX05P
      REVfU0VDUkVUX05BTUUiXToKICAgICAgICAgICAganNvbl9vdXQuYXBwZW5kKHsKICAgICAgICAg
      ICAgICAgICJuYW1lIjogInJvb2ste30iLmZvcm1hdChzZWxmLm91dF9tYXBbIkNTSV9SQkRfTk9E
      RV9TRUNSRVRfTkFNRSJdKSwKICAgICAgICAgICAgICAgICJraW5kIjogIlNlY3JldCIsCiAgICAg
      ICAgICAgICAgICAiZGF0YSI6IHsKICAgICAgICAgICAgICAgICAgICAidXNlcklEIjogc2VsZi5v
      dXRfbWFwWyJDU0lfUkJEX05PREVfU0VDUkVUX05BTUUiXSwKICAgICAgICAgICAgICAgICAgICAi
      dXNlcktleSI6IHNlbGYub3V0X21hcFsnQ1NJX1JCRF9OT0RFX1NFQ1JFVCddCiAgICAgICAgICAg
      ICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgIyBpZiAnQ1NJX1JCRF9QUk9WSVNJT05FUl9T
      RUNSRVQnIGV4aXN0cywgdGhlbiBvbmx5IGFkZCAncm9vay1jc2ktcmJkLXByb3Zpc2lvbmVyJyBT
      ZWNyZXQKICAgICAgICBpZiBzZWxmLm91dF9tYXBbJ0NTSV9SQkRfUFJPVklTSU9ORVJfU0VDUkVU
      J10gYW5kIHNlbGYub3V0X21hcFsiQ1NJX1JCRF9QUk9WSVNJT05FUl9TRUNSRVRfTkFNRSJdOgog
      ICAgICAgICAgICBqc29uX291dC5hcHBlbmQoewogICAgICAgICAgICAgICAgIm5hbWUiOiAicm9v
      ay17fSIuZm9ybWF0KHNlbGYub3V0X21hcFsiQ1NJX1JCRF9QUk9WSVNJT05FUl9TRUNSRVRfTkFN
      RSJdKSwKICAgICAgICAgICAgICAgICJraW5kIjogIlNlY3JldCIsCiAgICAgICAgICAgICAgICAi
      ZGF0YSI6IHsKICAgICAgICAgICAgICAgICAgICAidXNlcklEIjogc2VsZi5vdXRfbWFwWyJDU0lf
      UkJEX1BST1ZJU0lPTkVSX1NFQ1JFVF9OQU1FIl0sCiAgICAgICAgICAgICAgICAgICAgInVzZXJL
      ZXkiOiBzZWxmLm91dF9tYXBbJ0NTSV9SQkRfUFJPVklTSU9ORVJfU0VDUkVUJ10KICAgICAgICAg
      ICAgICAgIH0sCiAgICAgICAgICAgIH0pCiAgICAgICAgIyBpZiAnQ1NJX0NFUEhGU19QUk9WSVNJ
      T05FUl9TRUNSRVQnIGV4aXN0cywgdGhlbiBvbmx5IGFkZCAncm9vay1jc2ktY2VwaGZzLXByb3Zp
      c2lvbmVyJyBTZWNyZXQKICAgICAgICBpZiBzZWxmLm91dF9tYXBbJ0NTSV9DRVBIRlNfUFJPVklT
      SU9ORVJfU0VDUkVUJ10gYW5kIHNlbGYub3V0X21hcFsnQ1NJX0NFUEhGU19QUk9WSVNJT05FUl9T
      RUNSRVRfTkFNRSddOgogICAgICAgICAgICBqc29uX291dC5hcHBlbmQoewogICAgICAgICAgICAg
      ICAgIm5hbWUiOiAicm9vay17fSIuZm9ybWF0KHNlbGYub3V0X21hcFsiQ1NJX0NFUEhGU19QUk9W
      SVNJT05FUl9TRUNSRVRfTkFNRSJdKSwKICAgICAgICAgICAgICAgICJraW5kIjogIlNlY3JldCIs
      CiAgICAgICAgICAgICAgICAiZGF0YSI6IHsKICAgICAgICAgICAgICAgICAgICAiYWRtaW5JRCI6
      IHNlbGYub3V0X21hcFsiQ1NJX0NFUEhGU19QUk9WSVNJT05FUl9TRUNSRVRfTkFNRSJdLAogICAg
      ICAgICAgICAgICAgICAgICJhZG1pbktleSI6IHNlbGYub3V0X21hcFsnQ1NJX0NFUEhGU19QUk9W
      SVNJT05FUl9TRUNSRVQnXQogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgfSkKICAgICAg
      ICAjIGlmICdDU0lfQ0VQSEZTX05PREVfU0VDUkVUJyBleGlzdHMsIHRoZW4gb25seSBhZGQgJ3Jv
      b2stY3NpLWNlcGhmcy1ub2RlJyBTZWNyZXQKICAgICAgICBpZiBzZWxmLm91dF9tYXBbJ0NTSV9D
      RVBIRlNfTk9ERV9TRUNSRVQnXSBhbmQgc2VsZi5vdXRfbWFwWydDU0lfQ0VQSEZTX05PREVfU0VD
      UkVUX05BTUUnXToKICAgICAgICAgICAganNvbl9vdXQuYXBwZW5kKHsKICAgICAgICAgICAgICAg
      ICJuYW1lIjogInJvb2ste30iLmZvcm1hdChzZWxmLm91dF9tYXBbIkNTSV9DRVBIRlNfTk9ERV9T
      RUNSRVRfTkFNRSJdKSwKICAgICAgICAgICAgICAgICJraW5kIjogIlNlY3JldCIsCiAgICAgICAg
      ICAgICAgICAiZGF0YSI6IHsKICAgICAgICAgICAgICAgICAgICAiYWRtaW5JRCI6IHNlbGYub3V0
      X21hcFsiQ1NJX0NFUEhGU19OT0RFX1NFQ1JFVF9OQU1FIl0sCiAgICAgICAgICAgICAgICAgICAg
      ImFkbWluS2V5Ijogc2VsZi5vdXRfbWFwWydDU0lfQ0VQSEZTX05PREVfU0VDUkVUJ10KICAgICAg
      ICAgICAgICAgIH0KICAgICAgICAgICAgfSkKICAgICAgICAjIGlmICdST09LX0VYVEVSTkFMX0RB
      U0hCT0FSRF9MSU5LJyBleGlzdHMsIHRoZW4gb25seSBhZGQgJ3Jvb2stY2VwaC1kYXNoYm9hcmQt
      bGluaycgU2VjcmV0CiAgICAgICAgaWYgc2VsZi5vdXRfbWFwWyJST09LX0VYVEVSTkFMX0RBU0hC
      T0FSRF9MSU5LIl06CiAgICAgICAgICAgIGpzb25fb3V0LmFwcGVuZCgKICAgICAgICAgICAgICAg
      IHsKICAgICAgICAgICAgICAgICAgICAibmFtZSI6ICJyb29rLWNlcGgtZGFzaGJvYXJkLWxpbmsi
      LAogICAgICAgICAgICAgICAgICAgICJraW5kIjogIlNlY3JldCIsCiAgICAgICAgICAgICAgICAg
      ICAgImRhdGEiOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICJ1c2VySUQiOiAiY2VwaC1kYXNo
      Ym9hcmQtbGluayIsCiAgICAgICAgICAgICAgICAgICAgICAgICJ1c2VyS2V5Ijogc2VsZi5vdXRf
      bWFwWyJST09LX0VYVEVSTkFMX0RBU0hCT0FSRF9MSU5LIl0sCiAgICAgICAgICAgICAgICAgICAg
      fSwKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgKQogICAgICAgIGlmIHNlbGYub3V0X21h
      cFsnUkJEX01FVEFEQVRBX0VDX1BPT0xfTkFNRSddOgogICAgICAgICAgICBqc29uX291dC5hcHBl
      bmQoewogICAgICAgICAgICAgICAgIm5hbWUiOiAiY2VwaC1yYmQiLAogICAgICAgICAgICAgICAg
      ImtpbmQiOiAiU3RvcmFnZUNsYXNzIiwKICAgICAgICAgICAgICAgICJkYXRhIjogewogICAgICAg
      ICAgICAgICAgICAgICJkYXRhUG9vbCI6IHNlbGYub3V0X21hcFsnUkJEX01FVEFEQVRBX0VDX1BP
      T0xfTkFNRSddLAogICAgICAgICAgICAgICAgICAgICJwb29sIjogc2VsZi5vdXRfbWFwWydSQkRf
      UE9PTF9OQU1FJ10sCiAgICAgICAgICAgICAgICAgICAgImNzaS5zdG9yYWdlLms4cy5pby9wcm92
      aXNpb25lci1zZWNyZXQtbmFtZSI6ICJyb29rLXt9Ii5mb3JtYXQoc2VsZi5vdXRfbWFwWyJDU0lf
      UkJEX1BST1ZJU0lPTkVSX1NFQ1JFVF9OQU1FIl0pLAogICAgICAgICAgICAgICAgICAgICJjc2ku
      c3RvcmFnZS5rOHMuaW8vY29udHJvbGxlci1leHBhbmQtc2VjcmV0LW5hbWUiOiAicm9vay17fSIu
      Zm9ybWF0KHNlbGYub3V0X21hcFsiQ1NJX1JCRF9QUk9WSVNJT05FUl9TRUNSRVRfTkFNRSJdKSwK
      ICAgICAgICAgICAgICAgICAgICAiY3NpLnN0b3JhZ2UuazhzLmlvL25vZGUtc3RhZ2Utc2VjcmV0
      LW5hbWUiOiAicm9vay17fSIuZm9ybWF0KHNlbGYub3V0X21hcFsiQ1NJX1JCRF9OT0RFX1NFQ1JF
      VF9OQU1FIl0pCiAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICB9KQogICAgICAgIGVsc2U6
      CiAgICAgICAgICAgIGpzb25fb3V0LmFwcGVuZCh7CiAgICAgICAgICAgICAgICAibmFtZSI6ICJj
      ZXBoLXJiZCIsCiAgICAgICAgICAgICAgICAia2luZCI6ICJTdG9yYWdlQ2xhc3MiLAogICAgICAg
      ICAgICAgICAgImRhdGEiOiB7CiAgICAgICAgICAgICAgICAgICAgInBvb2wiOiBzZWxmLm91dF9t
      YXBbJ1JCRF9QT09MX05BTUUnXSwKICAgICAgICAgICAgICAgICAgICAiY3NpLnN0b3JhZ2Uuazhz
      LmlvL3Byb3Zpc2lvbmVyLXNlY3JldC1uYW1lIjogInJvb2ste30iLmZvcm1hdChzZWxmLm91dF9t
      YXBbIkNTSV9SQkRfUFJPVklTSU9ORVJfU0VDUkVUX05BTUUiXSksCiAgICAgICAgICAgICAgICAg
      ICAgImNzaS5zdG9yYWdlLms4cy5pby9jb250cm9sbGVyLWV4cGFuZC1zZWNyZXQtbmFtZSI6ICJy
      b29rLXt9Ii5mb3JtYXQoc2VsZi5vdXRfbWFwWyJDU0lfUkJEX1BST1ZJU0lPTkVSX1NFQ1JFVF9O
      QU1FIl0pLAogICAgICAgICAgICAgICAgICAgICJjc2kuc3RvcmFnZS5rOHMuaW8vbm9kZS1zdGFn
      ZS1zZWNyZXQtbmFtZSI6ICJyb29rLXt9Ii5mb3JtYXQoc2VsZi5vdXRfbWFwWyJDU0lfUkJEX05P
      REVfU0VDUkVUX05BTUUiXSkKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgIH0pCiAgICAg
      ICAgIyBpZiAnQ0VQSEZTX0ZTX05BTUUnIGV4aXN0cywgdGhlbiBvbmx5IGFkZCAnY2VwaGZzJyBT
      dG9yYWdlQ2xhc3MKICAgICAgICBpZiBzZWxmLm91dF9tYXBbJ0NFUEhGU19GU19OQU1FJ106CiAg
      ICAgICAgICAgIGpzb25fb3V0LmFwcGVuZCh7CiAgICAgICAgICAgICAgICAibmFtZSI6ICJjZXBo
      ZnMiLAogICAgICAgICAgICAgICAgImtpbmQiOiAiU3RvcmFnZUNsYXNzIiwKICAgICAgICAgICAg
      ICAgICJkYXRhIjogewogICAgICAgICAgICAgICAgICAgICJmc05hbWUiOiBzZWxmLm91dF9tYXBb
      J0NFUEhGU19GU19OQU1FJ10sCiAgICAgICAgICAgICAgICAgICAgInBvb2wiOiBzZWxmLm91dF9t
      YXBbJ0NFUEhGU19QT09MX05BTUUnXSwKICAgICAgICAgICAgICAgICAgICAiY3NpLnN0b3JhZ2Uu
      azhzLmlvL3Byb3Zpc2lvbmVyLXNlY3JldC1uYW1lIjogInJvb2ste30iLmZvcm1hdChzZWxmLm91
      dF9tYXBbIkNTSV9DRVBIRlNfUFJPVklTSU9ORVJfU0VDUkVUX05BTUUiXSksCiAgICAgICAgICAg
      ICAgICAgICAgImNzaS5zdG9yYWdlLms4cy5pby9jb250cm9sbGVyLWV4cGFuZC1zZWNyZXQtbmFt
      ZSI6ICJyb29rLXt9Ii5mb3JtYXQoc2VsZi5vdXRfbWFwWyJDU0lfQ0VQSEZTX1BST1ZJU0lPTkVS
      X1NFQ1JFVF9OQU1FIl0pLAogICAgICAgICAgICAgICAgICAgICJjc2kuc3RvcmFnZS5rOHMuaW8v
      bm9kZS1zdGFnZS1zZWNyZXQtbmFtZSI6ICJyb29rLXt9Ii5mb3JtYXQoc2VsZi5vdXRfbWFwWyJD
      U0lfQ0VQSEZTX05PREVfU0VDUkVUX05BTUUiXSkKICAgICAgICAgICAgICAgIH0KICAgICAgICAg
      ICAgfSkKICAgICAgICAjIGlmICdSR1dfRU5EUE9JTlQnIGV4aXN0cywgdGhlbiBvbmx5IGFkZCAn
      Y2VwaC1yZ3cnIFN0b3JhZ2VDbGFzcwogICAgICAgIGlmIHNlbGYub3V0X21hcFsiUkdXX0VORFBP
      SU5UIl06CiAgICAgICAgICAgIGpzb25fb3V0LmFwcGVuZCgKICAgICAgICAgICAgICAgIHsKICAg
      ICAgICAgICAgICAgICAgICAibmFtZSI6ICJjZXBoLXJndyIsCiAgICAgICAgICAgICAgICAgICAg
      ImtpbmQiOiAiU3RvcmFnZUNsYXNzIiwKICAgICAgICAgICAgICAgICAgICAiZGF0YSI6IHsKICAg
      ICAgICAgICAgICAgICAgICAgICAgImVuZHBvaW50Ijogc2VsZi5vdXRfbWFwWyJSR1dfRU5EUE9J
      TlQiXSwKICAgICAgICAgICAgICAgICAgICAgICAgInBvb2xQcmVmaXgiOiBzZWxmLm91dF9tYXBb
      IlJHV19QT09MX1BSRUZJWCJdLAogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAg
      ICB9CiAgICAgICAgICAgICkKICAgICAgICAgICAganNvbl9vdXQuYXBwZW5kKAogICAgICAgICAg
      ICAgICAgewogICAgICAgICAgICAgICAgICAgICJuYW1lIjogInJndy1hZG1pbi1vcHMtdXNlciIs
      CiAgICAgICAgICAgICAgICAgICAgImtpbmQiOiAiU2VjcmV0IiwKICAgICAgICAgICAgICAgICAg
      ICAiZGF0YSI6IHsKICAgICAgICAgICAgICAgICAgICAgICAgImFjY2Vzc0tleSI6IHNlbGYub3V0
      X21hcFsiUkdXX0FETUlOX09QU19VU0VSX0FDQ0VTU19LRVkiXSwKICAgICAgICAgICAgICAgICAg
      ICAgICAgInNlY3JldEtleSI6IHNlbGYub3V0X21hcFsiUkdXX0FETUlOX09QU19VU0VSX1NFQ1JF
      VF9LRVkiXSwKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgfQogICAgICAg
      ICAgICApCiAgICAgICAgIyBpZiAnUkdXX1RMU19DRVJUJyBleGlzdHMsIHRoZW4gb25seSBhZGQg
      dGhlICJjZXBoLXJndy10bHMtY2VydCIgc2VjcmV0CiAgICAgICAgaWYgc2VsZi5vdXRfbWFwWyJS
      R1dfVExTX0NFUlQiXToKICAgICAgICAgICAganNvbl9vdXQuYXBwZW5kKAogICAgICAgICAgICAg
      ICAgewogICAgICAgICAgICAgICAgICAgICJuYW1lIjogImNlcGgtcmd3LXRscy1jZXJ0IiwKICAg
      ICAgICAgICAgICAgICAgICAia2luZCI6ICJTZWNyZXQiLAogICAgICAgICAgICAgICAgICAgICJk
      YXRhIjogewogICAgICAgICAgICAgICAgICAgICAgICAiY2VydCI6IHNlbGYub3V0X21hcFsiUkdX
      X1RMU19DRVJUIl0sCiAgICAgICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgICAgIH0KICAg
      ICAgICAgICAgKQoKICAgICAgICByZXR1cm4ganNvbi5kdW1wcyhqc29uX291dCkgKyBMSU5FU0VQ
      CgogICAgZGVmIHVwZ3JhZGVfdXNlcnNfcGVybWlzc2lvbnMoc2VsZik6CiAgICAgICAgdXNlcnMg
      PSBbCiAgICAgICAgICAgICJjbGllbnQuY3NpLWNlcGhmcy1ub2RlIiwKICAgICAgICAgICAgImNs
      aWVudC5jc2ktY2VwaGZzLXByb3Zpc2lvbmVyIiwKICAgICAgICAgICAgImNsaWVudC5jc2ktcmJk
      LW5vZGUiLAogICAgICAgICAgICAiY2xpZW50LmNzaS1yYmQtcHJvdmlzaW9uZXIiLAogICAgICAg
      IF0KICAgICAgICBpZiBzZWxmLnJ1bl9hc191c2VyICE9ICIiIGFuZCBzZWxmLnJ1bl9hc191c2Vy
      IG5vdCBpbiB1c2VyczoKICAgICAgICAgICAgdXNlcnMuYXBwZW5kKHNlbGYucnVuX2FzX3VzZXIp
      CiAgICAgICAgZm9yIHVzZXIgaW4gdXNlcnM6CiAgICAgICAgICAgIHNlbGYudXBncmFkZV91c2Vy
      X3Blcm1pc3Npb25zKHVzZXIpCgogICAgZGVmIHVwZ3JhZGVfdXNlcl9wZXJtaXNzaW9ucyhzZWxm
      LCB1c2VyKToKICAgICAgICAjIGNoZWNrIHdoZXRoZXIgdGhlIGdpdmVuIHVzZXIgZXhpc3RzIG9y
      IG5vdAogICAgICAgIGNtZF9qc29uID0geyJwcmVmaXgiOiAiYXV0aCBnZXQiLCAiZW50aXR5Ijog
      Int9Ii5mb3JtYXQodXNlciksICJmb3JtYXQiOiAianNvbiJ9CiAgICAgICAgcmV0X3ZhbCwganNv
      bl9vdXQsIGVycl9tc2cgPSBzZWxmLl9jb21tb25fY21kX2pzb25fZ2VuKGNtZF9qc29uKQogICAg
      ICAgIGlmIHJldF92YWwgIT0gMCBvciBsZW4oanNvbl9vdXQpID09IDA6CiAgICAgICAgICAgIHBy
      aW50KCJ1c2VyIHt9IG5vdCBmb3VuZCBmb3IgdXBncmFkaW5nLiIuZm9ybWF0KHVzZXIpKQogICAg
      ICAgICAgICByZXR1cm4KICAgICAgICBleGlzdGluZ19jYXBzID0ganNvbl9vdXRbMF1bImNhcHMi
      XQogICAgICAgIG5ld19jYXAsIF8gPSBzZWxmLmdldF9jYXBzX2FuZF9lbnRpdHkodXNlcikKICAg
      ICAgICBjYXBfa2V5cyA9IFsibW9uIiwgIm1nciIsICJvc2QiLCAibWRzIl0KICAgICAgICBjYXBz
      ID0gW10KICAgICAgICBmb3IgZWFjaENhcCBpbiBjYXBfa2V5czoKICAgICAgICAgICAgY3VyX2Nh
      cF92YWx1ZXMgPSBleGlzdGluZ19jYXBzLmdldChlYWNoQ2FwLCAiIikKICAgICAgICAgICAgbmV3
      X2NhcF92YWx1ZXMgPSBuZXdfY2FwLmdldChlYWNoQ2FwLCAiIikKICAgICAgICAgICAgY3VyX2Nh
      cF9wZXJtX2xpc3QgPSBbCiAgICAgICAgICAgICAgICB4LnN0cmlwKCkgZm9yIHggaW4gY3VyX2Nh
      cF92YWx1ZXMuc3BsaXQoIiwiKSBpZiB4LnN0cmlwKCkKICAgICAgICAgICAgXQogICAgICAgICAg
      ICBuZXdfY2FwX3Blcm1fbGlzdCA9IFsKICAgICAgICAgICAgICAgIHguc3RyaXAoKSBmb3IgeCBp
      biBuZXdfY2FwX3ZhbHVlcy5zcGxpdCgiLCIpIGlmIHguc3RyaXAoKQogICAgICAgICAgICBdCiAg
      ICAgICAgICAgICMgYXBwZW5kIG5ld19jYXBfbGlzdCB0byBjdXJfY2FwX2xpc3QgdG8gbWFpbnRh
      aW4gdGhlIG9yZGVyIG9mIGNhcHMKICAgICAgICAgICAgY3VyX2NhcF9wZXJtX2xpc3QuZXh0ZW5k
      KG5ld19jYXBfcGVybV9saXN0KQogICAgICAgICAgICAjIGVsaW1pbmF0ZSBkdXBsaWNhdGVzIHdp
      dGhvdXQgdXNpbmcgJ3NldCcKICAgICAgICAgICAgIyBzZXQgcmUtb3JkZXJzIGl0ZW1zIGluIHRo
      ZSBsaXN0IGFuZCB3ZSBoYXZlIHRvIGtlZXAgdGhlIG9yZGVyCiAgICAgICAgICAgIG5ld19jYXBf
      bGlzdCA9IFtdCiAgICAgICAgICAgIFtuZXdfY2FwX2xpc3QuYXBwZW5kKHgpIGZvciB4IGluIGN1
      cl9jYXBfcGVybV9saXN0IGlmIHggbm90IGluIG5ld19jYXBfbGlzdF0KICAgICAgICAgICAgZXhp
      c3RpbmdfY2Fwc1tlYWNoQ2FwXSA9ICIsICIuam9pbihuZXdfY2FwX2xpc3QpCiAgICAgICAgICAg
      IGlmIGV4aXN0aW5nX2NhcHNbZWFjaENhcF06CiAgICAgICAgICAgICAgICBjYXBzLmFwcGVuZChl
      YWNoQ2FwKQogICAgICAgICAgICAgICAgY2Fwcy5hcHBlbmQoZXhpc3RpbmdfY2Fwc1tlYWNoQ2Fw
      XSkKICAgICAgICBjbWRfanNvbiA9IHsKICAgICAgICAgICAgInByZWZpeCI6ICJhdXRoIGNhcHMi
      LAogICAgICAgICAgICAiZW50aXR5IjogdXNlciwKICAgICAgICAgICAgImNhcHMiOiBjYXBzLAog
      ICAgICAgICAgICAiZm9ybWF0IjogImpzb24iLAogICAgICAgIH0KICAgICAgICByZXRfdmFsLCBq
      c29uX291dCwgZXJyX21zZyA9IHNlbGYuX2NvbW1vbl9jbWRfanNvbl9nZW4oY21kX2pzb24pCiAg
      ICAgICAgaWYgcmV0X3ZhbCAhPSAwOgogICAgICAgICAgICByYWlzZSBFeGVjdXRpb25GYWlsdXJl
      RXhjZXB0aW9uKAogICAgICAgICAgICAgICAgIidhdXRoIGNhcHMge30nIGNvbW1hbmQgZmFpbGVk
      LlxuIi5mb3JtYXQodXNlcikKICAgICAgICAgICAgICAgICsgIkVycm9yOiB7fSIuZm9ybWF0KGVy
      cl9tc2cpCiAgICAgICAgICAgICkKICAgICAgICBwcmludCgiVXBkYXRlZCB1c2VyLCB7fSwgc3Vj
      Y2Vzc2Z1bGx5LiIuZm9ybWF0KHVzZXIpKQoKICAgIGRlZiBtYWluKHNlbGYpOgogICAgICAgIGdl
      bmVyYXRlZF9vdXRwdXQgPSAiIgogICAgICAgIGlmIHNlbGYuX2FyZ19wYXJzZXIudXBncmFkZToK
      ICAgICAgICAgICAgc2VsZi51cGdyYWRlX3VzZXJzX3Blcm1pc3Npb25zKCkKICAgICAgICBlbGlm
      IHNlbGYuX2FyZ19wYXJzZXIuZm9ybWF0ID09ICJqc29uIjoKICAgICAgICAgICAgZ2VuZXJhdGVk
      X291dHB1dCA9IHNlbGYuZ2VuX2pzb25fb3V0KCkKICAgICAgICBlbGlmIHNlbGYuX2FyZ19wYXJz
      ZXIuZm9ybWF0ID09ICJiYXNoIjoKICAgICAgICAgICAgZ2VuZXJhdGVkX291dHB1dCA9IHNlbGYu
      Z2VuX3NoZWxsX291dCgpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcmFpc2UgRXhlY3V0aW9u
      RmFpbHVyZUV4Y2VwdGlvbigKICAgICAgICAgICAgICAgICJVbnN1cHBvcnRlZCBmb3JtYXQ6IHt9
      Ii5mb3JtYXQoc2VsZi5fYXJnX3BhcnNlci5mb3JtYXQpCiAgICAgICAgICAgICkKICAgICAgICBw
      cmludCgie30iLmZvcm1hdChnZW5lcmF0ZWRfb3V0cHV0KSkKICAgICAgICBpZiBzZWxmLm91dHB1
      dF9maWxlIGFuZCBnZW5lcmF0ZWRfb3V0cHV0OgogICAgICAgICAgICBmT3V0ID0gb3BlbihzZWxm
      Lm91dHB1dF9maWxlLCAidyIpCiAgICAgICAgICAgIGZPdXQud3JpdGUoZ2VuZXJhdGVkX291dHB1
      dCkKICAgICAgICAgICAgZk91dC5jbG9zZSgpCgoKIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMj
      IyMjIyMjIyMjIyMjIyMjIyMjIyMjCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyBNQUlOICMjIyMjIyMj
      IyMjIyMjIyMjIyMjIwojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMj
      IyMjIyMKaWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKICAgIHJqT2JqID0gUmFkb3NKU09OKCkK
      ICAgIHRyeToKICAgICAgICByak9iai5tYWluKCkKICAgIGV4Y2VwdCBFeGVjdXRpb25GYWlsdXJl
      RXhjZXB0aW9uIGFzIGVycjoKICAgICAgICBwcmludCgiRXhlY3V0aW9uIEZhaWxlZDoge30iLmZv
      cm1hdChlcnIpKQogICAgICAgIHJhaXNlIGVycgogICAgZXhjZXB0IEtleUVycm9yIGFzIGtFcnI6
      CiAgICAgICAgcHJpbnQoIktleUVycm9yOiAlcyIsIGtFcnIpCiAgICBleGNlcHQgT1NFcnJvciBh
      cyBvc0VycjoKICAgICAgICBwcmludCgiRXJyb3Igd2hpbGUgdHJ5aW5nIHRvIG91dHB1dCB0aGUg
      ZGF0YToge30iLmZvcm1hdChvc0VycikpCiAgICBmaW5hbGx5OgogICAgICAgIHJqT2JqLnNodXRk
      b3duKCkK
  name: rook-ceph.v{{.RookOperatorCsvVersion}}
  namespace: placeholder
spec:
  apiservicedefinitions: {}
  customresourcedefinitions:
    owned:
    - kind: CephCluster
      name: cephclusters.ceph.rook.io
      version: v1
      displayName: Ceph Cluster
      description: Represents a Ceph cluster.
    - kind: CephBlockPool
      name: cephblockpools.ceph.rook.io
      version: v1
      displayName: Ceph Block Pool
      description: Represents a Ceph Block Pool.
    - kind: CephObjectStore
      name: cephobjectstores.ceph.rook.io
      version: v1
      displayName: Ceph Object Store
      description: Represents a Ceph Object Store.
      specDescriptors:
      - description: Coding Chunks
        displayName: Coding Chunks
        path: dataPool.erasureCoded.codingChunks
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:fieldGroup:dataPool
        - urn:alm:descriptor:com.tectonic.ui:number
      - description: Data Chunks
        displayName: Data Chunks
        path: dataPool.erasureCoded.dataChunks
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:fieldGroup:dataPool
        - urn:alm:descriptor:com.tectonic.ui:number
      - description: failureDomain
        displayName: failureDomain
        path: dataPool.failureDomain
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:fieldGroup:dataPool
        - urn:alm:descriptor:com.tectonic.ui:text
      - description: Size
        displayName: Size
        path: dataPool.replicated.size
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:fieldGroup:dataPool
        - urn:alm:descriptor:com.tectonic.ui:number
      - description: Annotations
        displayName: Annotations
        path: gateway.annotations
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:fieldGroup:gateway
        - urn:alm:descriptor:io.kubernetes:annotations
      - description: Instances
        displayName: Instances
        path: gateway.instances
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:fieldGroup:gateway
        - urn:alm:descriptor:com.tectonic.ui:number
      - description: Resources
        displayName: Resources
        path: gateway.resources
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:fieldGroup:gateway
        - urn:alm:descriptor:com.tectonic.ui:resourceRequirements
      - description: placement
        displayName: placement
        path: gateway.placement
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:fieldGroup:gateway
        - urn:alm:descriptor:io.kubernetes:placement
      - description: securePort
        displayName: securePort
        path: gateway.securePort
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:fieldGroup:gateway
        - urn:alm:descriptor:io.kubernetes:securePort
      - description: sslCertificateRef
        displayName: sslCertificateRef
        path: gateway.sslCertificateRef
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:fieldGroup:gateway
        - urn:alm:descriptor:io.kubernetes:sslCertificateRef
      - description: Type
        displayName: Type
        path: gateway.type
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:fieldGroup:gateway
        - urn:alm:descriptor:com.tectonic.ui:text
      - description: Coding Chunks
        displayName: Coding Chunks
        path: metadataPool.erasureCoded.codingChunks
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:fieldGroup:metadataPool
        - urn:alm:descriptor:com.tectonic.ui:number
      - description: Data Chunks
        displayName: Data Chunks
        path: metadataPool.erasureCoded.dataChunks
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:fieldGroup:metadataPool
        - urn:alm:descriptor:com.tectonic.ui:number
      - description: failureDomain
        displayName: failureDomain
        path: metadataPool.failureDomain
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:fieldGroup:metadataPool
        - urn:alm:descriptor:com.tectonic.ui:text
      - description: Size
        displayName: Size
        path: metadataPool.replicated.size
        x-descriptors:
        - urn:alm:descriptor:com.tectonic.ui:fieldGroup:metadataPool
        - urn:alm:descriptor:com.tectonic.ui:number
    - kind: CephObjectStoreUser
      name: cephobjectstoreusers.ceph.rook.io
      version: v1
      displayName: Ceph Object Store User
      description: Represents a Ceph Object Store User.
    - kind: CephNFS
      name: cephnfses.ceph.rook.io
      version: v1
      displayName: Ceph NFS
      description: Represents a cluster of Ceph NFS ganesha gateways.
    - kind: CephClient
      name: cephclients.ceph.rook.io
      version: v1
      displayName: Ceph Client
      description: Represents a Ceph User.
    - kind: CephFilesystem
      name: cephfilesystems.ceph.rook.io
      version: v1
      displayName: Ceph Filesystem
      description: Represents a Ceph Filesystem.
    - kind: CephFilesystemMirror
      name: cephfilesystemmirrors.ceph.rook.io
      version: v1
      displayName: Ceph Filesystem Mirror
      description: Represents a Ceph Filesystem Mirror.
    - kind: CephRBDMirror
      name: cephrbdmirrors.ceph.rook.io
      version: v1
      displayName: Ceph RBD Mirror
      description: Represents a Ceph RBD Mirror.
    - kind: CephObjectRealm
      name: cephobjectrealms.ceph.rook.io
      version: v1
      displayName: Ceph Object Store Realm
      description: Represents a Ceph Object Store Realm.
    - kind: CephObjectZoneGroup
      name: cephobjectzonegroups.ceph.rook.io
      version: v1
      displayName: Ceph Object Store Zone Group
      description: Represents a Ceph Object Store Zone Group.
    - kind: CephObjectZone
      name: cephobjectzones.ceph.rook.io
      version: v1
      displayName: Ceph Object Store Zone
      description: Represents a Ceph Object Store Zone.
    - kind: CephBucketNotification
      name: cephbucketnotifications.ceph.rook.io
      version: v1
      displayName: Ceph Bucket Notification
      description: Represents a Ceph Bucket Notification.
    - kind: CephBucketTopic
      name: cephbuckettopics.ceph.rook.io
      version: v1
      displayName: Ceph Bucket Topic
      description: Represents a Ceph Bucket Topic.
    - kind: CephFilesystemSubVolumeGroup
      name: cephfilesystemsubvolumegroups.ceph.rook.io
      version: v1
      displayName: Ceph Filesystem SubVolumeGroup
      description: Represents a Ceph Filesystem SubVolumeGroup.
    - kind: CephBlockPoolRadosNamespace
      name: cephblockpoolradosnamespaces.ceph.rook.io
      version: v1
      displayName: Ceph BlockPool Rados Namespace
      description: Represents a Ceph BlockPool Rados Namespace.
    - kind: VolumeReplicationClass
      name: volumereplicationclasses.replication.storage.openshift.io
      version: v1alpha1
    - kind: VolumeReplication
      name: volumereplications.replication.storage.openshift.io
      version: v1alpha1
  displayName: Rook-Ceph
  icon:
  - base64data: PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDIzLjAuMiwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPgo8c3ZnIHZlcnNpb249IjEuMSIgaWQ9IkxheWVyXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4IgoJIHZpZXdCb3g9IjAgMCA3MCA3MCIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgNzAgNzA7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4KPHN0eWxlIHR5cGU9InRleHQvY3NzIj4KCS5zdDB7ZmlsbDojMkIyQjJCO30KPC9zdHlsZT4KPGc+Cgk8Zz4KCQk8Zz4KCQkJPHBhdGggY2xhc3M9InN0MCIgZD0iTTUwLjUsNjcuNkgxOS45Yy04LDAtMTQuNS02LjUtMTQuNS0xNC41VjI5LjJjMC0xLjEsMC45LTIuMSwyLjEtMi4xaDU1LjRjMS4xLDAsMi4xLDAuOSwyLjEsMi4xdjIzLjkKCQkJCUM2NSw2MS4xLDU4LjUsNjcuNiw1MC41LDY3LjZ6IE05LjYsMzEuMnYyMS45YzAsNS43LDQuNiwxMC4zLDEwLjMsMTAuM2gzMC42YzUuNywwLDEwLjMtNC42LDEwLjMtMTAuM1YzMS4ySDkuNnoiLz4KCQk8L2c+CgkJPGc+CgkJCTxwYXRoIGNsYXNzPSJzdDAiIGQ9Ik00Mi40LDU2LjdIMjhjLTEuMSwwLTIuMS0wLjktMi4xLTIuMXYtNy4yYzAtNS4xLDQuMi05LjMsOS4zLTkuM3M5LjMsNC4yLDkuMyw5LjN2Ny4yCgkJCQlDNDQuNSw1NS43LDQzLjYsNTYuNyw0Mi40LDU2Ljd6IE0zMCw1Mi41aDEwLjN2LTUuMmMwLTIuOS0yLjMtNS4yLTUuMi01LjJjLTIuOSwwLTUuMiwyLjMtNS4yLDUuMlY1Mi41eiIvPgoJCTwvZz4KCQk8Zz4KCQkJPHBhdGggY2xhc3M9InN0MCIgZD0iTTYyLjksMjMuMkM2Mi45LDIzLjIsNjIuOSwyMy4yLDYyLjksMjMuMmwtMTEuMSwwYy0xLjEsMC0yLjEtMC45LTIuMS0yLjFjMC0xLjEsMC45LTIuMSwyLjEtMi4xCgkJCQljMCwwLDAsMCwwLDBsOS4xLDBWNi43aC02Ljl2My41YzAsMC41LTAuMiwxLjEtMC42LDEuNWMtMC40LDAuNC0wLjksMC42LTEuNSwwLjZsMCwwbC0xMS4xLDBjLTEuMSwwLTIuMS0wLjktMi4xLTIuMVY2LjdoLTYuOQoJCQkJdjMuNWMwLDEuMS0wLjksMi4xLTIuMSwyLjFsLTExLjEsMGMtMC41LDAtMS4xLTAuMi0xLjUtMC42Yy0wLjQtMC40LTAuNi0wLjktMC42LTEuNVY2LjdIOS42djEyLjRoOWMxLjEsMCwyLjEsMC45LDIuMSwyLjEKCQkJCXMtMC45LDIuMS0yLjEsMi4xaC0xMWMtMS4xLDAtMi4xLTAuOS0yLjEtMi4xVjQuNmMwLTEuMSwwLjktMi4xLDIuMS0yLjFoMTEuMWMxLjEsMCwyLjEsMC45LDIuMSwyLjF2My41bDcsMFY0LjYKCQkJCWMwLTEuMSwwLjktMi4xLDIuMS0yLjFoMTEuMWMxLjEsMCwyLjEsMC45LDIuMSwyLjF2My41bDYuOSwwVjQuNmMwLTEuMSwwLjktMi4xLDIuMS0yLjFoMTEuMUM2NCwyLjYsNjUsMy41LDY1LDQuNnYxNi41CgkJCQljMCwwLjUtMC4yLDEuMS0wLjYsMS41QzY0LDIzLDYzLjQsMjMuMiw2Mi45LDIzLjJ6Ii8+CgkJPC9nPgoJPC9nPgo8L2c+Cjwvc3ZnPg==
    mediatype: image/svg+xml
  install:
    spec:
      clusterPermissions:
      - rules:
        - apiGroups:
          - ""
          resources:
          - nodes
          verbs:
          - get
          - list
          - watch
        - apiGroups:
          - ""
          resources:
          - namespaces
          verbs:
          - get
          - list
        - apiGroups:
          - ""
          resources:
          - persistentvolumes
          verbs:
          - get
          - list
          - watch
          - update
        - apiGroups:
          - storage.k8s.io
          resources:
          - volumeattachments
          verbs:
          - get
          - list
          - watch
          - update
        - apiGroups:
          - ""
          resources:
          - configmaps
          verbs:
          - get
          - list
        serviceAccountName: rook-csi-cephfs-plugin-sa
      - rules:
        - apiGroups:
          - ""
          resources:
          - secrets
          verbs:
          - get
          - list
        - apiGroups:
          - ""
          resources:
          - persistentvolumes
          verbs:
          - get
          - list
          - watch
          - create
          - delete
          - update
          - patch
        - apiGroups:
          - ""
          resources:
          - persistentvolumeclaims
          verbs:
          - get
          - list
          - watch
          - update
        - apiGroups:
          - storage.k8s.io
          resources:
          - storageclasses
          verbs:
          - get
          - list
          - watch
        - apiGroups:
          - ""
          resources:
          - events
          verbs:
          - list
          - watch
          - create
          - update
          - patch
        - apiGroups:
          - storage.k8s.io
          resources:
          - volumeattachments
          verbs:
          - get
          - list
          - watch
          - update
          - patch
        - apiGroups:
          - storage.k8s.io
          resources:
          - volumeattachments/status
          verbs:
          - patch
        - apiGroups:
          - ""
          resources:
          - nodes
          verbs:
          - get
          - list
          - watch
        - apiGroups:
          - ""
          resources:
          - persistentvolumeclaims/status
          verbs:
          - update
          - patch
        - apiGroups:
          - snapshot.storage.k8s.io
          resources:
          - volumesnapshots
          verbs:
          - get
          - list
          - watch
          - update
          - patch
        - apiGroups:
          - snapshot.storage.k8s.io
          resources:
          - volumesnapshotcontents
          verbs:
          - create
          - get
          - list
          - watch
          - update
          - delete
          - patch
        - apiGroups:
          - snapshot.storage.k8s.io
          resources:
          - volumesnapshotclasses
          verbs:
          - get
          - list
          - watch
        - apiGroups:
          - snapshot.storage.k8s.io
          resources:
          - volumesnapshotcontents/status
          verbs:
          - update
          - patch
        - apiGroups:
          - snapshot.storage.k8s.io
          resources:
          - volumesnapshots/status
          verbs:
          - update
          - patch
        serviceAccountName: rook-csi-cephfs-provisioner-sa
      - rules:
        - apiGroups:
          - ""
          resources:
          - secrets
          verbs:
          - get
          - list
        - apiGroups:
          - ""
          resources:
          - nodes
          verbs:
          - get
          - list
          - watch
        - apiGroups:
          - ""
          resources:
          - namespaces
          verbs:
          - get
          - list
        - apiGroups:
          - ""
          resources:
          - persistentvolumes
          verbs:
          - get
          - list
          - watch
          - update
        - apiGroups:
          - storage.k8s.io
          resources:
          - volumeattachments
          verbs:
          - get
          - list
          - watch
          - update
        - apiGroups:
          - ""
          resources:
          - configmaps
          verbs:
          - get
          - list
        - apiGroups:
          - ""
          resources:
          - serviceaccounts
          verbs:
          - get
        - apiGroups:
          - ""
          resources:
          - serviceaccounts/token
          verbs:
          - create
        serviceAccountName: rook-csi-rbd-plugin-sa
      - rules:
        - apiGroups:
          - ""
          resources:
          - secrets
          verbs:
          - get
          - list
          - watch
        - apiGroups:
          - ""
          resources:
          - persistentvolumes
          verbs:
          - get
          - list
          - watch
          - create
          - delete
          - update
          - patch
        - apiGroups:
          - ""
          resources:
          - persistentvolumeclaims
          verbs:
          - get
          - list
          - watch
          - update
        - apiGroups:
          - storage.k8s.io
          resources:
          - volumeattachments
          verbs:
          - get
          - list
          - watch
          - update
          - patch
        - apiGroups:
          - storage.k8s.io
          resources:
          - volumeattachments/status
          verbs:
          - patch
        - apiGroups:
          - ""
          resources:
          - nodes
          verbs:
          - get
          - list
          - watch
        - apiGroups:
          - storage.k8s.io
          resources:
          - storageclasses
          verbs:
          - get
          - list
          - watch
        - apiGroups:
          - ""
          resources:
          - events
          verbs:
          - list
          - watch
          - create
          - update
          - patch
        - apiGroups:
          - snapshot.storage.k8s.io
          resources:
          - volumesnapshots
          verbs:
          - get
          - list
          - watch
          - update
          - patch
        - apiGroups:
          - snapshot.storage.k8s.io
          resources:
          - volumesnapshotcontents
          verbs:
          - create
          - get
          - list
          - watch
          - update
          - delete
          - patch
        - apiGroups:
          - snapshot.storage.k8s.io
          resources:
          - volumesnapshotclasses
          verbs:
          - get
          - list
          - watch
        - apiGroups:
          - snapshot.storage.k8s.io
          resources:
          - volumesnapshotcontents/status
          verbs:
          - update
          - patch
        - apiGroups:
          - snapshot.storage.k8s.io
          resources:
          - volumesnapshots/status
          verbs:
          - update
          - patch
        - apiGroups:
          - ""
          resources:
          - persistentvolumeclaims/status
          verbs:
          - update
          - patch
        - apiGroups:
          - ""
          resources:
          - configmaps
          verbs:
          - get
        - apiGroups:
          - replication.storage.openshift.io
          resources:
          - volumereplications
          - volumereplicationclasses
          verbs:
          - create
          - delete
          - get
          - list
          - patch
          - update
          - watch
        - apiGroups:
          - replication.storage.openshift.io
          resources:
          - volumereplications/finalizers
          verbs:
          - update
        - apiGroups:
          - replication.storage.openshift.io
          resources:
          - volumereplications/status
          verbs:
          - get
          - patch
          - update
        - apiGroups:
          - replication.storage.openshift.io
          resources:
          - volumereplicationclasses/status
          verbs:
          - get
        - apiGroups:
          - ""
          resources:
          - serviceaccounts
          verbs:
          - get
        - apiGroups:
          - ""
          resources:
          - serviceaccounts/token
          verbs:
          - create
        serviceAccountName: rook-csi-rbd-provisioner-sa
      - rules:
        - apiGroups:
          - ""
          - apps
          - extensions
          resources:
          - secrets
          - pods
          - pods/log
          - services
          - configmaps
          - deployments
          - daemonsets
          verbs:
          - get
          - list
          - watch
          - patch
          - create
          - update
          - delete
        serviceAccountName: rook-ceph-system
      - rules:
        - apiGroups:
          - ""
          resources:
          - pods
          - nodes
          - nodes/proxy
          - services
          - secrets
          - configmaps
          verbs:
          - get
          - list
          - watch
        - apiGroups:
          - ""
          resources:
          - events
          - persistentvolumes
          - persistentvolumeclaims
          - endpoints
          verbs:
          - get
          - list
          - watch
          - patch
          - create
          - update
          - delete
        - apiGroups:
          - storage.k8s.io
          resources:
          - storageclasses
          verbs:
          - get
          - list
          - watch
        - apiGroups:
          - batch
          resources:
          - jobs
          - cronjobs
          verbs:
          - get
          - list
          - watch
          - create
          - update
          - delete
        - apiGroups:
          - ceph.rook.io
          resources:
          - cephclients
          - cephclusters
          - cephblockpools
          - cephfilesystems
          - cephnfses
          - cephobjectstores
          - cephobjectstoreusers
          - cephobjectrealms
          - cephobjectzonegroups
          - cephobjectzones
          - cephbuckettopics
          - cephbucketnotifications
          - cephrbdmirrors
          - cephfilesystemmirrors
          - cephfilesystemsubvolumegroups
          - cephblockpoolradosnamespaces
          verbs:
          - get
          - list
          - watch
          - update
        - apiGroups:
          - ceph.rook.io
          resources:
          - cephclients/status
          - cephclusters/status
          - cephblockpools/status
          - cephfilesystems/status
          - cephnfses/status
          - cephobjectstores/status
          - cephobjectstoreusers/status
          - cephobjectrealms/status
          - cephobjectzonegroups/status
          - cephobjectzones/status
          - cephbuckettopics/status
          - cephbucketnotifications/status
          - cephrbdmirrors/status
          - cephfilesystemmirrors/status
          - cephfilesystemsubvolumegroups/status
          - cephblockpoolradosnamespaces/status
          verbs:
          - update
        - apiGroups:
          - ceph.rook.io
          resources:
          - cephclients/finalizers
          - cephclusters/finalizers
          - cephblockpools/finalizers
          - cephfilesystems/finalizers
          - cephnfses/finalizers
          - cephobjectstores/finalizers
          - cephobjectstoreusers/finalizers
          - cephobjectrealms/finalizers
          - cephobjectzonegroups/finalizers
          - cephobjectzones/finalizers
          - cephbuckettopics/finalizers
          - cephbucketnotifications/finalizers
          - cephrbdmirrors/finalizers
          - cephfilesystemmirrors/finalizers
          - cephfilesystemsubvolumegroups/finalizers
          - cephblockpoolradosnamespaces/finalizers
          verbs:
          - update
        - apiGroups:
          - policy
          - apps
          - extensions
          resources:
          - poddisruptionbudgets
          - deployments
          - replicasets
          verbs:
          - get
          - list
          - watch
          - create
          - update
          - delete
          - deletecollection
        - apiGroups:
          - healthchecking.openshift.io
          resources:
          - machinedisruptionbudgets
          verbs:
          - get
          - list
          - watch
          - create
          - update
          - delete
        - apiGroups:
          - machine.openshift.io
          resources:
          - machines
          verbs:
          - get
          - list
          - watch
          - create
          - update
          - delete
        - apiGroups:
          - storage.k8s.io
          resources:
          - csidrivers
          verbs:
          - create
          - delete
          - get
          - update
        - apiGroups:
          - k8s.cni.cncf.io
          resources:
          - network-attachment-definitions
          verbs:
          - get
        serviceAccountName: rook-ceph-system
      - rules:
        - apiGroups:
          - ""
          resources:
          - configmaps
          - nodes
          - nodes/proxy
          - persistentvolumes
          verbs:
          - get
          - list
          - watch
        - apiGroups:
          - ""
          resources:
          - events
          verbs:
          - create
          - patch
          - list
          - get
          - watch
        - apiGroups:
          - storage.k8s.io
          resources:
          - storageclasses
          verbs:
          - get
          - list
          - watch
        serviceAccountName: rook-ceph-mgr
      - rules:
        - apiGroups:
          - ""
          resources:
          - configmaps
          verbs:
          - get
          - list
          - watch
        serviceAccountName: rook-ceph-mgr
      - rules:
        - apiGroups:
          - ""
          resources:
          - secrets
          - configmaps
          verbs:
          - get
          - create
          - update
          - delete
        - apiGroups:
          - storage.k8s.io
          resources:
          - storageclasses
          verbs:
          - get
        - apiGroups:
          - objectbucket.io
          resources:
          - objectbucketclaims
          verbs:
          - list
          - watch
          - get
          - update
        - apiGroups:
          - objectbucket.io
          resources:
          - objectbuckets
          verbs:
          - list
          - watch
          - get
          - create
          - update
          - delete
        - apiGroups:
          - objectbucket.io
          resources:
          - objectbucketclaims/status
          - objectbuckets/status
          verbs:
          - update
        - apiGroups:
          - objectbucket.io
          resources:
          - objectbucketclaims/finalizers
          - objectbuckets/finalizers
          verbs:
          - update
        serviceAccountName: rook-ceph-system
      - rules:
        - apiGroups:
          - ""
          resources:
          - nodes
          verbs:
          - get
          - list
        serviceAccountName: rook-ceph-osd
      - rules:
        - apiGroups:
          - ""
          resources:
          - pods
          - pods/log
          verbs:
          - get
          - list
        - apiGroups:
          - ""
          resources:
          - pods/exec
          verbs:
          - create
        - apiGroups:
          - admissionregistration.k8s.io
          resources:
          - validatingwebhookconfigurations
          verbs:
          - create
          - get
          - delete
          - update
        serviceAccountName: rook-ceph-system
      - rules:
        - verbs:
          - use
          apiGroups:
          - security.openshift.io
          resources:
          - securitycontextconstraints
          resourceNames:
          - privileged
        serviceAccountName: rook-ceph-system
      deployments:
      - name: rook-ceph-operator
        spec:
          replicas: 1
          selector:
            matchLabels:
              app: rook-ceph-operator
          strategy:
            type: Recreate
          template:
            metadata:
              labels:
                app: rook-ceph-operator
            spec:
              containers:
              - args:
                - ceph
                - operator
                env:
                - name: ROOK_CURRENT_NAMESPACE_ONLY
                  value: "false"
                - name: ROOK_DISCOVER_DEVICES_INTERVAL
                  value: 60m
                - name: ROOK_HOSTPATH_REQUIRES_PRIVILEGED
                  value: "true"
                - name: ROOK_ENABLE_SELINUX_RELABELING
                  value: "true"
                - name: ROOK_ENABLE_FSGROUP
                  value: "true"
                - name: ROOK_DISABLE_DEVICE_HOTPLUG
                  value: "false"
                - name: DISCOVER_DAEMON_UDEV_BLACKLIST
                  value: (?i)dm-[0-9]+,(?i)rbd[0-9]+,(?i)nbd[0-9]+
                - name: ROOK_ENABLE_MACHINE_DISRUPTION_BUDGET
                  value: "false"
                - name: ROOK_UNREACHABLE_NODE_TOLERATION_SECONDS
                  value: "5"
                - name: NODE_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: spec.nodeName
                - name: POD_NAME
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.name
                - name: POD_NAMESPACE
                  valueFrom:
                    fieldRef:
                      fieldPath: metadata.namespace
                image: '{{.RookOperatorImage}}'
                name: rook-ceph-operator
                ports:
                - containerPort: 9443
                  name: https-webhook
                  protocol: TCP
                resources: {}
                securityContext:
                  runAsGroup: 2016
                  runAsNonRoot: true
                  runAsUser: 2016
                volumeMounts:
                - mountPath: /var/lib/rook
                  name: rook-config
                - mountPath: /etc/ceph
                  name: default-config-dir
                - mountPath: /etc/webhook
                  name: webhook-cert
              serviceAccountName: rook-ceph-system
              volumes:
              - emptyDir: {}
                name: rook-config
              - emptyDir: {}
                name: default-config-dir
              - emptyDir: {}
                name: webhook-cert
      permissions:
      - rules:
        - apiGroups:
          - ""
          resources:
          - endpoints
          verbs:
          - get
          - watch
          - list
          - delete
          - update
          - create
        - apiGroups:
          - ""
          resources:
          - configmaps
          verbs:
          - get
          - list
          - create
          - delete
        - apiGroups:
          - coordination.k8s.io
          resources:
          - leases
          verbs:
          - get
          - watch
          - list
          - delete
          - update
          - create
        serviceAccountName: rook-csi-cephfs-provisioner-sa
      - rules:
        - apiGroups:
          - csiaddons.openshift.io
          resources:
          - csiaddonsnodes
          verbs:
          - create
        serviceAccountName: rook-csi-rbd-plugin-sa
      - rules:
        - apiGroups:
          - ""
          resources:
          - endpoints
          verbs:
          - get
          - watch
          - list
          - delete
          - update
          - create
        - apiGroups:
          - ""
          resources:
          - configmaps
          verbs:
          - get
          - list
          - watch
          - create
          - delete
          - update
        - apiGroups:
          - coordination.k8s.io
          resources:
          - leases
          verbs:
          - get
          - watch
          - list
          - delete
          - update
          - create
        - apiGroups:
          - csiaddons.openshift.io
          resources:
          - csiaddonsnodes
          verbs:
          - create
        serviceAccountName: rook-csi-rbd-provisioner-sa
      - rules:
        - apiGroups:
          - ""
          resources:
          - pods
          - configmaps
          verbs:
          - get
          - list
          - watch
          - create
          - update
          - delete
        serviceAccountName: rook-ceph-cmd-reporter
      - rules:
        - apiGroups:
          - ""
          resources:
          - pods
          - services
          - pods/log
          verbs:
          - get
          - list
          - watch
          - create
          - update
          - delete
        - apiGroups:
          - batch
          resources:
          - jobs
          verbs:
          - get
          - list
          - watch
          - create
          - update
          - delete
        - apiGroups:
          - ceph.rook.io
          resources:
          - '*'
          verbs:
          - '*'
        - apiGroups:
          - apps
          resources:
          - deployments/scale
          - deployments
          verbs:
          - patch
          - delete
        - apiGroups:
          - ""
          resources:
          - persistentvolumeclaims
          verbs:
          - delete
        serviceAccountName: rook-ceph-mgr
      - rules:
        - apiGroups:
          - ""
          resources:
          - secrets
          verbs:
          - get
        - apiGroups:
          - ""
          resources:
          - configmaps
          verbs:
          - get
          - list
          - watch
          - create
          - update
          - delete
        - apiGroups:
          - ceph.rook.io
          resources:
          - cephclusters
          - cephclusters/finalizers
          verbs:
          - get
          - list
          - create
          - update
          - delete
        serviceAccountName: rook-ceph-osd
      - rules:
        - apiGroups:
          - ""
          resources:
          - configmaps
          verbs:
          - get
        - apiGroups:
          - apps
          resources:
          - deployments
          verbs:
          - get
          - delete
        - apiGroups:
          - batch
          resources:
          - jobs
          verbs:
          - get
          - list
          - delete
        - apiGroups:
          - ""
          resources:
          - persistentvolumeclaims
          verbs:
          - get
          - update
          - delete
          - list
        serviceAccountName: rook-ceph-purge-osd
      - rules:
        - apiGroups:
          - ""
          resources:
          - pods
          - configmaps
          - services
          verbs:
          - get
          - list
          - watch
          - patch
          - create
          - update
          - delete
        - apiGroups:
          - apps
          - extensions
          resources:
          - daemonsets
          - statefulsets
          - deployments
          verbs:
          - get
          - list
          - watch
          - create
          - update
          - delete
        - apiGroups:
          - batch
          resources:
          - cronjobs
          verbs:
          - delete
        - apiGroups:
          - cert-manager.io
          resources:
          - certificates
          - issuers
          verbs:
          - get
          - create
          - delete
        serviceAccountName: rook-ceph-system
    strategy: deployment
  installModes:
  - type: OwnNamespace
    supported: true
  - type: SingleNamespace
    supported: true
  - type: MultiNamespace
    supported: false
  - type: AllNamespaces
    supported: false
  keywords:
  - rook
  - ceph
  - storage
  - object storage
  - open source
  - block storage
  - shared filesystem
  maintainers:
  - name: Red Hat, Inc.
    email: customerservice@redhat.com
  maturity: alpha
  provider:
    name: Red Hat, Inc.
  version: {{.RookOperatorCsvVersion}}
  replaces: rook-ceph.v1.1.1
  description: |2

    The Rook-Ceph storage operator packages, deploys, manages, upgrades and scales Ceph storage for providing persistent storage to infrastructure services (Logging, Metrics, Registry) as well as stateful applications in Kubernetes clusters.

    ## Rook-Ceph Storage Operator

    Rook runs as a cloud-native service in Kubernetes clusters for optimal integration with applications in need of storage, and handles the heavy-lifting behind the scenes such as provisioning and management.
    Rook orchestrates battle-tested open-source storage technology Ceph, which has years of production deployments and runs some of the worlds largest clusters.

    Ceph is a massively scalable, software-defined, cloud native storage platform that offers block, file and object storage services.
    Ceph can be used to back a wide variety of applications including relational databases, NoSQL databases, CI/CD tool-sets, messaging, AI/ML and analytics applications.
    Ceph is a proven storage platform that backs some of the world's largest storage deployments and has a large vibrant open source community backing the project.

    ## Supported features
    * **High Availability and resiliency** - Ceph has no single point of failures (SPOF) and all its components work natively in a highly available fashion
    * **Data Protection** - Ceph periodically scrub for inconsistent objects and repair them if necessary, making sure your replicas are always coherent
    * **Consistent storage platform across hybrid cloud** - Ceph can be deployed anywhere (on-premise or bare metal) and thus offers a similar experience regardless
    * **Block, File & Object storage service** - Ceph can expose your data through several storage interfaces, solving all the application use cases
    * **Scale up/down** - addition and removal of storage is fully covered by the operator.
    * **Dashboard** - The Operator deploys a dashboard for monitoring and introspecting your cluster.

    ## Before you start
    https://rook.io/docs/rook/v1.0/k8s-pre-reqs.html
  minKubeVersion: 1.10.0
  labels:
    alm-owner-etcd: rookoperator
    operated-by: rookoperator
  selector:
    matchLabels:
      alm-owner-etcd: rookoperator
      operated-by: rookoperator
  links:
  - name: Blog
    url: https://blog.rook.io
  - name: Documentation
    url: https://rook.github.io/docs/rook/v1.0/
